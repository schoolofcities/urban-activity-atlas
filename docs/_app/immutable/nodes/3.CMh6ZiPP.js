import{a as X,t as tt,n as Gt}from"../chunks/disclose-version.BJWUB3wQ.js";import{s as C,v as S,p as Ke,aC as re,aD as Qe,t as q,q as je,g,$ as P,w as T,aE as W,o as ie,e as qn,aF as $e}from"../chunks/runtime.DN73Zm9j.js";import{s as A,l as Pn,e as yt,b as Dn,r as Hn,i as _t,t as Kt}from"../chunks/top-logo-full.BieRVltW.js";import{e as Tt,s as rt}from"../chunks/render.BGMhVoZ0.js";import{p as it,i as tn}from"../chunks/props.D28Buolp.js";import{i as en}from"../chunks/lifecycle.DY5ihH6u.js";import{o as nn,a as Ln}from"../chunks/index-client.CedVX3lY.js";var On=tt('<div id="bar" class="svelte-os6al8"><div id="logo" class="svelte-os6al8"><a href="https://www.schoolofcities.utoronto.ca/" class="svelte-os6al8"><img alt="School of Cities" class="svelte-os6al8"></a></div></div>');function Xn(t){var e=On(),n=C(e),r=C(n),i=C(r);A(i,"src",Pn),S(r),S(n),S(e),X(t,e)}var Bn=tt('<button aria-label="Play" class="svelte-18qviht"><svg width="12" height="12" viewBox="0 0 12 12" fill="white" xmlns="http://www.w3.org/2000/svg"><polygon points="2,1 10,6 2,11"></polygon></svg></button>'),Vn=tt('<button aria-label="Stop" class="svelte-18qviht"><svg width="12" height="12" viewBox="0 0 12 12" fill="white" xmlns="http://www.w3.org/2000/svg"><rect x="2" y="2" width="8" height="8"></rect></svg></button>'),Un=tt('<span class="svelte-18qviht"> </span>'),Yn=tt('<div class="container svelte-18qviht"><h3 class="svelte-18qviht"> </h3> <div class="controls svelte-18qviht"><div class="range-play-wrapper svelte-18qviht"><!> <div class="slider-wrapper svelte-18qviht"><input type="range" min="0" max="23" step="1" class="custom-slider svelte-18qviht"> <div class="ticks svelte-18qviht"></div></div></div></div> <div class="mode-toggle svelte-18qviht"><button class="svelte-18qviht">Weekday</button> <button class="svelte-18qviht">Weekend</button></div> <img class="svelte-18qviht"></div>');function Ne(t,e){Ke(e,!1);const n=W(),r=W();let i=it(e,"title",8,""),a=it(e,"folder_weekday",8,""),o=it(e,"folder_weekend",8,""),s=W(),l=W(0),u=null,c=W(!1),f=W(!1),h=[],d=W("weekday");function p(I){I==="weekday"?P(s,a()):P(s,o()),P(d,I),m()}async function m(){P(f,!1),h=[],await Promise.all(g(n).map(I=>new Promise(E=>{const O=new Image;O.src=I,O.onload=async()=>{try{await O.decode()}catch{}h.push(I),E()},O.onerror=E}))),P(f,!0)}nn(()=>{p("weekday")}),Ln(()=>{clearInterval(u)});function k(){!g(c)&&g(f)&&(P(c,!0),u=setInterval(()=>{P(l,(g(l)+1)%24)},250))}function $(){P(c,!1),clearInterval(u)}re(()=>g(s),()=>{P(n,Array.from({length:24},(I,E)=>`/urban-activity-atlas/${g(s)}/Hour_${E}.png`))}),re(()=>{},()=>{P(r,Array.from({length:24},(I,E)=>E))}),Qe(),en();var N=Yn(),b=C(N),R=C(b,!0);S(b);var v=T(b,2),_=C(v),x=C(_);tn(x,()=>!g(c),I=>{var E=Bn();q(()=>E.disabled=!g(f)),Tt("click",E,k),X(I,E)},I=>{var E=Vn();Tt("click",E,$),X(I,E)});var w=T(x,2),M=C(w);Hn(M);var L=T(M,2);yt(L,5,()=>g(r),_t,(I,E)=>{var O=Un(),et=C(O,!0);S(O),q(()=>rt(et,g(E))),X(I,O)}),S(L),S(w),S(_),S(v);var y=T(v,2),z=C(y),F=T(z,2);S(y);var G=T(y,2);S(N),q(()=>{rt(R,i()),M.disabled=!g(f),Kt(z,"selected",g(d)==="weekday"),Kt(F,"selected",g(d)==="weekend"),A(G,"src",g(f)?g(n)[g(l)]:"./urban-activity-atlas/exploring-daily-activity-toronto/blank-image.png"),A(G,"alt",`Hour ${g(l)}`),Kt(G,"loading",!g(f))}),Dn(M,()=>g(l),I=>P(l,I)),Tt("click",z,()=>p("weekday")),Tt("click",F,()=>p("weekend")),X(t,N),je()}function Rt(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Gn(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function rn(t){let e,n,r;t.length!==2?(e=Rt,n=(s,l)=>Rt(t(s),l),r=(s,l)=>t(s)-l):(e=t===Rt||t===Gn?t:Wn,n=t,r=t);function i(s,l,u=0,c=s.length){if(u<c){if(e(l,l)!==0)return c;do{const f=u+c>>>1;n(s[f],l)<0?u=f+1:c=f}while(u<c)}return u}function a(s,l,u=0,c=s.length){if(u<c){if(e(l,l)!==0)return c;do{const f=u+c>>>1;n(s[f],l)<=0?u=f+1:c=f}while(u<c)}return u}function o(s,l,u=0,c=s.length){const f=i(s,l,u,c-1);return f>u&&r(s[f-1],l)>-r(s[f],l)?f-1:f}return{left:i,center:o,right:a}}function Wn(){return 0}function Zn(t){return t===null?NaN:+t}const Jn=rn(Rt),Kn=Jn.right;rn(Zn).center;const Qn=Math.sqrt(50),jn=Math.sqrt(10),tr=Math.sqrt(2);function Pt(t,e,n){const r=(e-t)/Math.max(0,n),i=Math.floor(Math.log10(r)),a=r/Math.pow(10,i),o=a>=Qn?10:a>=jn?5:a>=tr?2:1;let s,l,u;return i<0?(u=Math.pow(10,-i)/o,s=Math.round(t*u),l=Math.round(e*u),s/u<t&&++s,l/u>e&&--l,u=-u):(u=Math.pow(10,i)*o,s=Math.round(t/u),l=Math.round(e/u),s*u<t&&++s,l*u>e&&--l),l<s&&.5<=n&&n<2?Pt(t,e,n*2):[s,l,u]}function er(t,e,n){if(e=+e,t=+t,n=+n,!(n>0))return[];if(t===e)return[t];const r=e<t,[i,a,o]=r?Pt(e,t,n):Pt(t,e,n);if(!(a>=i))return[];const s=a-i+1,l=new Array(s);if(r)if(o<0)for(let u=0;u<s;++u)l[u]=(a-u)/-o;else for(let u=0;u<s;++u)l[u]=(a-u)*o;else if(o<0)for(let u=0;u<s;++u)l[u]=(i+u)/-o;else for(let u=0;u<s;++u)l[u]=(i+u)*o;return l}function ae(t,e,n){return e=+e,t=+t,n=+n,Pt(t,e,n)[2]}function nr(t,e,n){e=+e,t=+t,n=+n;const r=e<t,i=r?ae(e,t,n):ae(t,e,n);return(r?-1:1)*(i<0?1/-i:i)}function rr(t,e){let n;for(const r of t)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);return n}function ir(t,e){let n;for(const r of t)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);return n}var ar={value:()=>{}};function an(){for(var t=0,e=arguments.length,n={},r;t<e;++t){if(!(r=arguments[t]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new zt(n)}function zt(t){this._=t}function or(t,e){return t.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}zt.prototype=an.prototype={constructor:zt,on:function(t,e){var n=this._,r=or(t+"",n),i,a=-1,o=r.length;if(arguments.length<2){for(;++a<o;)if((i=(t=r[a]).type)&&(i=sr(n[i],t.name)))return i;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++a<o;)if(i=(t=r[a]).type)n[i]=Te(n[i],t.name,e);else if(e==null)for(i in n)n[i]=Te(n[i],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new zt(t)},call:function(t,e){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,a;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(a=this._[t],r=0,i=a.length;r<i;++r)a[r].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,a=r.length;i<a;++i)r[i].value.apply(e,n)}};function sr(t,e){for(var n=0,r=t.length,i;n<r;++n)if((i=t[n]).name===e)return i.value}function Te(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=ar,t=t.slice(0,r).concat(t.slice(r+1));break}return n!=null&&t.push({name:e,value:n}),t}var oe="http://www.w3.org/1999/xhtml";const Se={svg:"http://www.w3.org/2000/svg",xhtml:oe,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Wt(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),Se.hasOwnProperty(e)?{space:Se[e],local:t}:t}function lr(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===oe&&e.documentElement.namespaceURI===oe?e.createElement(t):e.createElementNS(n,t)}}function ur(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function on(t){var e=Wt(t);return(e.local?ur:lr)(e)}function cr(){}function me(t){return t==null?cr:function(){return this.querySelector(t)}}function fr(t){typeof t!="function"&&(t=me(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a=e[i],o=a.length,s=r[i]=new Array(o),l,u,c=0;c<o;++c)(l=a[c])&&(u=t.call(l,l.__data__,c,a))&&("__data__"in l&&(u.__data__=l.__data__),s[c]=u);return new U(r,this._parents)}function hr(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function dr(){return[]}function sn(t){return t==null?dr:function(){return this.querySelectorAll(t)}}function pr(t){return function(){return hr(t.apply(this,arguments))}}function vr(t){typeof t=="function"?t=pr(t):t=sn(t);for(var e=this._groups,n=e.length,r=[],i=[],a=0;a<n;++a)for(var o=e[a],s=o.length,l,u=0;u<s;++u)(l=o[u])&&(r.push(t.call(l,l.__data__,u,o)),i.push(l));return new U(r,i)}function ln(t){return function(){return this.matches(t)}}function un(t){return function(e){return e.matches(t)}}var gr=Array.prototype.find;function mr(t){return function(){return gr.call(this.children,t)}}function yr(){return this.firstElementChild}function _r(t){return this.select(t==null?yr:mr(typeof t=="function"?t:un(t)))}var wr=Array.prototype.filter;function xr(){return Array.from(this.children)}function br(t){return function(){return wr.call(this.children,t)}}function kr(t){return this.selectAll(t==null?xr:br(typeof t=="function"?t:un(t)))}function Ar(t){typeof t!="function"&&(t=ln(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a=e[i],o=a.length,s=r[i]=[],l,u=0;u<o;++u)(l=a[u])&&t.call(l,l.__data__,u,a)&&s.push(l);return new U(r,this._parents)}function cn(t){return new Array(t.length)}function Mr(){return new U(this._enter||this._groups.map(cn),this._parents)}function Dt(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}Dt.prototype={constructor:Dt,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function $r(t){return function(){return t}}function Nr(t,e,n,r,i,a){for(var o=0,s,l=e.length,u=a.length;o<u;++o)(s=e[o])?(s.__data__=a[o],r[o]=s):n[o]=new Dt(t,a[o]);for(;o<l;++o)(s=e[o])&&(i[o]=s)}function Tr(t,e,n,r,i,a,o){var s,l,u=new Map,c=e.length,f=a.length,h=new Array(c),d;for(s=0;s<c;++s)(l=e[s])&&(h[s]=d=o.call(l,l.__data__,s,e)+"",u.has(d)?i[s]=l:u.set(d,l));for(s=0;s<f;++s)d=o.call(t,a[s],s,a)+"",(l=u.get(d))?(r[s]=l,l.__data__=a[s],u.delete(d)):n[s]=new Dt(t,a[s]);for(s=0;s<c;++s)(l=e[s])&&u.get(h[s])===l&&(i[s]=l)}function Sr(t){return t.__data__}function Er(t,e){if(!arguments.length)return Array.from(this,Sr);var n=e?Tr:Nr,r=this._parents,i=this._groups;typeof t!="function"&&(t=$r(t));for(var a=i.length,o=new Array(a),s=new Array(a),l=new Array(a),u=0;u<a;++u){var c=r[u],f=i[u],h=f.length,d=Cr(t.call(c,c&&c.__data__,u,r)),p=d.length,m=s[u]=new Array(p),k=o[u]=new Array(p),$=l[u]=new Array(h);n(c,f,m,k,$,d,e);for(var N=0,b=0,R,v;N<p;++N)if(R=m[N]){for(N>=b&&(b=N+1);!(v=k[b])&&++b<p;);R._next=v||null}}return o=new U(o,r),o._enter=s,o._exit=l,o}function Cr(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function Ir(){return new U(this._exit||this._groups.map(cn),this._parents)}function Rr(t,e,n){var r=this.enter(),i=this,a=this.exit();return typeof t=="function"?(r=t(r),r&&(r=r.selection())):r=r.append(t+""),e!=null&&(i=e(i),i&&(i=i.selection())),n==null?a.remove():n(a),r&&i?r.merge(i).order():i}function zr(t){for(var e=t.selection?t.selection():t,n=this._groups,r=e._groups,i=n.length,a=r.length,o=Math.min(i,a),s=new Array(i),l=0;l<o;++l)for(var u=n[l],c=r[l],f=u.length,h=s[l]=new Array(f),d,p=0;p<f;++p)(d=u[p]||c[p])&&(h[p]=d);for(;l<i;++l)s[l]=n[l];return new U(s,this._parents)}function Fr(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r=t[e],i=r.length-1,a=r[i],o;--i>=0;)(o=r[i])&&(a&&o.compareDocumentPosition(a)^4&&a.parentNode.insertBefore(o,a),a=o);return this}function qr(t){t||(t=Pr);function e(f,h){return f&&h?t(f.__data__,h.__data__):!f-!h}for(var n=this._groups,r=n.length,i=new Array(r),a=0;a<r;++a){for(var o=n[a],s=o.length,l=i[a]=new Array(s),u,c=0;c<s;++c)(u=o[c])&&(l[c]=u);l.sort(e)}return new U(i,this._parents).order()}function Pr(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function Dr(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function Hr(){return Array.from(this)}function Lr(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,a=r.length;i<a;++i){var o=r[i];if(o)return o}return null}function Or(){let t=0;for(const e of this)++t;return t}function Xr(){return!this.node()}function Br(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i=e[n],a=0,o=i.length,s;a<o;++a)(s=i[a])&&t.call(s,s.__data__,a,i);return this}function Vr(t){return function(){this.removeAttribute(t)}}function Ur(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Yr(t,e){return function(){this.setAttribute(t,e)}}function Gr(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function Wr(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function Zr(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function Jr(t,e){var n=Wt(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((e==null?n.local?Ur:Vr:typeof e=="function"?n.local?Zr:Wr:n.local?Gr:Yr)(n,e))}function fn(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function Kr(t){return function(){this.style.removeProperty(t)}}function Qr(t,e,n){return function(){this.style.setProperty(t,e,n)}}function jr(t,e,n){return function(){var r=e.apply(this,arguments);r==null?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function ti(t,e,n){return arguments.length>1?this.each((e==null?Kr:typeof e=="function"?jr:Qr)(t,e,n??"")):ht(this.node(),t)}function ht(t,e){return t.style.getPropertyValue(e)||fn(t).getComputedStyle(t,null).getPropertyValue(e)}function ei(t){return function(){delete this[t]}}function ni(t,e){return function(){this[t]=e}}function ri(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function ii(t,e){return arguments.length>1?this.each((e==null?ei:typeof e=="function"?ri:ni)(t,e)):this.node()[t]}function hn(t){return t.trim().split(/^|\s+/)}function ye(t){return t.classList||new dn(t)}function dn(t){this._node=t,this._names=hn(t.getAttribute("class")||"")}dn.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function pn(t,e){for(var n=ye(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function vn(t,e){for(var n=ye(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function ai(t){return function(){pn(this,t)}}function oi(t){return function(){vn(this,t)}}function si(t,e){return function(){(e.apply(this,arguments)?pn:vn)(this,t)}}function li(t,e){var n=hn(t+"");if(arguments.length<2){for(var r=ye(this.node()),i=-1,a=n.length;++i<a;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof e=="function"?si:e?ai:oi)(n,e))}function ui(){this.textContent=""}function ci(t){return function(){this.textContent=t}}function fi(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function hi(t){return arguments.length?this.each(t==null?ui:(typeof t=="function"?fi:ci)(t)):this.node().textContent}function di(){this.innerHTML=""}function pi(t){return function(){this.innerHTML=t}}function vi(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function gi(t){return arguments.length?this.each(t==null?di:(typeof t=="function"?vi:pi)(t)):this.node().innerHTML}function mi(){this.nextSibling&&this.parentNode.appendChild(this)}function yi(){return this.each(mi)}function _i(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function wi(){return this.each(_i)}function xi(t){var e=typeof t=="function"?t:on(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function bi(){return null}function ki(t,e){var n=typeof t=="function"?t:on(t),r=e==null?bi:typeof e=="function"?e:me(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function Ai(){var t=this.parentNode;t&&t.removeChild(this)}function Mi(){return this.each(Ai)}function $i(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Ni(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Ti(t){return this.select(t?Ni:$i)}function Si(t){return arguments.length?this.property("__data__",t):this.node().__data__}function Ei(t){return function(e){t.call(this,e,this.__data__)}}function Ci(t){return t.trim().split(/^|\s+/).map(function(e){var n="",r=e.indexOf(".");return r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),{type:e,name:n}})}function Ii(t){return function(){var e=this.__on;if(e){for(var n=0,r=-1,i=e.length,a;n<i;++n)a=e[n],(!t.type||a.type===t.type)&&a.name===t.name?this.removeEventListener(a.type,a.listener,a.options):e[++r]=a;++r?e.length=r:delete this.__on}}}function Ri(t,e,n){return function(){var r=this.__on,i,a=Ei(e);if(r){for(var o=0,s=r.length;o<s;++o)if((i=r[o]).type===t.type&&i.name===t.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=a,i.options=n),i.value=e;return}}this.addEventListener(t.type,a,n),i={type:t.type,name:t.name,value:e,listener:a,options:n},r?r.push(i):this.__on=[i]}}function zi(t,e,n){var r=Ci(t+""),i,a=r.length,o;if(arguments.length<2){var s=this.node().__on;if(s){for(var l=0,u=s.length,c;l<u;++l)for(i=0,c=s[l];i<a;++i)if((o=r[i]).type===c.type&&o.name===c.name)return c.value}return}for(s=e?Ri:Ii,i=0;i<a;++i)this.each(s(r[i],e,n));return this}function gn(t,e,n){var r=fn(t),i=r.CustomEvent;typeof i=="function"?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function Fi(t,e){return function(){return gn(this,t,e)}}function qi(t,e){return function(){return gn(this,t,e.apply(this,arguments))}}function Pi(t,e){return this.each((typeof e=="function"?qi:Fi)(t,e))}function*Di(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,a=r.length,o;i<a;++i)(o=r[i])&&(yield o)}var Hi=[null];function U(t,e){this._groups=t,this._parents=e}function $t(){return new U([[document.documentElement]],Hi)}function Li(){return this}U.prototype=$t.prototype={constructor:U,select:fr,selectAll:vr,selectChild:_r,selectChildren:kr,filter:Ar,data:Er,enter:Mr,exit:Ir,join:Rr,merge:zr,selection:Li,order:Fr,sort:qr,call:Dr,nodes:Hr,node:Lr,size:Or,empty:Xr,each:Br,attr:Jr,style:ti,property:ii,classed:li,text:hi,html:gi,raise:yi,lower:wi,append:xi,insert:ki,remove:Mi,clone:Ti,datum:Si,on:zi,dispatch:Pi,[Symbol.iterator]:Di};function _e(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function mn(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Nt(){}var kt=.7,Ht=1/kt,ft="\\s*([+-]?\\d+)\\s*",At="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Z="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Oi=/^#([0-9a-f]{3,8})$/,Xi=new RegExp(`^rgb\\(${ft},${ft},${ft}\\)$`),Bi=new RegExp(`^rgb\\(${Z},${Z},${Z}\\)$`),Vi=new RegExp(`^rgba\\(${ft},${ft},${ft},${At}\\)$`),Ui=new RegExp(`^rgba\\(${Z},${Z},${Z},${At}\\)$`),Yi=new RegExp(`^hsl\\(${At},${Z},${Z}\\)$`),Gi=new RegExp(`^hsla\\(${At},${Z},${Z},${At}\\)$`),Ee={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};_e(Nt,st,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Ce,formatHex:Ce,formatHex8:Wi,formatHsl:Zi,formatRgb:Ie,toString:Ie});function Ce(){return this.rgb().formatHex()}function Wi(){return this.rgb().formatHex8()}function Zi(){return yn(this).formatHsl()}function Ie(){return this.rgb().formatRgb()}function st(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=Oi.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?Re(e):n===3?new H(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?St(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?St(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=Xi.exec(t))?new H(e[1],e[2],e[3],1):(e=Bi.exec(t))?new H(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=Vi.exec(t))?St(e[1],e[2],e[3],e[4]):(e=Ui.exec(t))?St(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=Yi.exec(t))?qe(e[1],e[2]/100,e[3]/100,1):(e=Gi.exec(t))?qe(e[1],e[2]/100,e[3]/100,e[4]):Ee.hasOwnProperty(t)?Re(Ee[t]):t==="transparent"?new H(NaN,NaN,NaN,0):null}function Re(t){return new H(t>>16&255,t>>8&255,t&255,1)}function St(t,e,n,r){return r<=0&&(t=e=n=NaN),new H(t,e,n,r)}function Ji(t){return t instanceof Nt||(t=st(t)),t?(t=t.rgb(),new H(t.r,t.g,t.b,t.opacity)):new H}function se(t,e,n,r){return arguments.length===1?Ji(t):new H(t,e,n,r??1)}function H(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}_e(H,se,mn(Nt,{brighter(t){return t=t==null?Ht:Math.pow(Ht,t),new H(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?kt:Math.pow(kt,t),new H(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new H(ot(this.r),ot(this.g),ot(this.b),Lt(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:ze,formatHex:ze,formatHex8:Ki,formatRgb:Fe,toString:Fe}));function ze(){return`#${at(this.r)}${at(this.g)}${at(this.b)}`}function Ki(){return`#${at(this.r)}${at(this.g)}${at(this.b)}${at((isNaN(this.opacity)?1:this.opacity)*255)}`}function Fe(){const t=Lt(this.opacity);return`${t===1?"rgb(":"rgba("}${ot(this.r)}, ${ot(this.g)}, ${ot(this.b)}${t===1?")":`, ${t})`}`}function Lt(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function ot(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function at(t){return t=ot(t),(t<16?"0":"")+t.toString(16)}function qe(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new V(t,e,n,r)}function yn(t){if(t instanceof V)return new V(t.h,t.s,t.l,t.opacity);if(t instanceof Nt||(t=st(t)),!t)return new V;if(t instanceof V)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),a=Math.max(e,n,r),o=NaN,s=a-i,l=(a+i)/2;return s?(e===a?o=(n-r)/s+(n<r)*6:n===a?o=(r-e)/s+2:o=(e-n)/s+4,s/=l<.5?a+i:2-a-i,o*=60):s=l>0&&l<1?0:o,new V(o,s,l,t.opacity)}function Qi(t,e,n,r){return arguments.length===1?yn(t):new V(t,e,n,r??1)}function V(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}_e(V,Qi,mn(Nt,{brighter(t){return t=t==null?Ht:Math.pow(Ht,t),new V(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?kt:Math.pow(kt,t),new V(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new H(Qt(t>=240?t-240:t+120,i,r),Qt(t,i,r),Qt(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new V(Pe(this.h),Et(this.s),Et(this.l),Lt(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Lt(this.opacity);return`${t===1?"hsl(":"hsla("}${Pe(this.h)}, ${Et(this.s)*100}%, ${Et(this.l)*100}%${t===1?")":`, ${t})`}`}}));function Pe(t){return t=(t||0)%360,t<0?t+360:t}function Et(t){return Math.max(0,Math.min(1,t||0))}function Qt(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}const we=t=>()=>t;function ji(t,e){return function(n){return t+n*e}}function ta(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function ea(t){return(t=+t)==1?_n:function(e,n){return n-e?ta(e,n,t):we(isNaN(e)?n:e)}}function _n(t,e){var n=e-t;return n?ji(t,n):we(isNaN(t)?e:t)}const Ot=function t(e){var n=ea(e);function r(i,a){var o=n((i=se(i)).r,(a=se(a)).r),s=n(i.g,a.g),l=n(i.b,a.b),u=_n(i.opacity,a.opacity);return function(c){return i.r=o(c),i.g=s(c),i.b=l(c),i.opacity=u(c),i+""}}return r.gamma=t,r}(1);function na(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,r=e.slice(),i;return function(a){for(i=0;i<n;++i)r[i]=t[i]*(1-a)+e[i]*a;return r}}function ra(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function ia(t,e){var n=e?e.length:0,r=t?Math.min(n,t.length):0,i=new Array(r),a=new Array(n),o;for(o=0;o<r;++o)i[o]=xe(t[o],e[o]);for(;o<n;++o)a[o]=e[o];return function(s){for(o=0;o<r;++o)a[o]=i[o](s);return a}}function aa(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function B(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function oa(t,e){var n={},r={},i;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(i in e)i in t?n[i]=xe(t[i],e[i]):r[i]=e[i];return function(a){for(i in n)r[i]=n[i](a);return r}}var le=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,jt=new RegExp(le.source,"g");function sa(t){return function(){return t}}function la(t){return function(e){return t(e)+""}}function wn(t,e){var n=le.lastIndex=jt.lastIndex=0,r,i,a,o=-1,s=[],l=[];for(t=t+"",e=e+"";(r=le.exec(t))&&(i=jt.exec(e));)(a=i.index)>n&&(a=e.slice(n,a),s[o]?s[o]+=a:s[++o]=a),(r=r[0])===(i=i[0])?s[o]?s[o]+=i:s[++o]=i:(s[++o]=null,l.push({i:o,x:B(r,i)})),n=jt.lastIndex;return n<e.length&&(a=e.slice(n),s[o]?s[o]+=a:s[++o]=a),s.length<2?l[0]?la(l[0].x):sa(e):(e=l.length,function(u){for(var c=0,f;c<e;++c)s[(f=l[c]).i]=f.x(u);return s.join("")})}function xe(t,e){var n=typeof e,r;return e==null||n==="boolean"?we(e):(n==="number"?B:n==="string"?(r=st(e))?(e=r,Ot):wn:e instanceof st?Ot:e instanceof Date?aa:ra(e)?na:Array.isArray(e)?ia:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?oa:B)(t,e)}function ua(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}var De=180/Math.PI,ue={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function xn(t,e,n,r,i,a){var o,s,l;return(o=Math.sqrt(t*t+e*e))&&(t/=o,e/=o),(l=t*n+e*r)&&(n-=t*l,r-=e*l),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,l/=s),t*r<e*n&&(t=-t,e=-e,l=-l,o=-o),{translateX:i,translateY:a,rotate:Math.atan2(e,t)*De,skewX:Math.atan(l)*De,scaleX:o,scaleY:s}}var Ct;function ca(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?ue:xn(e.a,e.b,e.c,e.d,e.e,e.f)}function fa(t){return t==null||(Ct||(Ct=document.createElementNS("http://www.w3.org/2000/svg","g")),Ct.setAttribute("transform",t),!(t=Ct.transform.baseVal.consolidate()))?ue:(t=t.matrix,xn(t.a,t.b,t.c,t.d,t.e,t.f))}function bn(t,e,n,r){function i(u){return u.length?u.pop()+" ":""}function a(u,c,f,h,d,p){if(u!==f||c!==h){var m=d.push("translate(",null,e,null,n);p.push({i:m-4,x:B(u,f)},{i:m-2,x:B(c,h)})}else(f||h)&&d.push("translate("+f+e+h+n)}function o(u,c,f,h){u!==c?(u-c>180?c+=360:c-u>180&&(u+=360),h.push({i:f.push(i(f)+"rotate(",null,r)-2,x:B(u,c)})):c&&f.push(i(f)+"rotate("+c+r)}function s(u,c,f,h){u!==c?h.push({i:f.push(i(f)+"skewX(",null,r)-2,x:B(u,c)}):c&&f.push(i(f)+"skewX("+c+r)}function l(u,c,f,h,d,p){if(u!==f||c!==h){var m=d.push(i(d)+"scale(",null,",",null,")");p.push({i:m-4,x:B(u,f)},{i:m-2,x:B(c,h)})}else(f!==1||h!==1)&&d.push(i(d)+"scale("+f+","+h+")")}return function(u,c){var f=[],h=[];return u=t(u),c=t(c),a(u.translateX,u.translateY,c.translateX,c.translateY,f,h),o(u.rotate,c.rotate,f,h),s(u.skewX,c.skewX,f,h),l(u.scaleX,u.scaleY,c.scaleX,c.scaleY,f,h),u=c=null,function(d){for(var p=-1,m=h.length,k;++p<m;)f[(k=h[p]).i]=k.x(d);return f.join("")}}}var ha=bn(ca,"px, ","px)","deg)"),da=bn(fa,", ",")",")"),dt=0,wt=0,vt=0,kn=1e3,Xt,xt,Bt=0,lt=0,Zt=0,Mt=typeof performance=="object"&&performance.now?performance:Date,An=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function be(){return lt||(An(pa),lt=Mt.now()+Zt)}function pa(){lt=0}function Vt(){this._call=this._time=this._next=null}Vt.prototype=Mn.prototype={constructor:Vt,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?be():+n)+(e==null?0:+e),!this._next&&xt!==this&&(xt?xt._next=this:Xt=this,xt=this),this._call=t,this._time=n,ce()},stop:function(){this._call&&(this._call=null,this._time=1/0,ce())}};function Mn(t,e,n){var r=new Vt;return r.restart(t,e,n),r}function va(){be(),++dt;for(var t=Xt,e;t;)(e=lt-t._time)>=0&&t._call.call(void 0,e),t=t._next;--dt}function He(){lt=(Bt=Mt.now())+Zt,dt=wt=0;try{va()}finally{dt=0,ma(),lt=0}}function ga(){var t=Mt.now(),e=t-Bt;e>kn&&(Zt-=e,Bt=t)}function ma(){for(var t,e=Xt,n,r=1/0;e;)e._call?(r>e._time&&(r=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:Xt=n);xt=t,ce(r)}function ce(t){if(!dt){wt&&(wt=clearTimeout(wt));var e=t-lt;e>24?(t<1/0&&(wt=setTimeout(He,t-Mt.now()-Zt)),vt&&(vt=clearInterval(vt))):(vt||(Bt=Mt.now(),vt=setInterval(ga,kn)),dt=1,An(He))}}function Le(t,e,n){var r=new Vt;return e=e==null?0:+e,r.restart(i=>{r.stop(),t(i+e)},e,n),r}var ya=an("start","end","cancel","interrupt"),_a=[],$n=0,Oe=1,fe=2,Ft=3,Xe=4,he=5,qt=6;function Jt(t,e,n,r,i,a){var o=t.__transition;if(!o)t.__transition={};else if(n in o)return;wa(t,n,{name:e,index:r,group:i,on:ya,tween:_a,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:$n})}function ke(t,e){var n=Y(t,e);if(n.state>$n)throw new Error("too late; already scheduled");return n}function J(t,e){var n=Y(t,e);if(n.state>Ft)throw new Error("too late; already running");return n}function Y(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function wa(t,e,n){var r=t.__transition,i;r[e]=n,n.timer=Mn(a,0,n.time);function a(u){n.state=Oe,n.timer.restart(o,n.delay,n.time),n.delay<=u&&o(u-n.delay)}function o(u){var c,f,h,d;if(n.state!==Oe)return l();for(c in r)if(d=r[c],d.name===n.name){if(d.state===Ft)return Le(o);d.state===Xe?(d.state=qt,d.timer.stop(),d.on.call("interrupt",t,t.__data__,d.index,d.group),delete r[c]):+c<e&&(d.state=qt,d.timer.stop(),d.on.call("cancel",t,t.__data__,d.index,d.group),delete r[c])}if(Le(function(){n.state===Ft&&(n.state=Xe,n.timer.restart(s,n.delay,n.time),s(u))}),n.state=fe,n.on.call("start",t,t.__data__,n.index,n.group),n.state===fe){for(n.state=Ft,i=new Array(h=n.tween.length),c=0,f=-1;c<h;++c)(d=n.tween[c].value.call(t,t.__data__,n.index,n.group))&&(i[++f]=d);i.length=f+1}}function s(u){for(var c=u<n.duration?n.ease.call(null,u/n.duration):(n.timer.restart(l),n.state=he,1),f=-1,h=i.length;++f<h;)i[f].call(t,c);n.state===he&&(n.on.call("end",t,t.__data__,n.index,n.group),l())}function l(){n.state=qt,n.timer.stop(),delete r[e];for(var u in r)return;delete t.__transition}}function xa(t,e){var n=t.__transition,r,i,a=!0,o;if(n){e=e==null?null:e+"";for(o in n){if((r=n[o]).name!==e){a=!1;continue}i=r.state>fe&&r.state<he,r.state=qt,r.timer.stop(),r.on.call(i?"interrupt":"cancel",t,t.__data__,r.index,r.group),delete n[o]}a&&delete t.__transition}}function ba(t){return this.each(function(){xa(this,t)})}function ka(t,e){var n,r;return function(){var i=J(this,t),a=i.tween;if(a!==n){r=n=a;for(var o=0,s=r.length;o<s;++o)if(r[o].name===e){r=r.slice(),r.splice(o,1);break}}i.tween=r}}function Aa(t,e,n){var r,i;if(typeof n!="function")throw new Error;return function(){var a=J(this,t),o=a.tween;if(o!==r){i=(r=o).slice();for(var s={name:e,value:n},l=0,u=i.length;l<u;++l)if(i[l].name===e){i[l]=s;break}l===u&&i.push(s)}a.tween=i}}function Ma(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r=Y(this.node(),n).tween,i=0,a=r.length,o;i<a;++i)if((o=r[i]).name===t)return o.value;return null}return this.each((e==null?ka:Aa)(n,t,e))}function Ae(t,e,n){var r=t._id;return t.each(function(){var i=J(this,r);(i.value||(i.value={}))[e]=n.apply(this,arguments)}),function(i){return Y(i,r).value[e]}}function Nn(t,e){var n;return(typeof e=="number"?B:e instanceof st?Ot:(n=st(e))?(e=n,Ot):wn)(t,e)}function $a(t){return function(){this.removeAttribute(t)}}function Na(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Ta(t,e,n){var r,i=n+"",a;return function(){var o=this.getAttribute(t);return o===i?null:o===r?a:a=e(r=o,n)}}function Sa(t,e,n){var r,i=n+"",a;return function(){var o=this.getAttributeNS(t.space,t.local);return o===i?null:o===r?a:a=e(r=o,n)}}function Ea(t,e,n){var r,i,a;return function(){var o,s=n(this),l;return s==null?void this.removeAttribute(t):(o=this.getAttribute(t),l=s+"",o===l?null:o===r&&l===i?a:(i=l,a=e(r=o,s)))}}function Ca(t,e,n){var r,i,a;return function(){var o,s=n(this),l;return s==null?void this.removeAttributeNS(t.space,t.local):(o=this.getAttributeNS(t.space,t.local),l=s+"",o===l?null:o===r&&l===i?a:(i=l,a=e(r=o,s)))}}function Ia(t,e){var n=Wt(t),r=n==="transform"?da:Nn;return this.attrTween(t,typeof e=="function"?(n.local?Ca:Ea)(n,r,Ae(this,"attr."+t,e)):e==null?(n.local?Na:$a)(n):(n.local?Sa:Ta)(n,r,e))}function Ra(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function za(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function Fa(t,e){var n,r;function i(){var a=e.apply(this,arguments);return a!==r&&(n=(r=a)&&za(t,a)),n}return i._value=e,i}function qa(t,e){var n,r;function i(){var a=e.apply(this,arguments);return a!==r&&(n=(r=a)&&Ra(t,a)),n}return i._value=e,i}function Pa(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var r=Wt(t);return this.tween(n,(r.local?Fa:qa)(r,e))}function Da(t,e){return function(){ke(this,t).delay=+e.apply(this,arguments)}}function Ha(t,e){return e=+e,function(){ke(this,t).delay=e}}function La(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?Da:Ha)(e,t)):Y(this.node(),e).delay}function Oa(t,e){return function(){J(this,t).duration=+e.apply(this,arguments)}}function Xa(t,e){return e=+e,function(){J(this,t).duration=e}}function Ba(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?Oa:Xa)(e,t)):Y(this.node(),e).duration}function Va(t,e){if(typeof e!="function")throw new Error;return function(){J(this,t).ease=e}}function Ua(t){var e=this._id;return arguments.length?this.each(Va(e,t)):Y(this.node(),e).ease}function Ya(t,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;J(this,t).ease=n}}function Ga(t){if(typeof t!="function")throw new Error;return this.each(Ya(this._id,t))}function Wa(t){typeof t!="function"&&(t=ln(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a=e[i],o=a.length,s=r[i]=[],l,u=0;u<o;++u)(l=a[u])&&t.call(l,l.__data__,u,a)&&s.push(l);return new j(r,this._parents,this._name,this._id)}function Za(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,a=Math.min(r,i),o=new Array(r),s=0;s<a;++s)for(var l=e[s],u=n[s],c=l.length,f=o[s]=new Array(c),h,d=0;d<c;++d)(h=l[d]||u[d])&&(f[d]=h);for(;s<r;++s)o[s]=e[s];return new j(o,this._parents,this._name,this._id)}function Ja(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function Ka(t,e,n){var r,i,a=Ja(e)?ke:J;return function(){var o=a(this,t),s=o.on;s!==r&&(i=(r=s).copy()).on(e,n),o.on=i}}function Qa(t,e){var n=this._id;return arguments.length<2?Y(this.node(),n).on.on(t):this.each(Ka(n,t,e))}function ja(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function to(){return this.on("end.remove",ja(this._id))}function eo(t){var e=this._name,n=this._id;typeof t!="function"&&(t=me(t));for(var r=this._groups,i=r.length,a=new Array(i),o=0;o<i;++o)for(var s=r[o],l=s.length,u=a[o]=new Array(l),c,f,h=0;h<l;++h)(c=s[h])&&(f=t.call(c,c.__data__,h,s))&&("__data__"in c&&(f.__data__=c.__data__),u[h]=f,Jt(u[h],e,n,h,u,Y(c,n)));return new j(a,this._parents,e,n)}function no(t){var e=this._name,n=this._id;typeof t!="function"&&(t=sn(t));for(var r=this._groups,i=r.length,a=[],o=[],s=0;s<i;++s)for(var l=r[s],u=l.length,c,f=0;f<u;++f)if(c=l[f]){for(var h=t.call(c,c.__data__,f,l),d,p=Y(c,n),m=0,k=h.length;m<k;++m)(d=h[m])&&Jt(d,e,n,m,h,p);a.push(h),o.push(c)}return new j(a,o,e,n)}var ro=$t.prototype.constructor;function io(){return new ro(this._groups,this._parents)}function ao(t,e){var n,r,i;return function(){var a=ht(this,t),o=(this.style.removeProperty(t),ht(this,t));return a===o?null:a===n&&o===r?i:i=e(n=a,r=o)}}function Tn(t){return function(){this.style.removeProperty(t)}}function oo(t,e,n){var r,i=n+"",a;return function(){var o=ht(this,t);return o===i?null:o===r?a:a=e(r=o,n)}}function so(t,e,n){var r,i,a;return function(){var o=ht(this,t),s=n(this),l=s+"";return s==null&&(l=s=(this.style.removeProperty(t),ht(this,t))),o===l?null:o===r&&l===i?a:(i=l,a=e(r=o,s))}}function lo(t,e){var n,r,i,a="style."+e,o="end."+a,s;return function(){var l=J(this,t),u=l.on,c=l.value[a]==null?s||(s=Tn(e)):void 0;(u!==n||i!==c)&&(r=(n=u).copy()).on(o,i=c),l.on=r}}function uo(t,e,n){var r=(t+="")=="transform"?ha:Nn;return e==null?this.styleTween(t,ao(t,r)).on("end.style."+t,Tn(t)):typeof e=="function"?this.styleTween(t,so(t,r,Ae(this,"style."+t,e))).each(lo(this._id,t)):this.styleTween(t,oo(t,r,e),n).on("end.style."+t,null)}function co(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function fo(t,e,n){var r,i;function a(){var o=e.apply(this,arguments);return o!==i&&(r=(i=o)&&co(t,o,n)),r}return a._value=e,a}function ho(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;return this.tween(r,fo(t,e,n??""))}function po(t){return function(){this.textContent=t}}function vo(t){return function(){var e=t(this);this.textContent=e??""}}function go(t){return this.tween("text",typeof t=="function"?vo(Ae(this,"text",t)):po(t==null?"":t+""))}function mo(t){return function(e){this.textContent=t.call(this,e)}}function yo(t){var e,n;function r(){var i=t.apply(this,arguments);return i!==n&&(e=(n=i)&&mo(i)),e}return r._value=t,r}function _o(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,yo(t))}function wo(){for(var t=this._name,e=this._id,n=Sn(),r=this._groups,i=r.length,a=0;a<i;++a)for(var o=r[a],s=o.length,l,u=0;u<s;++u)if(l=o[u]){var c=Y(l,e);Jt(l,t,n,u,o,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new j(r,this._parents,t,n)}function xo(){var t,e,n=this,r=n._id,i=n.size();return new Promise(function(a,o){var s={value:o},l={value:function(){--i===0&&a()}};n.each(function(){var u=J(this,r),c=u.on;c!==t&&(e=(t=c).copy(),e._.cancel.push(s),e._.interrupt.push(s),e._.end.push(l)),u.on=e}),i===0&&a()})}var bo=0;function j(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function Sn(){return++bo}var Q=$t.prototype;j.prototype={constructor:j,select:eo,selectAll:no,selectChild:Q.selectChild,selectChildren:Q.selectChildren,filter:Wa,merge:Za,selection:io,transition:wo,call:Q.call,nodes:Q.nodes,node:Q.node,size:Q.size,empty:Q.empty,each:Q.each,on:Qa,attr:Ia,attrTween:Pa,style:uo,styleTween:ho,text:go,textTween:_o,remove:to,tween:Ma,delay:La,duration:Ba,ease:Ua,easeVarying:Ga,end:xo,[Symbol.iterator]:Q[Symbol.iterator]};function ko(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var Ao={time:null,delay:0,duration:250,ease:ko};function Mo(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function $o(t){var e,n;t instanceof j?(e=t._id,t=t._name):(e=Sn(),(n=Ao).time=be(),t=t==null?null:t+"");for(var r=this._groups,i=r.length,a=0;a<i;++a)for(var o=r[a],s=o.length,l,u=0;u<s;++u)(l=o[u])&&Jt(l,t,e,u,o,n||Mo(l,e));return new j(r,this._parents,t,e)}$t.prototype.interrupt=ba;$t.prototype.transition=$o;const de=Math.PI,pe=2*de,nt=1e-6,No=pe-nt;function En(t){this._+=t[0];for(let e=1,n=t.length;e<n;++e)this._+=arguments[e]+t[e]}function To(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return En;const n=10**e;return function(r){this._+=r[0];for(let i=1,a=r.length;i<a;++i)this._+=Math.round(arguments[i]*n)/n+r[i]}}class So{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?En:To(e)}moveTo(e,n){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,n){this._append`L${this._x1=+e},${this._y1=+n}`}quadraticCurveTo(e,n,r,i){this._append`Q${+e},${+n},${this._x1=+r},${this._y1=+i}`}bezierCurveTo(e,n,r,i,a,o){this._append`C${+e},${+n},${+r},${+i},${this._x1=+a},${this._y1=+o}`}arcTo(e,n,r,i,a){if(e=+e,n=+n,r=+r,i=+i,a=+a,a<0)throw new Error(`negative radius: ${a}`);let o=this._x1,s=this._y1,l=r-e,u=i-n,c=o-e,f=s-n,h=c*c+f*f;if(this._x1===null)this._append`M${this._x1=e},${this._y1=n}`;else if(h>nt)if(!(Math.abs(f*l-u*c)>nt)||!a)this._append`L${this._x1=e},${this._y1=n}`;else{let d=r-o,p=i-s,m=l*l+u*u,k=d*d+p*p,$=Math.sqrt(m),N=Math.sqrt(h),b=a*Math.tan((de-Math.acos((m+h-k)/(2*$*N)))/2),R=b/N,v=b/$;Math.abs(R-1)>nt&&this._append`L${e+R*c},${n+R*f}`,this._append`A${a},${a},0,0,${+(f*d>c*p)},${this._x1=e+v*l},${this._y1=n+v*u}`}}arc(e,n,r,i,a,o){if(e=+e,n=+n,r=+r,o=!!o,r<0)throw new Error(`negative radius: ${r}`);let s=r*Math.cos(i),l=r*Math.sin(i),u=e+s,c=n+l,f=1^o,h=o?i-a:a-i;this._x1===null?this._append`M${u},${c}`:(Math.abs(this._x1-u)>nt||Math.abs(this._y1-c)>nt)&&this._append`L${u},${c}`,r&&(h<0&&(h=h%pe+pe),h>No?this._append`A${r},${r},0,1,${f},${e-s},${n-l}A${r},${r},0,1,${f},${this._x1=u},${this._y1=c}`:h>nt&&this._append`A${r},${r},0,${+(h>=de)},${f},${this._x1=e+r*Math.cos(a)},${this._y1=n+r*Math.sin(a)}`)}rect(e,n,r,i){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}h${r=+r}v${+i}h${-r}Z`}toString(){return this._}}var Be={},te={},ee=34,gt=10,ne=13;function Cn(t){return new Function("d","return {"+t.map(function(e,n){return JSON.stringify(e)+": d["+n+'] || ""'}).join(",")+"}")}function Eo(t,e){var n=Cn(t);return function(r,i){return e(n(r),i,t)}}function Ve(t){var e=Object.create(null),n=[];return t.forEach(function(r){for(var i in r)i in e||n.push(e[i]=i)}),n}function D(t,e){var n=t+"",r=n.length;return r<e?new Array(e-r+1).join(0)+n:n}function Co(t){return t<0?"-"+D(-t,6):t>9999?"+"+D(t,6):D(t,4)}function Io(t){var e=t.getUTCHours(),n=t.getUTCMinutes(),r=t.getUTCSeconds(),i=t.getUTCMilliseconds();return isNaN(t)?"Invalid Date":Co(t.getUTCFullYear())+"-"+D(t.getUTCMonth()+1,2)+"-"+D(t.getUTCDate(),2)+(i?"T"+D(e,2)+":"+D(n,2)+":"+D(r,2)+"."+D(i,3)+"Z":r?"T"+D(e,2)+":"+D(n,2)+":"+D(r,2)+"Z":n||e?"T"+D(e,2)+":"+D(n,2)+"Z":"")}function Ro(t){var e=new RegExp('["'+t+`
\r]`),n=t.charCodeAt(0);function r(f,h){var d,p,m=i(f,function(k,$){if(d)return d(k,$-1);p=k,d=h?Eo(k,h):Cn(k)});return m.columns=p||[],m}function i(f,h){var d=[],p=f.length,m=0,k=0,$,N=p<=0,b=!1;f.charCodeAt(p-1)===gt&&--p,f.charCodeAt(p-1)===ne&&--p;function R(){if(N)return te;if(b)return b=!1,Be;var _,x=m,w;if(f.charCodeAt(x)===ee){for(;m++<p&&f.charCodeAt(m)!==ee||f.charCodeAt(++m)===ee;);return(_=m)>=p?N=!0:(w=f.charCodeAt(m++))===gt?b=!0:w===ne&&(b=!0,f.charCodeAt(m)===gt&&++m),f.slice(x+1,_-1).replace(/""/g,'"')}for(;m<p;){if((w=f.charCodeAt(_=m++))===gt)b=!0;else if(w===ne)b=!0,f.charCodeAt(m)===gt&&++m;else if(w!==n)continue;return f.slice(x,_)}return N=!0,f.slice(x,p)}for(;($=R())!==te;){for(var v=[];$!==Be&&$!==te;)v.push($),$=R();h&&(v=h(v,k++))==null||d.push(v)}return d}function a(f,h){return f.map(function(d){return h.map(function(p){return c(d[p])}).join(t)})}function o(f,h){return h==null&&(h=Ve(f)),[h.map(c).join(t)].concat(a(f,h)).join(`
`)}function s(f,h){return h==null&&(h=Ve(f)),a(f,h).join(`
`)}function l(f){return f.map(u).join(`
`)}function u(f){return f.map(c).join(t)}function c(f){return f==null?"":f instanceof Date?Io(f):e.test(f+="")?'"'+f.replace(/"/g,'""')+'"':f}return{parse:r,parseRows:i,format:o,formatBody:s,formatRows:l,formatRow:u,formatValue:c}}var zo=Ro(","),Fo=zo.parse;function qo(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.text()}function Po(t,e){return fetch(t,e).then(qo)}function Do(t){return function(e,n,r){return arguments.length===2&&typeof n=="function"&&(r=n,n=void 0),Po(e,n).then(function(i){return t(i,r)})}}var Ho=Do(Fo);function Lo(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function Ut(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function pt(t){return t=Ut(Math.abs(t)),t?t[1]:NaN}function Oo(t,e){return function(n,r){for(var i=n.length,a=[],o=0,s=t[0],l=0;i>0&&s>0&&(l+s+1>r&&(s=Math.max(1,r-l)),a.push(n.substring(i-=s,i+s)),!((l+=s+1)>r));)s=t[o=(o+1)%t.length];return a.reverse().join(e)}}function Xo(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var Bo=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Yt(t){if(!(e=Bo.exec(t)))throw new Error("invalid format: "+t);var e;return new Me({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}Yt.prototype=Me.prototype;function Me(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}Me.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Vo(t){t:for(var e=t.length,n=1,r=-1,i;n<e;++n)switch(t[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+t[n])break t;r>0&&(r=0);break}return r>0?t.slice(0,r)+t.slice(i+1):t}var In;function Uo(t,e){var n=Ut(t,e);if(!n)return t+"";var r=n[0],i=n[1],a=i-(In=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,o=r.length;return a===o?r:a>o?r+new Array(a-o+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+Ut(t,Math.max(0,e+a-1))[0]}function Ue(t,e){var n=Ut(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const Ye={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:Lo,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>Ue(t*100,e),r:Ue,s:Uo,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function Ge(t){return t}var We=Array.prototype.map,Ze=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function Yo(t){var e=t.grouping===void 0||t.thousands===void 0?Ge:Oo(We.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",r=t.currency===void 0?"":t.currency[1]+"",i=t.decimal===void 0?".":t.decimal+"",a=t.numerals===void 0?Ge:Xo(We.call(t.numerals,String)),o=t.percent===void 0?"%":t.percent+"",s=t.minus===void 0?"−":t.minus+"",l=t.nan===void 0?"NaN":t.nan+"";function u(f){f=Yt(f);var h=f.fill,d=f.align,p=f.sign,m=f.symbol,k=f.zero,$=f.width,N=f.comma,b=f.precision,R=f.trim,v=f.type;v==="n"?(N=!0,v="g"):Ye[v]||(b===void 0&&(b=12),R=!0,v="g"),(k||h==="0"&&d==="=")&&(k=!0,h="0",d="=");var _=m==="$"?n:m==="#"&&/[boxX]/.test(v)?"0"+v.toLowerCase():"",x=m==="$"?r:/[%p]/.test(v)?o:"",w=Ye[v],M=/[defgprs%]/.test(v);b=b===void 0?6:/[gprs]/.test(v)?Math.max(1,Math.min(21,b)):Math.max(0,Math.min(20,b));function L(y){var z=_,F=x,G,I,E;if(v==="c")F=w(y)+F,y="";else{y=+y;var O=y<0||1/y<0;if(y=isNaN(y)?l:w(Math.abs(y),b),R&&(y=Vo(y)),O&&+y==0&&p!=="+"&&(O=!1),z=(O?p==="("?p:s:p==="-"||p==="("?"":p)+z,F=(v==="s"?Ze[8+In/3]:"")+F+(O&&p==="("?")":""),M){for(G=-1,I=y.length;++G<I;)if(E=y.charCodeAt(G),48>E||E>57){F=(E===46?i+y.slice(G+1):y.slice(G))+F,y=y.slice(0,G);break}}}N&&!k&&(y=e(y,1/0));var et=z.length+y.length+F.length,K=et<$?new Array($-et+1).join(h):"";switch(N&&k&&(y=e(K+y,K.length?$-F.length:1/0),K=""),d){case"<":y=z+y+F+K;break;case"=":y=z+K+y+F;break;case"^":y=K.slice(0,et=K.length>>1)+z+y+F+K.slice(et);break;default:y=K+z+y+F;break}return a(y)}return L.toString=function(){return f+""},L}function c(f,h){var d=u((f=Yt(f),f.type="f",f)),p=Math.max(-8,Math.min(8,Math.floor(pt(h)/3)))*3,m=Math.pow(10,-p),k=Ze[8+p/3];return function($){return d(m*$)+k}}return{format:u,formatPrefix:c}}var It,Rn,zn;Go({thousands:",",grouping:[3],currency:["$",""]});function Go(t){return It=Yo(t),Rn=It.format,zn=It.formatPrefix,It}function Wo(t){return Math.max(0,-pt(Math.abs(t)))}function Zo(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(pt(e)/3)))*3-pt(Math.abs(t)))}function Jo(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,pt(e)-pt(t))+1}function Ko(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function Qo(t){return function(){return t}}function jo(t){return+t}var Je=[0,1];function ct(t){return t}function ve(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:Qo(isNaN(e)?NaN:.5)}function ts(t,e){var n;return t>e&&(n=t,t=e,e=n),function(r){return Math.max(t,Math.min(e,r))}}function es(t,e,n){var r=t[0],i=t[1],a=e[0],o=e[1];return i<r?(r=ve(i,r),a=n(o,a)):(r=ve(r,i),a=n(a,o)),function(s){return a(r(s))}}function ns(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),a=new Array(r),o=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++o<r;)i[o]=ve(t[o],t[o+1]),a[o]=n(e[o],e[o+1]);return function(s){var l=Kn(t,s,1,r)-1;return a[l](i[l](s))}}function rs(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function is(){var t=Je,e=Je,n=xe,r,i,a,o=ct,s,l,u;function c(){var h=Math.min(t.length,e.length);return o!==ct&&(o=ts(t[0],t[h-1])),s=h>2?ns:es,l=u=null,f}function f(h){return h==null||isNaN(h=+h)?a:(l||(l=s(t.map(r),e,n)))(r(o(h)))}return f.invert=function(h){return o(i((u||(u=s(e,t.map(r),B)))(h)))},f.domain=function(h){return arguments.length?(t=Array.from(h,jo),c()):t.slice()},f.range=function(h){return arguments.length?(e=Array.from(h),c()):e.slice()},f.rangeRound=function(h){return e=Array.from(h),n=ua,c()},f.clamp=function(h){return arguments.length?(o=h?!0:ct,c()):o!==ct},f.interpolate=function(h){return arguments.length?(n=h,c()):n},f.unknown=function(h){return arguments.length?(a=h,f):a},function(h,d){return r=h,i=d,c()}}function as(){return is()(ct,ct)}function os(t,e,n,r){var i=nr(t,e,n),a;switch(r=Yt(r??",f"),r.type){case"s":{var o=Math.max(Math.abs(t),Math.abs(e));return r.precision==null&&!isNaN(a=Zo(i,o))&&(r.precision=a),zn(r,o)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(a=Jo(i,Math.max(Math.abs(t),Math.abs(e))))&&(r.precision=a-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(a=Wo(i))&&(r.precision=a-(r.type==="%")*2);break}}return Rn(r)}function ss(t){var e=t.domain;return t.ticks=function(n){var r=e();return er(r[0],r[r.length-1],n??10)},t.tickFormat=function(n,r){var i=e();return os(i[0],i[i.length-1],n??10,r)},t.nice=function(n){n==null&&(n=10);var r=e(),i=0,a=r.length-1,o=r[i],s=r[a],l,u,c=10;for(s<o&&(u=o,o=s,s=u,u=i,i=a,a=u);c-- >0;){if(u=ae(o,s,n),u===l)return r[i]=o,r[a]=s,e(r);if(u>0)o=Math.floor(o/u)*u,s=Math.ceil(s/u)*u;else if(u<0)o=Math.ceil(o*u)/u,s=Math.floor(s*u)/u;else break;l=u}return t},t}function ge(){var t=as();return t.copy=function(){return rs(t,ge())},Ko.apply(t,arguments),ss(t)}function ut(t){return function(){return t}}function ls(t){let e=3;return t.digits=function(n){if(!arguments.length)return e;if(n==null)e=null;else{const r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);e=r}return t},()=>new So(e)}function us(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function Fn(t){this._context=t}Fn.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function cs(t){return new Fn(t)}function fs(t){return t[0]}function hs(t){return t[1]}function ds(t,e){var n=ut(!0),r=null,i=cs,a=null,o=ls(s);t=typeof t=="function"?t:t===void 0?fs:ut(t),e=typeof e=="function"?e:e===void 0?hs:ut(e);function s(l){var u,c=(l=us(l)).length,f,h=!1,d;for(r==null&&(a=i(d=o())),u=0;u<=c;++u)!(u<c&&n(f=l[u],u,l))===h&&((h=!h)?a.lineStart():a.lineEnd()),h&&a.point(+t(f,u,l),+e(f,u,l));if(d)return a=null,d+""||null}return s.x=function(l){return arguments.length?(t=typeof l=="function"?l:ut(+l),s):t},s.y=function(l){return arguments.length?(e=typeof l=="function"?l:ut(+l),s):e},s.defined=function(l){return arguments.length?(n=typeof l=="function"?l:ut(!!l),s):n},s.curve=function(l){return arguments.length?(i=l,r!=null&&(a=i(r)),s):i},s.context=function(l){return arguments.length?(l==null?r=a=null:a=i(r=l),s):r},s}function bt(t,e,n){this.k=t,this.x=e,this.y=n}bt.prototype={constructor:bt,scale:function(t){return t===1?this:new bt(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new bt(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};bt.prototype;var ps=tt('<div class="legend-item svelte-jbmsv5"><span class="legend-line svelte-jbmsv5"></span> <span class="legend-text svelte-jbmsv5"> </span></div>'),vs=Gt('<line stroke="#333" stroke-width="1"></line><text fill="#fff" text-anchor="end" dominant-baseline="middle" class="svelte-jbmsv5"> </text>',1),gs=Gt('<line stroke="#333" stroke-width="1"></line><text fill="#fff" text-anchor="middle" class="svelte-jbmsv5"> </text>',1),ms=Gt('<path fill="none" stroke-width="2"></path>'),ys=Gt('<text fill="#fff" text-anchor="middle" transform="rotate(-90, 10, 200)" class="y-axis-title svelte-jbmsv5"> </text>'),_s=tt('<div class="chart-container svelte-jbmsv5"><h2 class="svelte-jbmsv5"> </h2> <div class="legend-container svelte-jbmsv5"></div> <svg height="400"><rect height="400" fill="#000"></rect><!><!><!><!></svg></div>');function mt(t,e){Ke(e,!1);let n=it(e,"path_to_data",8,""),r=it(e,"title",8,""),i=it(e,"yticks",24,()=>[]),a=it(e,"y_axis_title",8,""),o=W(750),s=W([]),l=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],u=["#8DBF2E","#00A189","#6FC7EA","#007FA3","#AB1368","#DC4633","#F1C500"];nn(()=>{const v=()=>{const _=document.querySelector(".chart-container");_&&P(o,Math.min(g(o),_.parentElement.clientWidth))};return v(),window.addEventListener("resize",v),Ho(n()).then(_=>{P(s,_.map(x=>{const w={Hour:+x.Hour};return l.forEach(M=>w[M]=+x[M]),w}))}),()=>window.removeEventListener("resize",v)});let c=W();re(()=>(g(s),g(o),qn(i())),()=>{if(g(s).length>0){const v=ge().domain([0,23]).range([50,g(o)-20]),_=ge().domain([ir(i()),rr(i())]).range([360,40]),x=ds().x(y=>v(y.Hour)).y(y=>_(y.value)),w=l.map(y=>({day:y,path:x(g(s).map(z=>({Hour:z.Hour,value:z[y]}))),color:u[l.indexOf(y)]})),M=Array.from({length:24},(y,z)=>z),L=[...i()];P(c,{x:v,y:_,lines:w,xTicks:M,yTicks:L})}}),Qe(),en();var f=_s(),h=C(f),d=C(h,!0);S(h);var p=T(h,2);yt(p,5,()=>{var v;return(v=g(c))==null?void 0:v.lines},_t,(v,_)=>{var x=ps(),w=C(x),M=T(w,2),L=C(M,!0);S(M),S(x),q(()=>{A(w,"style",`border-color: ${g(_).color??""}`),rt(L,g(_).day)}),X(v,x)}),S(p);var m=T(p,2),k=C(m),$=T(k);yt($,1,()=>{var v;return(v=g(c))==null?void 0:v.yTicks},_t,(v,_)=>{var x=vs(),w=ie(x);A(w,"x1",50),q(()=>A(w,"y1",g(c).y(g(_)))),q(()=>A(w,"y2",g(c).y(g(_))));var M=T(w);A(M,"x",45),q(()=>A(M,"y",g(c).y(g(_))));var L=C(M,!0);S(M),q(()=>{A(w,"x2",g(o)-20),rt(L,g(_))}),X(v,x)});var N=T($);yt(N,1,()=>{var v;return(v=g(c))==null?void 0:v.xTicks},_t,(v,_)=>{var x=gs(),w=ie(x);q(()=>A(w,"x1",g(c).x(g(_)))),A(w,"y1",360),q(()=>A(w,"x2",g(c).x(g(_)))),A(w,"y2",40);var M=T(w);q(()=>A(M,"x",g(c).x(g(_)))),A(M,"y",375);var L=C(M,!0);S(M),q(()=>rt(L,g(_))),X(v,x)});var b=T(N);yt(b,1,()=>{var v;return(v=g(c))==null?void 0:v.lines},_t,(v,_)=>{var x=ms();q(()=>{A(x,"d",g(_).path),A(x,"stroke",g(_).color)}),X(v,x)});var R=T(b);tn(R,a,v=>{var _=ys();A(_,"x",15),A(_,"y",205);var x=C(_,!0);S(_),q(()=>rt(x,a())),X(v,_)}),S(m),S(f),q(()=>{A(f,"style",`width: ${g(o)??""}px; height: 450px;`),rt(d,r()),A(m,"width",g(o)),A(m,"viewBox",`0 0 ${g(o)} 400`),A(k,"width",g(o))}),X(t,f),je()}const ws=""+new URL("../assets/top-image.JUTWmls1.png",import.meta.url).href;var xs=tt(`<!> <main class="svelte-uz1plv"><div class="title svelte-uz1plv"><img alt="" class="svelte-uz1plv"> <h1 class="svelte-uz1plv">Exploring hourly activity patterns in Toronto</h1> <p id="authors" class="svelte-uz1plv"><a href="https://camhkerr.com/" class="svelte-uz1plv">Cameron Kerr</a> <a href="https://www.urbandisplacement.org/team/julia-greenberg/" class="svelte-uz1plv">Julia Greenberg</a> <a href="https://jamaps.github.io/" class="svelte-uz1plv">Jeff Allen</a></p></div> <div class="text svelte-uz1plv"><p class="svelte-uz1plv">A city is a constantly changing complex system. Even hourly, as millions of people move from home to work, to events, and through their daily routines the city develops it's own pulse. We set out to visualize the pulse of the city and identify any patterns that emerge.</p> <p class="svelte-uz1plv">The Greater Toronto Area (GTA) provides a model area to investigate as it contains almost 7 million people and a diverse set of rural, mid-size-and mega- cities.</p> <p class="svelte-uz1plv">The bounding box around the GTA was subdivided into a rectangular grid containing over 16,000 grid cells each about 1km wide. To investigate hourly activity across the GTA the accumulated time in each of these grid cells was calculated. Hourly activity was measured by the accumulated time in each grid cell (i.e if 2 people spend half of the hour in a given cell, the region has an accumulated time of 1 in that hour). The time each person spends in each cell was calculated using a sample of mobile location data provided by Spectus. In the map below the total accumulated time is shown for the average weekday and weekend over the summer of 2024 in the GTA.</p></div> <!> <div class="text svelte-uz1plv"><p class="svelte-uz1plv">The map demonstrates that the patterns of total hourly activity are relatively constant throughout the average weekend and weekday. There are no large structural changes in the distribution of activity throughout the city. Hourly activity is concentrated around Toronto and it's surrounding large municipalities with more distant pockets having lower activity.</p> <p class="svelte-uz1plv">Smaller patterns which can be picked up include the increase in activity at the Toronto Pearson Airport during the day and the empty space it leaves at night. The only large scale change is the general drop in activity during the night, especially seen between 3am and 5 am. The plot below shows the number of active phones in the sample during each hour throughout the week. The observed drop could be due to the nature of the mobile location data, as cell phones send out less location pings during the night. Another factor could be people commuting from outside of the GTA and leaving during the night.</p></div> <!> <div class="text svelte-uz1plv"><p class="svelte-uz1plv">In the map above, the underlying population density distribution obscures the hourly changes which occur. To better visualize these changes we subtracted each cell's hourly activity by it's average hourly activity throughout the summer of 2024. This new metric measures how much more or less activity occurs in a given cell compared to it's typical activity.</p></div> <!> <div class="text svelte-uz1plv"><p class="svelte-uz1plv">This map demonstrates both large and small scale flucuations throughout the day. Similar to the previous map, most cells have a lower than average activity during the night and higher than average activity during the day. In addition, we can see movement from residential areas and into employment areas during the day. For example, the south-eastern part of Brampton is an employment area with the surrounding northern and western part containing residential areas. During the evening, these residential areas have a higher than average activity and during 9-5 on weekdays the employment areas are at higher activity. Similarly, Vaughan's primary employment area is located in the South and is surrounded by residential areas. Activity is concentrated in the employment areas during 9-5 on weekdays and spreads out to the surrounding areas in the evening. Due to it's high density it is difficult to discern similar patterns for Toronto, but a signfiicant increase in activity can be seen in the downtown core during working hours. Additionally, between 3 pm and 6 pm lines of increased activity can be seen on highway 400 and highway 401, representing the commute out of commercial areas.</p> <p class="svelte-uz1plv">In contrast to the commercial shift on weekdays, the progression through a weekend is less predicatable. In the evening the distribution is similar to that seen on weekdays, with most high activity occuring in residential areas. However, activity during the day is scattered throughout commercial and residential areas. The activity also starts much later in the day, with low activity in central areas as late as 11 am.</p> <h2 class="svelte-uz1plv">Diversity and clustering</h2> <p class="svelte-uz1plv">Diversity and clustering statistics were used to quantify the daily patterns observed in the maps above. To measure the diversity of hourly activity across the GTA, we applied Shannon's Diversity Index. This index captures both the number of cells with activity (richness) and how evenly that activity is distributed among them (evenness). A high Shannon index means that many cells have activity and that activity levels are relatively balanced across them. In contrast, a low Shannon index suggests that fewer cells are active and that activity is concentrated in specific cells. Note that this index is spatially unaware, if all the cells were shuffled into different positions on the map, the Shannon index value would remain the same.</p></div> <!> <div class="text svelte-uz1plv"><p class="svelte-uz1plv">In the plot above a clear 'pulse' in diversity forms throughout the day. Activity becomes more diverse during daytime hours, with an additional spike between 3 pm and 5 pm. The diversity subsequently drops off in the evening and overnight. Although the differences in the actual index values are relatively small, an Aligned Rank Transform (ART) ANOVA test confirmed that the variation in diversity between day and night is statistically significant. One possible explanation is that during the day people are more mobile and are accumulating less activity in specific cells, especially during commuting hours (when diversity peaks). Additionally, this diversity pulse appears later in the day on Saturdays and Sundays, likely due to delayed daily routines on weekends.</p> <p class="svelte-uz1plv">As mentioned above, Shannon's index reflects both richness and evenness. To better understand each components contribution to diversity, we can examine them seperately. In our case, richness represents the number of cells in the GTA which are visited within a given hour. Evenness represents the degree to which activity is uniformly distributed.</p></div> <!> <!> <div class="text svelte-uz1plv"><p class="svelte-uz1plv">The plot of richness (expressed here as the fraction of active cells) reveals a simlair daily 'pulse' to that seen in Shannon's diversity. During the day, more people are moving which generates activity in a large number of cells. At night, activity becomes concentrated in residential areas leaving roughly half of the cells inactive. Additionally, the drop in the number of phones (as seen in the first plot) contributes to a lower number of active cells.</p> <p class="svelte-uz1plv">Evenness follows a different pattern; it tends to spike at night and gradually decreases during the day, with a smaller increase on weekdays between 3pm and 5 pm. The nightime spike likely results from low activity levels where urban and rural cells experience minimal activity. The increase between 3 and 5 pm may reflect commuting, as people spread out more evenly across the GTA. Note that despite the distinct pattern seen, the numerical change in evenness is small.</p> <p class="svelte-uz1plv">To investigate clustering, we calculated Moran's I for each hour throughout the week. In our case, Moran's I measures whether cells with similar activity levels tend to be located near each other. A high Moran's I value indicates that cells with similar activity are spatially close, suggesting strong spatial autocorrelation. A value near zero suggests that activity levels are randomly distributed across space. A negative value indicates that high-activity cells are typically surrounded by low-activity cells and vice versa. Moran's I ranges from -1 (negative spatial autocorrelation) to +1 (positive spatial autocorrelation).</p></div> <!> <div class="text svelte-uz1plv"><p class="svelte-uz1plv">Clustering patterns also exhibit a noticeable 'pulse' throughout the day. Between 10 am and 5pm high levels of activity become more spatially concentrated. In the evening and overnight hours, this clustering diminishes and activity becomes more spatially dispersed. This pattern likely reflects the daily movement of people into concentrated employment or commercial areas during working hours, as reported in the maps above. Additionally, clustering is generally lower on weekends, particularly on Sundays. This supports our earlier observation in the maps that weekend activity lacks the structured, location-specific patterns which are observed during weekdays.</p></div></main>`,1);function Ss(t){var e=xs(),n=ie(e);Xn(n);var r=T(n,2),i=C(r),a=C(i);A(a,"src",ws),$e(4),S(i);var o=T(i,4);Ne(o,{title:"Mean hourly activity in Toronto via mobile phone data",folder_weekday:"exploring-hourly-activity-toronto/Weekday_Total_small",folder_weekend:"exploring-hourly-activity-toronto/Weekend_Total_small"});var s=T(o,4);mt(s,{path_to_data:"exploring-hourly-activity-toronto/data/pings_normalized.csv",title:"Hourly activity in Toronto by day of the week",yticks:[.5,.75,1,1.25,1.5],y_axis_title:"Mean normalized hourly activity"});var l=T(s,4);Ne(l,{title:"Mean-subtracted hourly activity in Toronto",folder_weekday:"exploring-hourly-activity-toronto/Weekday_Difference_small",folder_weekend:"exploring-hourly-activity-toronto/Weekend_Difference_small"});var u=T(l,4);mt(u,{path_to_data:"exploring-hourly-activity-toronto/data/shannon.csv",title:"Shannon diversity index of hourly activity in Toronto",yticks:[7.9,8,8.1,8.2],y_axis_title:""});var c=T(u,4);mt(c,{path_to_data:"exploring-hourly-activity-toronto/data/richness.csv",title:"Fraction of cells with activity throughout the day",yticks:[.4,.5,.6,.7],y_axis_title:"Richness"});var f=T(c,2);mt(f,{path_to_data:"exploring-hourly-activity-toronto/data/evenness.csv",title:"Evenness of activity throughout the day",yticks:[.86,.87,.88,.89,.9],y_axis_title:"Evenness"});var h=T(f,4);mt(h,{path_to_data:"exploring-hourly-activity-toronto/data/moran.csv",title:"Spatial clustering of hourly activity in Toronto",yticks:[.34,.38,.42,.46],y_axis_title:"Moran's I of hourly activity in Toronto"}),$e(2),S(r),X(t,e)}export{Ss as component};
