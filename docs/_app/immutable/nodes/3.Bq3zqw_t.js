import{a as X,t as et,n as Qt}from"../chunks/disclose-version.B_6IR0ZE.js";import{s as S,v as M,p as rn,aC as le,aD as an,t as F,q as on,g as p,$ as P,w as T,aE as G,ai as Bn,o as ue,e as Vn,aF as Ie}from"../chunks/runtime.GVz-zu-4.js";import{s as k,l as Un,e as ht,b as Yn,h as Gn,c as Wn,i as dt,r as Zn,t as ne}from"../chunks/top-logo-full.No6y6fF7.js";import{e as Rt,s as rt}from"../chunks/render.DcWhrcIw.js";import{p as j,i as sn}from"../chunks/props.BBmB40Jv.js";import{i as ln}from"../chunks/lifecycle.DqJ8SXdi.js";import{o as un,a as Jn}from"../chunks/index-client.CHCEbK_U.js";var Kn=et('<div id="bar" class="svelte-os6al8"><div id="logo" class="svelte-os6al8"><a href="https://www.schoolofcities.utoronto.ca/" class="svelte-os6al8"><img alt="School of Cities" class="svelte-os6al8"></a></div></div>');function Qn(t){var e=Kn(),n=S(e),r=S(n),i=S(r);k(i,"src",Un),M(r),M(n),M(e),X(t,e)}var jn=et("<span> </span>"),tr=et('<button aria-label="Play" class="svelte-14u9mog"><svg width="12" height="12" viewBox="0 0 12 12" fill="white" xmlns="http://www.w3.org/2000/svg"><polygon points="2,1 10,6 2,11"></polygon></svg></button>'),er=et('<button aria-label="Stop" class="svelte-14u9mog"><svg width="12" height="12" viewBox="0 0 12 12" fill="white" xmlns="http://www.w3.org/2000/svg"><rect x="2" y="2" width="8" height="8"></rect></svg></button>'),nr=et('<span class="svelte-14u9mog"> </span>'),rr=et('<div class="container svelte-14u9mog"><h3 class="svelte-14u9mog"> </h3> <div class="legend-container svelte-14u9mog"><div class="gradient-legend svelte-14u9mog"></div> <div class="legend-labels svelte-14u9mog"></div></div> <div class="controls svelte-14u9mog"><div class="range-play-wrapper svelte-14u9mog"><!> <div class="slider-wrapper svelte-14u9mog"><input type="range" min="0" max="23" step="1" class="custom-slider svelte-14u9mog"> <div class="ticks svelte-14u9mog"></div></div></div></div> <div class="mode-toggle svelte-14u9mog"><button class="svelte-14u9mog">Weekday</button> <button class="svelte-14u9mog">Weekend</button></div> <img loading="lazy" decoding="async" class="svelte-14u9mog"></div>');function Re(t,e){rn(e,!1);const n=G(),r=G();let i=j(e,"title",8,""),a=j(e,"folder_weekday",8,""),o=j(e,"folder_weekend",8,""),s=j(e,"legendColors",24,()=>[]),u=j(e,"legendLabels",24,()=>[]),l=G(),c=G(0),f=null,h=G(!1),d=G(!1),v=[],m=G("weekday");function x(C){C==="weekday"?P(l,a()):P(l,o()),P(m,C),N()}async function N(){P(d,!1),v=[],await $(p(n)[0]),setTimeout(async()=>{await Promise.all([$(p(n)[1]),$(p(n)[2]),$(p(n)[3])])},50),p(n).slice(4).forEach(C=>{requestIdleCallback(()=>$(C),{timeout:2e3})}),P(d,!0)}async function $(C){const R=new Image;R.src=C,R.decoding="async",await R.decode().catch(()=>{}),v.push(C)}un(()=>{x("weekday")}),Jn(()=>{clearInterval(f)});function A(){!p(h)&&p(d)&&(P(h,!0),f=setInterval(()=>{P(c,(p(c)+1)%24)},250))}function z(){P(h,!1),clearInterval(f)}le(()=>p(l),()=>{P(n,Array.from({length:24},(C,R)=>`/urban-activity-atlas/${p(l)}/Hour_${R}.png`))}),le(()=>{},()=>{P(r,Array.from({length:24},(C,R)=>R))}),an(),ln();var g=rr(),_=S(g),b=S(_,!0);M(_);var w=T(_,2),E=S(w);const q=Bn(()=>`background: linear-gradient(to right, ${s().join(",")??""})`);var y=T(E,2);ht(y,5,u,dt,(C,R,wt)=>{var ct=jn();Wn(ct,`label-${wt??""} svelte-14u9mog`);var Xn=S(ct,!0);M(ct),F(()=>rt(Xn,p(R))),X(C,ct)}),M(y),M(w);var D=T(w,2),I=S(D),J=S(I);sn(J,()=>!p(h),C=>{var R=tr();F(()=>R.disabled=!p(d)),Rt("click",R,A),X(C,R)},C=>{var R=er();Rt("click",R,z),X(C,R)});var _t=T(J,2),K=S(_t);Zn(K);var it=T(K,2);ht(it,5,()=>p(r),dt,(C,R)=>{var wt=nr(),ct=S(wt,!0);M(wt),F(()=>rt(ct,p(R))),X(C,wt)}),M(it),M(_t),M(I),M(D);var nt=T(D,2),O=S(nt),Ce=T(O,2);M(nt);var It=T(nt,2);M(g),F(()=>{rt(b,i()),k(E,"style",p(q)),K.disabled=!p(d),ne(O,"selected",p(m)==="weekday"),ne(Ce,"selected",p(m)==="weekend"),k(It,"src",p(d)?p(n)[p(c)]:"./urban-activity-atlas/exploring-daily-activity-toronto/blank-image.png"),k(It,"alt",`Hour ${p(c)}`),ne(It,"loading",!p(d))}),Yn(K,()=>p(c),C=>P(c,C)),Rt("click",O,()=>x("weekday")),Rt("click",Ce,()=>x("weekend")),Gn(It),X(t,g),on()}function Lt(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function ir(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function cn(t){let e,n,r;t.length!==2?(e=Lt,n=(s,u)=>Lt(t(s),u),r=(s,u)=>t(s)-u):(e=t===Lt||t===ir?t:ar,n=t,r=t);function i(s,u,l=0,c=s.length){if(l<c){if(e(u,u)!==0)return c;do{const f=l+c>>>1;n(s[f],u)<0?l=f+1:c=f}while(l<c)}return l}function a(s,u,l=0,c=s.length){if(l<c){if(e(u,u)!==0)return c;do{const f=l+c>>>1;n(s[f],u)<=0?l=f+1:c=f}while(l<c)}return l}function o(s,u,l=0,c=s.length){const f=i(s,u,l,c-1);return f>l&&r(s[f-1],u)>-r(s[f],u)?f-1:f}return{left:i,center:o,right:a}}function ar(){return 0}function or(t){return t===null?NaN:+t}const sr=cn(Lt),lr=sr.right;cn(or).center;const ur=Math.sqrt(50),cr=Math.sqrt(10),fr=Math.sqrt(2);function Xt(t,e,n){const r=(e-t)/Math.max(0,n),i=Math.floor(Math.log10(r)),a=r/Math.pow(10,i),o=a>=ur?10:a>=cr?5:a>=fr?2:1;let s,u,l;return i<0?(l=Math.pow(10,-i)/o,s=Math.round(t*l),u=Math.round(e*l),s/l<t&&++s,u/l>e&&--u,l=-l):(l=Math.pow(10,i)*o,s=Math.round(t/l),u=Math.round(e/l),s*l<t&&++s,u*l>e&&--u),u<s&&.5<=n&&n<2?Xt(t,e,n*2):[s,u,l]}function hr(t,e,n){if(e=+e,t=+t,n=+n,!(n>0))return[];if(t===e)return[t];const r=e<t,[i,a,o]=r?Xt(e,t,n):Xt(t,e,n);if(!(a>=i))return[];const s=a-i+1,u=new Array(s);if(r)if(o<0)for(let l=0;l<s;++l)u[l]=(a-l)/-o;else for(let l=0;l<s;++l)u[l]=(a-l)*o;else if(o<0)for(let l=0;l<s;++l)u[l]=(i+l)/-o;else for(let l=0;l<s;++l)u[l]=(i+l)*o;return u}function ce(t,e,n){return e=+e,t=+t,n=+n,Xt(t,e,n)[2]}function dr(t,e,n){e=+e,t=+t,n=+n;const r=e<t,i=r?ce(e,t,n):ce(t,e,n);return(r?-1:1)*(i<0?1/-i:i)}function pr(t,e){let n;for(const r of t)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);return n}function vr(t,e){let n;for(const r of t)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);return n}var gr={value:()=>{}};function fn(){for(var t=0,e=arguments.length,n={},r;t<e;++t){if(!(r=arguments[t]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new Ht(n)}function Ht(t){this._=t}function mr(t,e){return t.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}Ht.prototype=fn.prototype={constructor:Ht,on:function(t,e){var n=this._,r=mr(t+"",n),i,a=-1,o=r.length;if(arguments.length<2){for(;++a<o;)if((i=(t=r[a]).type)&&(i=yr(n[i],t.name)))return i;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++a<o;)if(i=(t=r[a]).type)n[i]=ze(n[i],t.name,e);else if(e==null)for(i in n)n[i]=ze(n[i],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new Ht(t)},call:function(t,e){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,a;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(a=this._[t],r=0,i=a.length;r<i;++r)a[r].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,a=r.length;i<a;++i)r[i].value.apply(e,n)}};function yr(t,e){for(var n=0,r=t.length,i;n<r;++n)if((i=t[n]).name===e)return i.value}function ze(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=gr,t=t.slice(0,r).concat(t.slice(r+1));break}return n!=null&&t.push({name:e,value:n}),t}var fe="http://www.w3.org/1999/xhtml";const Fe={svg:"http://www.w3.org/2000/svg",xhtml:fe,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function jt(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),Fe.hasOwnProperty(e)?{space:Fe[e],local:t}:t}function _r(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===fe&&e.documentElement.namespaceURI===fe?e.createElement(t):e.createElementNS(n,t)}}function wr(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function hn(t){var e=jt(t);return(e.local?wr:_r)(e)}function xr(){}function be(t){return t==null?xr:function(){return this.querySelector(t)}}function br(t){typeof t!="function"&&(t=be(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a=e[i],o=a.length,s=r[i]=new Array(o),u,l,c=0;c<o;++c)(u=a[c])&&(l=t.call(u,u.__data__,c,a))&&("__data__"in u&&(l.__data__=u.__data__),s[c]=l);return new U(r,this._parents)}function kr(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function Ar(){return[]}function dn(t){return t==null?Ar:function(){return this.querySelectorAll(t)}}function Mr(t){return function(){return kr(t.apply(this,arguments))}}function $r(t){typeof t=="function"?t=Mr(t):t=dn(t);for(var e=this._groups,n=e.length,r=[],i=[],a=0;a<n;++a)for(var o=e[a],s=o.length,u,l=0;l<s;++l)(u=o[l])&&(r.push(t.call(u,u.__data__,l,o)),i.push(u));return new U(r,i)}function pn(t){return function(){return this.matches(t)}}function vn(t){return function(e){return e.matches(t)}}var Tr=Array.prototype.find;function Nr(t){return function(){return Tr.call(this.children,t)}}function Sr(){return this.firstElementChild}function Er(t){return this.select(t==null?Sr:Nr(typeof t=="function"?t:vn(t)))}var Cr=Array.prototype.filter;function Ir(){return Array.from(this.children)}function Rr(t){return function(){return Cr.call(this.children,t)}}function zr(t){return this.selectAll(t==null?Ir:Rr(typeof t=="function"?t:vn(t)))}function Fr(t){typeof t!="function"&&(t=pn(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a=e[i],o=a.length,s=r[i]=[],u,l=0;l<o;++l)(u=a[l])&&t.call(u,u.__data__,l,a)&&s.push(u);return new U(r,this._parents)}function gn(t){return new Array(t.length)}function Dr(){return new U(this._enter||this._groups.map(gn),this._parents)}function Bt(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}Bt.prototype={constructor:Bt,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function Pr(t){return function(){return t}}function Lr(t,e,n,r,i,a){for(var o=0,s,u=e.length,l=a.length;o<l;++o)(s=e[o])?(s.__data__=a[o],r[o]=s):n[o]=new Bt(t,a[o]);for(;o<u;++o)(s=e[o])&&(i[o]=s)}function Hr(t,e,n,r,i,a,o){var s,u,l=new Map,c=e.length,f=a.length,h=new Array(c),d;for(s=0;s<c;++s)(u=e[s])&&(h[s]=d=o.call(u,u.__data__,s,e)+"",l.has(d)?i[s]=u:l.set(d,u));for(s=0;s<f;++s)d=o.call(t,a[s],s,a)+"",(u=l.get(d))?(r[s]=u,u.__data__=a[s],l.delete(d)):n[s]=new Bt(t,a[s]);for(s=0;s<c;++s)(u=e[s])&&l.get(h[s])===u&&(i[s]=u)}function qr(t){return t.__data__}function Or(t,e){if(!arguments.length)return Array.from(this,qr);var n=e?Hr:Lr,r=this._parents,i=this._groups;typeof t!="function"&&(t=Pr(t));for(var a=i.length,o=new Array(a),s=new Array(a),u=new Array(a),l=0;l<a;++l){var c=r[l],f=i[l],h=f.length,d=Xr(t.call(c,c&&c.__data__,l,r)),v=d.length,m=s[l]=new Array(v),x=o[l]=new Array(v),N=u[l]=new Array(h);n(c,f,m,x,N,d,e);for(var $=0,A=0,z,g;$<v;++$)if(z=m[$]){for($>=A&&(A=$+1);!(g=x[A])&&++A<v;);z._next=g||null}}return o=new U(o,r),o._enter=s,o._exit=u,o}function Xr(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function Br(){return new U(this._exit||this._groups.map(gn),this._parents)}function Vr(t,e,n){var r=this.enter(),i=this,a=this.exit();return typeof t=="function"?(r=t(r),r&&(r=r.selection())):r=r.append(t+""),e!=null&&(i=e(i),i&&(i=i.selection())),n==null?a.remove():n(a),r&&i?r.merge(i).order():i}function Ur(t){for(var e=t.selection?t.selection():t,n=this._groups,r=e._groups,i=n.length,a=r.length,o=Math.min(i,a),s=new Array(i),u=0;u<o;++u)for(var l=n[u],c=r[u],f=l.length,h=s[u]=new Array(f),d,v=0;v<f;++v)(d=l[v]||c[v])&&(h[v]=d);for(;u<i;++u)s[u]=n[u];return new U(s,this._parents)}function Yr(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r=t[e],i=r.length-1,a=r[i],o;--i>=0;)(o=r[i])&&(a&&o.compareDocumentPosition(a)^4&&a.parentNode.insertBefore(o,a),a=o);return this}function Gr(t){t||(t=Wr);function e(f,h){return f&&h?t(f.__data__,h.__data__):!f-!h}for(var n=this._groups,r=n.length,i=new Array(r),a=0;a<r;++a){for(var o=n[a],s=o.length,u=i[a]=new Array(s),l,c=0;c<s;++c)(l=o[c])&&(u[c]=l);u.sort(e)}return new U(i,this._parents).order()}function Wr(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function Zr(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function Jr(){return Array.from(this)}function Kr(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,a=r.length;i<a;++i){var o=r[i];if(o)return o}return null}function Qr(){let t=0;for(const e of this)++t;return t}function jr(){return!this.node()}function ti(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i=e[n],a=0,o=i.length,s;a<o;++a)(s=i[a])&&t.call(s,s.__data__,a,i);return this}function ei(t){return function(){this.removeAttribute(t)}}function ni(t){return function(){this.removeAttributeNS(t.space,t.local)}}function ri(t,e){return function(){this.setAttribute(t,e)}}function ii(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function ai(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function oi(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function si(t,e){var n=jt(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((e==null?n.local?ni:ei:typeof e=="function"?n.local?oi:ai:n.local?ii:ri)(n,e))}function mn(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function li(t){return function(){this.style.removeProperty(t)}}function ui(t,e,n){return function(){this.style.setProperty(t,e,n)}}function ci(t,e,n){return function(){var r=e.apply(this,arguments);r==null?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function fi(t,e,n){return arguments.length>1?this.each((e==null?li:typeof e=="function"?ci:ui)(t,e,n??"")):gt(this.node(),t)}function gt(t,e){return t.style.getPropertyValue(e)||mn(t).getComputedStyle(t,null).getPropertyValue(e)}function hi(t){return function(){delete this[t]}}function di(t,e){return function(){this[t]=e}}function pi(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function vi(t,e){return arguments.length>1?this.each((e==null?hi:typeof e=="function"?pi:di)(t,e)):this.node()[t]}function yn(t){return t.trim().split(/^|\s+/)}function ke(t){return t.classList||new _n(t)}function _n(t){this._node=t,this._names=yn(t.getAttribute("class")||"")}_n.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function wn(t,e){for(var n=ke(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function xn(t,e){for(var n=ke(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function gi(t){return function(){wn(this,t)}}function mi(t){return function(){xn(this,t)}}function yi(t,e){return function(){(e.apply(this,arguments)?wn:xn)(this,t)}}function _i(t,e){var n=yn(t+"");if(arguments.length<2){for(var r=ke(this.node()),i=-1,a=n.length;++i<a;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof e=="function"?yi:e?gi:mi)(n,e))}function wi(){this.textContent=""}function xi(t){return function(){this.textContent=t}}function bi(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function ki(t){return arguments.length?this.each(t==null?wi:(typeof t=="function"?bi:xi)(t)):this.node().textContent}function Ai(){this.innerHTML=""}function Mi(t){return function(){this.innerHTML=t}}function $i(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function Ti(t){return arguments.length?this.each(t==null?Ai:(typeof t=="function"?$i:Mi)(t)):this.node().innerHTML}function Ni(){this.nextSibling&&this.parentNode.appendChild(this)}function Si(){return this.each(Ni)}function Ei(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Ci(){return this.each(Ei)}function Ii(t){var e=typeof t=="function"?t:hn(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function Ri(){return null}function zi(t,e){var n=typeof t=="function"?t:hn(t),r=e==null?Ri:typeof e=="function"?e:be(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function Fi(){var t=this.parentNode;t&&t.removeChild(this)}function Di(){return this.each(Fi)}function Pi(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Li(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Hi(t){return this.select(t?Li:Pi)}function qi(t){return arguments.length?this.property("__data__",t):this.node().__data__}function Oi(t){return function(e){t.call(this,e,this.__data__)}}function Xi(t){return t.trim().split(/^|\s+/).map(function(e){var n="",r=e.indexOf(".");return r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),{type:e,name:n}})}function Bi(t){return function(){var e=this.__on;if(e){for(var n=0,r=-1,i=e.length,a;n<i;++n)a=e[n],(!t.type||a.type===t.type)&&a.name===t.name?this.removeEventListener(a.type,a.listener,a.options):e[++r]=a;++r?e.length=r:delete this.__on}}}function Vi(t,e,n){return function(){var r=this.__on,i,a=Oi(e);if(r){for(var o=0,s=r.length;o<s;++o)if((i=r[o]).type===t.type&&i.name===t.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=a,i.options=n),i.value=e;return}}this.addEventListener(t.type,a,n),i={type:t.type,name:t.name,value:e,listener:a,options:n},r?r.push(i):this.__on=[i]}}function Ui(t,e,n){var r=Xi(t+""),i,a=r.length,o;if(arguments.length<2){var s=this.node().__on;if(s){for(var u=0,l=s.length,c;u<l;++u)for(i=0,c=s[u];i<a;++i)if((o=r[i]).type===c.type&&o.name===c.name)return c.value}return}for(s=e?Vi:Bi,i=0;i<a;++i)this.each(s(r[i],e,n));return this}function bn(t,e,n){var r=mn(t),i=r.CustomEvent;typeof i=="function"?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function Yi(t,e){return function(){return bn(this,t,e)}}function Gi(t,e){return function(){return bn(this,t,e.apply(this,arguments))}}function Wi(t,e){return this.each((typeof e=="function"?Gi:Yi)(t,e))}function*Zi(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,a=r.length,o;i<a;++i)(o=r[i])&&(yield o)}var Ji=[null];function U(t,e){this._groups=t,this._parents=e}function Et(){return new U([[document.documentElement]],Ji)}function Ki(){return this}U.prototype=Et.prototype={constructor:U,select:br,selectAll:$r,selectChild:Er,selectChildren:zr,filter:Fr,data:Or,enter:Dr,exit:Br,join:Vr,merge:Ur,selection:Ki,order:Yr,sort:Gr,call:Zr,nodes:Jr,node:Kr,size:Qr,empty:jr,each:ti,attr:si,style:fi,property:vi,classed:_i,text:ki,html:Ti,raise:Si,lower:Ci,append:Ii,insert:zi,remove:Di,clone:Hi,datum:qi,on:Ui,dispatch:Wi,[Symbol.iterator]:Zi};function Ae(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function kn(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Ct(){}var Tt=.7,Vt=1/Tt,vt="\\s*([+-]?\\d+)\\s*",Nt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",W="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Qi=/^#([0-9a-f]{3,8})$/,ji=new RegExp(`^rgb\\(${vt},${vt},${vt}\\)$`),ta=new RegExp(`^rgb\\(${W},${W},${W}\\)$`),ea=new RegExp(`^rgba\\(${vt},${vt},${vt},${Nt}\\)$`),na=new RegExp(`^rgba\\(${W},${W},${W},${Nt}\\)$`),ra=new RegExp(`^hsl\\(${Nt},${W},${W}\\)$`),ia=new RegExp(`^hsla\\(${Nt},${W},${W},${Nt}\\)$`),De={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Ae(Ct,lt,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Pe,formatHex:Pe,formatHex8:aa,formatHsl:oa,formatRgb:Le,toString:Le});function Pe(){return this.rgb().formatHex()}function aa(){return this.rgb().formatHex8()}function oa(){return An(this).formatHsl()}function Le(){return this.rgb().formatRgb()}function lt(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=Qi.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?He(e):n===3?new H(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?zt(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?zt(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=ji.exec(t))?new H(e[1],e[2],e[3],1):(e=ta.exec(t))?new H(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=ea.exec(t))?zt(e[1],e[2],e[3],e[4]):(e=na.exec(t))?zt(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=ra.exec(t))?Xe(e[1],e[2]/100,e[3]/100,1):(e=ia.exec(t))?Xe(e[1],e[2]/100,e[3]/100,e[4]):De.hasOwnProperty(t)?He(De[t]):t==="transparent"?new H(NaN,NaN,NaN,0):null}function He(t){return new H(t>>16&255,t>>8&255,t&255,1)}function zt(t,e,n,r){return r<=0&&(t=e=n=NaN),new H(t,e,n,r)}function sa(t){return t instanceof Ct||(t=lt(t)),t?(t=t.rgb(),new H(t.r,t.g,t.b,t.opacity)):new H}function he(t,e,n,r){return arguments.length===1?sa(t):new H(t,e,n,r??1)}function H(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}Ae(H,he,kn(Ct,{brighter(t){return t=t==null?Vt:Math.pow(Vt,t),new H(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?Tt:Math.pow(Tt,t),new H(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new H(st(this.r),st(this.g),st(this.b),Ut(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:qe,formatHex:qe,formatHex8:la,formatRgb:Oe,toString:Oe}));function qe(){return`#${ot(this.r)}${ot(this.g)}${ot(this.b)}`}function la(){return`#${ot(this.r)}${ot(this.g)}${ot(this.b)}${ot((isNaN(this.opacity)?1:this.opacity)*255)}`}function Oe(){const t=Ut(this.opacity);return`${t===1?"rgb(":"rgba("}${st(this.r)}, ${st(this.g)}, ${st(this.b)}${t===1?")":`, ${t})`}`}function Ut(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function st(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function ot(t){return t=st(t),(t<16?"0":"")+t.toString(16)}function Xe(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new V(t,e,n,r)}function An(t){if(t instanceof V)return new V(t.h,t.s,t.l,t.opacity);if(t instanceof Ct||(t=lt(t)),!t)return new V;if(t instanceof V)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),a=Math.max(e,n,r),o=NaN,s=a-i,u=(a+i)/2;return s?(e===a?o=(n-r)/s+(n<r)*6:n===a?o=(r-e)/s+2:o=(e-n)/s+4,s/=u<.5?a+i:2-a-i,o*=60):s=u>0&&u<1?0:o,new V(o,s,u,t.opacity)}function ua(t,e,n,r){return arguments.length===1?An(t):new V(t,e,n,r??1)}function V(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}Ae(V,ua,kn(Ct,{brighter(t){return t=t==null?Vt:Math.pow(Vt,t),new V(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?Tt:Math.pow(Tt,t),new V(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new H(re(t>=240?t-240:t+120,i,r),re(t,i,r),re(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new V(Be(this.h),Ft(this.s),Ft(this.l),Ut(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Ut(this.opacity);return`${t===1?"hsl(":"hsla("}${Be(this.h)}, ${Ft(this.s)*100}%, ${Ft(this.l)*100}%${t===1?")":`, ${t})`}`}}));function Be(t){return t=(t||0)%360,t<0?t+360:t}function Ft(t){return Math.max(0,Math.min(1,t||0))}function re(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}const Me=t=>()=>t;function ca(t,e){return function(n){return t+n*e}}function fa(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function ha(t){return(t=+t)==1?Mn:function(e,n){return n-e?fa(e,n,t):Me(isNaN(e)?n:e)}}function Mn(t,e){var n=e-t;return n?ca(t,n):Me(isNaN(t)?e:t)}const Yt=function t(e){var n=ha(e);function r(i,a){var o=n((i=he(i)).r,(a=he(a)).r),s=n(i.g,a.g),u=n(i.b,a.b),l=Mn(i.opacity,a.opacity);return function(c){return i.r=o(c),i.g=s(c),i.b=u(c),i.opacity=l(c),i+""}}return r.gamma=t,r}(1);function da(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,r=e.slice(),i;return function(a){for(i=0;i<n;++i)r[i]=t[i]*(1-a)+e[i]*a;return r}}function pa(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function va(t,e){var n=e?e.length:0,r=t?Math.min(n,t.length):0,i=new Array(r),a=new Array(n),o;for(o=0;o<r;++o)i[o]=$e(t[o],e[o]);for(;o<n;++o)a[o]=e[o];return function(s){for(o=0;o<r;++o)a[o]=i[o](s);return a}}function ga(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function B(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function ma(t,e){var n={},r={},i;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(i in e)i in t?n[i]=$e(t[i],e[i]):r[i]=e[i];return function(a){for(i in n)r[i]=n[i](a);return r}}var de=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,ie=new RegExp(de.source,"g");function ya(t){return function(){return t}}function _a(t){return function(e){return t(e)+""}}function $n(t,e){var n=de.lastIndex=ie.lastIndex=0,r,i,a,o=-1,s=[],u=[];for(t=t+"",e=e+"";(r=de.exec(t))&&(i=ie.exec(e));)(a=i.index)>n&&(a=e.slice(n,a),s[o]?s[o]+=a:s[++o]=a),(r=r[0])===(i=i[0])?s[o]?s[o]+=i:s[++o]=i:(s[++o]=null,u.push({i:o,x:B(r,i)})),n=ie.lastIndex;return n<e.length&&(a=e.slice(n),s[o]?s[o]+=a:s[++o]=a),s.length<2?u[0]?_a(u[0].x):ya(e):(e=u.length,function(l){for(var c=0,f;c<e;++c)s[(f=u[c]).i]=f.x(l);return s.join("")})}function $e(t,e){var n=typeof e,r;return e==null||n==="boolean"?Me(e):(n==="number"?B:n==="string"?(r=lt(e))?(e=r,Yt):$n:e instanceof lt?Yt:e instanceof Date?ga:pa(e)?da:Array.isArray(e)?va:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?ma:B)(t,e)}function wa(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}var Ve=180/Math.PI,pe={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Tn(t,e,n,r,i,a){var o,s,u;return(o=Math.sqrt(t*t+e*e))&&(t/=o,e/=o),(u=t*n+e*r)&&(n-=t*u,r-=e*u),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,u/=s),t*r<e*n&&(t=-t,e=-e,u=-u,o=-o),{translateX:i,translateY:a,rotate:Math.atan2(e,t)*Ve,skewX:Math.atan(u)*Ve,scaleX:o,scaleY:s}}var Dt;function xa(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?pe:Tn(e.a,e.b,e.c,e.d,e.e,e.f)}function ba(t){return t==null||(Dt||(Dt=document.createElementNS("http://www.w3.org/2000/svg","g")),Dt.setAttribute("transform",t),!(t=Dt.transform.baseVal.consolidate()))?pe:(t=t.matrix,Tn(t.a,t.b,t.c,t.d,t.e,t.f))}function Nn(t,e,n,r){function i(l){return l.length?l.pop()+" ":""}function a(l,c,f,h,d,v){if(l!==f||c!==h){var m=d.push("translate(",null,e,null,n);v.push({i:m-4,x:B(l,f)},{i:m-2,x:B(c,h)})}else(f||h)&&d.push("translate("+f+e+h+n)}function o(l,c,f,h){l!==c?(l-c>180?c+=360:c-l>180&&(l+=360),h.push({i:f.push(i(f)+"rotate(",null,r)-2,x:B(l,c)})):c&&f.push(i(f)+"rotate("+c+r)}function s(l,c,f,h){l!==c?h.push({i:f.push(i(f)+"skewX(",null,r)-2,x:B(l,c)}):c&&f.push(i(f)+"skewX("+c+r)}function u(l,c,f,h,d,v){if(l!==f||c!==h){var m=d.push(i(d)+"scale(",null,",",null,")");v.push({i:m-4,x:B(l,f)},{i:m-2,x:B(c,h)})}else(f!==1||h!==1)&&d.push(i(d)+"scale("+f+","+h+")")}return function(l,c){var f=[],h=[];return l=t(l),c=t(c),a(l.translateX,l.translateY,c.translateX,c.translateY,f,h),o(l.rotate,c.rotate,f,h),s(l.skewX,c.skewX,f,h),u(l.scaleX,l.scaleY,c.scaleX,c.scaleY,f,h),l=c=null,function(d){for(var v=-1,m=h.length,x;++v<m;)f[(x=h[v]).i]=x.x(d);return f.join("")}}}var ka=Nn(xa,"px, ","px)","deg)"),Aa=Nn(ba,", ",")",")"),mt=0,At=0,xt=0,Sn=1e3,Gt,Mt,Wt=0,ut=0,te=0,St=typeof performance=="object"&&performance.now?performance:Date,En=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Te(){return ut||(En(Ma),ut=St.now()+te)}function Ma(){ut=0}function Zt(){this._call=this._time=this._next=null}Zt.prototype=Cn.prototype={constructor:Zt,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?Te():+n)+(e==null?0:+e),!this._next&&Mt!==this&&(Mt?Mt._next=this:Gt=this,Mt=this),this._call=t,this._time=n,ve()},stop:function(){this._call&&(this._call=null,this._time=1/0,ve())}};function Cn(t,e,n){var r=new Zt;return r.restart(t,e,n),r}function $a(){Te(),++mt;for(var t=Gt,e;t;)(e=ut-t._time)>=0&&t._call.call(void 0,e),t=t._next;--mt}function Ue(){ut=(Wt=St.now())+te,mt=At=0;try{$a()}finally{mt=0,Na(),ut=0}}function Ta(){var t=St.now(),e=t-Wt;e>Sn&&(te-=e,Wt=t)}function Na(){for(var t,e=Gt,n,r=1/0;e;)e._call?(r>e._time&&(r=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:Gt=n);Mt=t,ve(r)}function ve(t){if(!mt){At&&(At=clearTimeout(At));var e=t-ut;e>24?(t<1/0&&(At=setTimeout(Ue,t-St.now()-te)),xt&&(xt=clearInterval(xt))):(xt||(Wt=St.now(),xt=setInterval(Ta,Sn)),mt=1,En(Ue))}}function Ye(t,e,n){var r=new Zt;return e=e==null?0:+e,r.restart(i=>{r.stop(),t(i+e)},e,n),r}var Sa=fn("start","end","cancel","interrupt"),Ea=[],In=0,Ge=1,ge=2,qt=3,We=4,me=5,Ot=6;function ee(t,e,n,r,i,a){var o=t.__transition;if(!o)t.__transition={};else if(n in o)return;Ca(t,n,{name:e,index:r,group:i,on:Sa,tween:Ea,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:In})}function Ne(t,e){var n=Y(t,e);if(n.state>In)throw new Error("too late; already scheduled");return n}function Z(t,e){var n=Y(t,e);if(n.state>qt)throw new Error("too late; already running");return n}function Y(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function Ca(t,e,n){var r=t.__transition,i;r[e]=n,n.timer=Cn(a,0,n.time);function a(l){n.state=Ge,n.timer.restart(o,n.delay,n.time),n.delay<=l&&o(l-n.delay)}function o(l){var c,f,h,d;if(n.state!==Ge)return u();for(c in r)if(d=r[c],d.name===n.name){if(d.state===qt)return Ye(o);d.state===We?(d.state=Ot,d.timer.stop(),d.on.call("interrupt",t,t.__data__,d.index,d.group),delete r[c]):+c<e&&(d.state=Ot,d.timer.stop(),d.on.call("cancel",t,t.__data__,d.index,d.group),delete r[c])}if(Ye(function(){n.state===qt&&(n.state=We,n.timer.restart(s,n.delay,n.time),s(l))}),n.state=ge,n.on.call("start",t,t.__data__,n.index,n.group),n.state===ge){for(n.state=qt,i=new Array(h=n.tween.length),c=0,f=-1;c<h;++c)(d=n.tween[c].value.call(t,t.__data__,n.index,n.group))&&(i[++f]=d);i.length=f+1}}function s(l){for(var c=l<n.duration?n.ease.call(null,l/n.duration):(n.timer.restart(u),n.state=me,1),f=-1,h=i.length;++f<h;)i[f].call(t,c);n.state===me&&(n.on.call("end",t,t.__data__,n.index,n.group),u())}function u(){n.state=Ot,n.timer.stop(),delete r[e];for(var l in r)return;delete t.__transition}}function Ia(t,e){var n=t.__transition,r,i,a=!0,o;if(n){e=e==null?null:e+"";for(o in n){if((r=n[o]).name!==e){a=!1;continue}i=r.state>ge&&r.state<me,r.state=Ot,r.timer.stop(),r.on.call(i?"interrupt":"cancel",t,t.__data__,r.index,r.group),delete n[o]}a&&delete t.__transition}}function Ra(t){return this.each(function(){Ia(this,t)})}function za(t,e){var n,r;return function(){var i=Z(this,t),a=i.tween;if(a!==n){r=n=a;for(var o=0,s=r.length;o<s;++o)if(r[o].name===e){r=r.slice(),r.splice(o,1);break}}i.tween=r}}function Fa(t,e,n){var r,i;if(typeof n!="function")throw new Error;return function(){var a=Z(this,t),o=a.tween;if(o!==r){i=(r=o).slice();for(var s={name:e,value:n},u=0,l=i.length;u<l;++u)if(i[u].name===e){i[u]=s;break}u===l&&i.push(s)}a.tween=i}}function Da(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r=Y(this.node(),n).tween,i=0,a=r.length,o;i<a;++i)if((o=r[i]).name===t)return o.value;return null}return this.each((e==null?za:Fa)(n,t,e))}function Se(t,e,n){var r=t._id;return t.each(function(){var i=Z(this,r);(i.value||(i.value={}))[e]=n.apply(this,arguments)}),function(i){return Y(i,r).value[e]}}function Rn(t,e){var n;return(typeof e=="number"?B:e instanceof lt?Yt:(n=lt(e))?(e=n,Yt):$n)(t,e)}function Pa(t){return function(){this.removeAttribute(t)}}function La(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Ha(t,e,n){var r,i=n+"",a;return function(){var o=this.getAttribute(t);return o===i?null:o===r?a:a=e(r=o,n)}}function qa(t,e,n){var r,i=n+"",a;return function(){var o=this.getAttributeNS(t.space,t.local);return o===i?null:o===r?a:a=e(r=o,n)}}function Oa(t,e,n){var r,i,a;return function(){var o,s=n(this),u;return s==null?void this.removeAttribute(t):(o=this.getAttribute(t),u=s+"",o===u?null:o===r&&u===i?a:(i=u,a=e(r=o,s)))}}function Xa(t,e,n){var r,i,a;return function(){var o,s=n(this),u;return s==null?void this.removeAttributeNS(t.space,t.local):(o=this.getAttributeNS(t.space,t.local),u=s+"",o===u?null:o===r&&u===i?a:(i=u,a=e(r=o,s)))}}function Ba(t,e){var n=jt(t),r=n==="transform"?Aa:Rn;return this.attrTween(t,typeof e=="function"?(n.local?Xa:Oa)(n,r,Se(this,"attr."+t,e)):e==null?(n.local?La:Pa)(n):(n.local?qa:Ha)(n,r,e))}function Va(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function Ua(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function Ya(t,e){var n,r;function i(){var a=e.apply(this,arguments);return a!==r&&(n=(r=a)&&Ua(t,a)),n}return i._value=e,i}function Ga(t,e){var n,r;function i(){var a=e.apply(this,arguments);return a!==r&&(n=(r=a)&&Va(t,a)),n}return i._value=e,i}function Wa(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var r=jt(t);return this.tween(n,(r.local?Ya:Ga)(r,e))}function Za(t,e){return function(){Ne(this,t).delay=+e.apply(this,arguments)}}function Ja(t,e){return e=+e,function(){Ne(this,t).delay=e}}function Ka(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?Za:Ja)(e,t)):Y(this.node(),e).delay}function Qa(t,e){return function(){Z(this,t).duration=+e.apply(this,arguments)}}function ja(t,e){return e=+e,function(){Z(this,t).duration=e}}function to(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?Qa:ja)(e,t)):Y(this.node(),e).duration}function eo(t,e){if(typeof e!="function")throw new Error;return function(){Z(this,t).ease=e}}function no(t){var e=this._id;return arguments.length?this.each(eo(e,t)):Y(this.node(),e).ease}function ro(t,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;Z(this,t).ease=n}}function io(t){if(typeof t!="function")throw new Error;return this.each(ro(this._id,t))}function ao(t){typeof t!="function"&&(t=pn(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a=e[i],o=a.length,s=r[i]=[],u,l=0;l<o;++l)(u=a[l])&&t.call(u,u.__data__,l,a)&&s.push(u);return new tt(r,this._parents,this._name,this._id)}function oo(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,a=Math.min(r,i),o=new Array(r),s=0;s<a;++s)for(var u=e[s],l=n[s],c=u.length,f=o[s]=new Array(c),h,d=0;d<c;++d)(h=u[d]||l[d])&&(f[d]=h);for(;s<r;++s)o[s]=e[s];return new tt(o,this._parents,this._name,this._id)}function so(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function lo(t,e,n){var r,i,a=so(e)?Ne:Z;return function(){var o=a(this,t),s=o.on;s!==r&&(i=(r=s).copy()).on(e,n),o.on=i}}function uo(t,e){var n=this._id;return arguments.length<2?Y(this.node(),n).on.on(t):this.each(lo(n,t,e))}function co(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function fo(){return this.on("end.remove",co(this._id))}function ho(t){var e=this._name,n=this._id;typeof t!="function"&&(t=be(t));for(var r=this._groups,i=r.length,a=new Array(i),o=0;o<i;++o)for(var s=r[o],u=s.length,l=a[o]=new Array(u),c,f,h=0;h<u;++h)(c=s[h])&&(f=t.call(c,c.__data__,h,s))&&("__data__"in c&&(f.__data__=c.__data__),l[h]=f,ee(l[h],e,n,h,l,Y(c,n)));return new tt(a,this._parents,e,n)}function po(t){var e=this._name,n=this._id;typeof t!="function"&&(t=dn(t));for(var r=this._groups,i=r.length,a=[],o=[],s=0;s<i;++s)for(var u=r[s],l=u.length,c,f=0;f<l;++f)if(c=u[f]){for(var h=t.call(c,c.__data__,f,u),d,v=Y(c,n),m=0,x=h.length;m<x;++m)(d=h[m])&&ee(d,e,n,m,h,v);a.push(h),o.push(c)}return new tt(a,o,e,n)}var vo=Et.prototype.constructor;function go(){return new vo(this._groups,this._parents)}function mo(t,e){var n,r,i;return function(){var a=gt(this,t),o=(this.style.removeProperty(t),gt(this,t));return a===o?null:a===n&&o===r?i:i=e(n=a,r=o)}}function zn(t){return function(){this.style.removeProperty(t)}}function yo(t,e,n){var r,i=n+"",a;return function(){var o=gt(this,t);return o===i?null:o===r?a:a=e(r=o,n)}}function _o(t,e,n){var r,i,a;return function(){var o=gt(this,t),s=n(this),u=s+"";return s==null&&(u=s=(this.style.removeProperty(t),gt(this,t))),o===u?null:o===r&&u===i?a:(i=u,a=e(r=o,s))}}function wo(t,e){var n,r,i,a="style."+e,o="end."+a,s;return function(){var u=Z(this,t),l=u.on,c=u.value[a]==null?s||(s=zn(e)):void 0;(l!==n||i!==c)&&(r=(n=l).copy()).on(o,i=c),u.on=r}}function xo(t,e,n){var r=(t+="")=="transform"?ka:Rn;return e==null?this.styleTween(t,mo(t,r)).on("end.style."+t,zn(t)):typeof e=="function"?this.styleTween(t,_o(t,r,Se(this,"style."+t,e))).each(wo(this._id,t)):this.styleTween(t,yo(t,r,e),n).on("end.style."+t,null)}function bo(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function ko(t,e,n){var r,i;function a(){var o=e.apply(this,arguments);return o!==i&&(r=(i=o)&&bo(t,o,n)),r}return a._value=e,a}function Ao(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;return this.tween(r,ko(t,e,n??""))}function Mo(t){return function(){this.textContent=t}}function $o(t){return function(){var e=t(this);this.textContent=e??""}}function To(t){return this.tween("text",typeof t=="function"?$o(Se(this,"text",t)):Mo(t==null?"":t+""))}function No(t){return function(e){this.textContent=t.call(this,e)}}function So(t){var e,n;function r(){var i=t.apply(this,arguments);return i!==n&&(e=(n=i)&&No(i)),e}return r._value=t,r}function Eo(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,So(t))}function Co(){for(var t=this._name,e=this._id,n=Fn(),r=this._groups,i=r.length,a=0;a<i;++a)for(var o=r[a],s=o.length,u,l=0;l<s;++l)if(u=o[l]){var c=Y(u,e);ee(u,t,n,l,o,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new tt(r,this._parents,t,n)}function Io(){var t,e,n=this,r=n._id,i=n.size();return new Promise(function(a,o){var s={value:o},u={value:function(){--i===0&&a()}};n.each(function(){var l=Z(this,r),c=l.on;c!==t&&(e=(t=c).copy(),e._.cancel.push(s),e._.interrupt.push(s),e._.end.push(u)),l.on=e}),i===0&&a()})}var Ro=0;function tt(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function Fn(){return++Ro}var Q=Et.prototype;tt.prototype={constructor:tt,select:ho,selectAll:po,selectChild:Q.selectChild,selectChildren:Q.selectChildren,filter:ao,merge:oo,selection:go,transition:Co,call:Q.call,nodes:Q.nodes,node:Q.node,size:Q.size,empty:Q.empty,each:Q.each,on:uo,attr:Ba,attrTween:Wa,style:xo,styleTween:Ao,text:To,textTween:Eo,remove:fo,tween:Da,delay:Ka,duration:to,ease:no,easeVarying:io,end:Io,[Symbol.iterator]:Q[Symbol.iterator]};function zo(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var Fo={time:null,delay:0,duration:250,ease:zo};function Do(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function Po(t){var e,n;t instanceof tt?(e=t._id,t=t._name):(e=Fn(),(n=Fo).time=Te(),t=t==null?null:t+"");for(var r=this._groups,i=r.length,a=0;a<i;++a)for(var o=r[a],s=o.length,u,l=0;l<s;++l)(u=o[l])&&ee(u,t,e,l,o,n||Do(u,e));return new tt(r,this._parents,t,e)}Et.prototype.interrupt=Ra;Et.prototype.transition=Po;const ye=Math.PI,_e=2*ye,at=1e-6,Lo=_e-at;function Dn(t){this._+=t[0];for(let e=1,n=t.length;e<n;++e)this._+=arguments[e]+t[e]}function Ho(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return Dn;const n=10**e;return function(r){this._+=r[0];for(let i=1,a=r.length;i<a;++i)this._+=Math.round(arguments[i]*n)/n+r[i]}}class qo{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?Dn:Ho(e)}moveTo(e,n){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,n){this._append`L${this._x1=+e},${this._y1=+n}`}quadraticCurveTo(e,n,r,i){this._append`Q${+e},${+n},${this._x1=+r},${this._y1=+i}`}bezierCurveTo(e,n,r,i,a,o){this._append`C${+e},${+n},${+r},${+i},${this._x1=+a},${this._y1=+o}`}arcTo(e,n,r,i,a){if(e=+e,n=+n,r=+r,i=+i,a=+a,a<0)throw new Error(`negative radius: ${a}`);let o=this._x1,s=this._y1,u=r-e,l=i-n,c=o-e,f=s-n,h=c*c+f*f;if(this._x1===null)this._append`M${this._x1=e},${this._y1=n}`;else if(h>at)if(!(Math.abs(f*u-l*c)>at)||!a)this._append`L${this._x1=e},${this._y1=n}`;else{let d=r-o,v=i-s,m=u*u+l*l,x=d*d+v*v,N=Math.sqrt(m),$=Math.sqrt(h),A=a*Math.tan((ye-Math.acos((m+h-x)/(2*N*$)))/2),z=A/$,g=A/N;Math.abs(z-1)>at&&this._append`L${e+z*c},${n+z*f}`,this._append`A${a},${a},0,0,${+(f*d>c*v)},${this._x1=e+g*u},${this._y1=n+g*l}`}}arc(e,n,r,i,a,o){if(e=+e,n=+n,r=+r,o=!!o,r<0)throw new Error(`negative radius: ${r}`);let s=r*Math.cos(i),u=r*Math.sin(i),l=e+s,c=n+u,f=1^o,h=o?i-a:a-i;this._x1===null?this._append`M${l},${c}`:(Math.abs(this._x1-l)>at||Math.abs(this._y1-c)>at)&&this._append`L${l},${c}`,r&&(h<0&&(h=h%_e+_e),h>Lo?this._append`A${r},${r},0,1,${f},${e-s},${n-u}A${r},${r},0,1,${f},${this._x1=l},${this._y1=c}`:h>at&&this._append`A${r},${r},0,${+(h>=ye)},${f},${this._x1=e+r*Math.cos(a)},${this._y1=n+r*Math.sin(a)}`)}rect(e,n,r,i){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}h${r=+r}v${+i}h${-r}Z`}toString(){return this._}}var Ze={},ae={},oe=34,bt=10,se=13;function Pn(t){return new Function("d","return {"+t.map(function(e,n){return JSON.stringify(e)+": d["+n+'] || ""'}).join(",")+"}")}function Oo(t,e){var n=Pn(t);return function(r,i){return e(n(r),i,t)}}function Je(t){var e=Object.create(null),n=[];return t.forEach(function(r){for(var i in r)i in e||n.push(e[i]=i)}),n}function L(t,e){var n=t+"",r=n.length;return r<e?new Array(e-r+1).join(0)+n:n}function Xo(t){return t<0?"-"+L(-t,6):t>9999?"+"+L(t,6):L(t,4)}function Bo(t){var e=t.getUTCHours(),n=t.getUTCMinutes(),r=t.getUTCSeconds(),i=t.getUTCMilliseconds();return isNaN(t)?"Invalid Date":Xo(t.getUTCFullYear())+"-"+L(t.getUTCMonth()+1,2)+"-"+L(t.getUTCDate(),2)+(i?"T"+L(e,2)+":"+L(n,2)+":"+L(r,2)+"."+L(i,3)+"Z":r?"T"+L(e,2)+":"+L(n,2)+":"+L(r,2)+"Z":n||e?"T"+L(e,2)+":"+L(n,2)+"Z":"")}function Vo(t){var e=new RegExp('["'+t+`
\r]`),n=t.charCodeAt(0);function r(f,h){var d,v,m=i(f,function(x,N){if(d)return d(x,N-1);v=x,d=h?Oo(x,h):Pn(x)});return m.columns=v||[],m}function i(f,h){var d=[],v=f.length,m=0,x=0,N,$=v<=0,A=!1;f.charCodeAt(v-1)===bt&&--v,f.charCodeAt(v-1)===se&&--v;function z(){if($)return ae;if(A)return A=!1,Ze;var _,b=m,w;if(f.charCodeAt(b)===oe){for(;m++<v&&f.charCodeAt(m)!==oe||f.charCodeAt(++m)===oe;);return(_=m)>=v?$=!0:(w=f.charCodeAt(m++))===bt?A=!0:w===se&&(A=!0,f.charCodeAt(m)===bt&&++m),f.slice(b+1,_-1).replace(/""/g,'"')}for(;m<v;){if((w=f.charCodeAt(_=m++))===bt)A=!0;else if(w===se)A=!0,f.charCodeAt(m)===bt&&++m;else if(w!==n)continue;return f.slice(b,_)}return $=!0,f.slice(b,v)}for(;(N=z())!==ae;){for(var g=[];N!==Ze&&N!==ae;)g.push(N),N=z();h&&(g=h(g,x++))==null||d.push(g)}return d}function a(f,h){return f.map(function(d){return h.map(function(v){return c(d[v])}).join(t)})}function o(f,h){return h==null&&(h=Je(f)),[h.map(c).join(t)].concat(a(f,h)).join(`
`)}function s(f,h){return h==null&&(h=Je(f)),a(f,h).join(`
`)}function u(f){return f.map(l).join(`
`)}function l(f){return f.map(c).join(t)}function c(f){return f==null?"":f instanceof Date?Bo(f):e.test(f+="")?'"'+f.replace(/"/g,'""')+'"':f}return{parse:r,parseRows:i,format:o,formatBody:s,formatRows:u,formatRow:l,formatValue:c}}var Uo=Vo(","),Yo=Uo.parse;function Go(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.text()}function Wo(t,e){return fetch(t,e).then(Go)}function Zo(t){return function(e,n,r){return arguments.length===2&&typeof n=="function"&&(r=n,n=void 0),Wo(e,n).then(function(i){return t(i,r)})}}var Jo=Zo(Yo);function Ko(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function Jt(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function yt(t){return t=Jt(Math.abs(t)),t?t[1]:NaN}function Qo(t,e){return function(n,r){for(var i=n.length,a=[],o=0,s=t[0],u=0;i>0&&s>0&&(u+s+1>r&&(s=Math.max(1,r-u)),a.push(n.substring(i-=s,i+s)),!((u+=s+1)>r));)s=t[o=(o+1)%t.length];return a.reverse().join(e)}}function jo(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var ts=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Kt(t){if(!(e=ts.exec(t)))throw new Error("invalid format: "+t);var e;return new Ee({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}Kt.prototype=Ee.prototype;function Ee(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}Ee.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function es(t){t:for(var e=t.length,n=1,r=-1,i;n<e;++n)switch(t[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+t[n])break t;r>0&&(r=0);break}return r>0?t.slice(0,r)+t.slice(i+1):t}var Ln;function ns(t,e){var n=Jt(t,e);if(!n)return t+"";var r=n[0],i=n[1],a=i-(Ln=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,o=r.length;return a===o?r:a>o?r+new Array(a-o+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+Jt(t,Math.max(0,e+a-1))[0]}function Ke(t,e){var n=Jt(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const Qe={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:Ko,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>Ke(t*100,e),r:Ke,s:ns,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function je(t){return t}var tn=Array.prototype.map,en=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function rs(t){var e=t.grouping===void 0||t.thousands===void 0?je:Qo(tn.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",r=t.currency===void 0?"":t.currency[1]+"",i=t.decimal===void 0?".":t.decimal+"",a=t.numerals===void 0?je:jo(tn.call(t.numerals,String)),o=t.percent===void 0?"%":t.percent+"",s=t.minus===void 0?"−":t.minus+"",u=t.nan===void 0?"NaN":t.nan+"";function l(f){f=Kt(f);var h=f.fill,d=f.align,v=f.sign,m=f.symbol,x=f.zero,N=f.width,$=f.comma,A=f.precision,z=f.trim,g=f.type;g==="n"?($=!0,g="g"):Qe[g]||(A===void 0&&(A=12),z=!0,g="g"),(x||h==="0"&&d==="=")&&(x=!0,h="0",d="=");var _=m==="$"?n:m==="#"&&/[boxX]/.test(g)?"0"+g.toLowerCase():"",b=m==="$"?r:/[%p]/.test(g)?o:"",w=Qe[g],E=/[defgprs%]/.test(g);A=A===void 0?6:/[gprs]/.test(g)?Math.max(1,Math.min(21,A)):Math.max(0,Math.min(20,A));function q(y){var D=_,I=b,J,_t,K;if(g==="c")I=w(y)+I,y="";else{y=+y;var it=y<0||1/y<0;if(y=isNaN(y)?u:w(Math.abs(y),A),z&&(y=es(y)),it&&+y==0&&v!=="+"&&(it=!1),D=(it?v==="("?v:s:v==="-"||v==="("?"":v)+D,I=(g==="s"?en[8+Ln/3]:"")+I+(it&&v==="("?")":""),E){for(J=-1,_t=y.length;++J<_t;)if(K=y.charCodeAt(J),48>K||K>57){I=(K===46?i+y.slice(J+1):y.slice(J))+I,y=y.slice(0,J);break}}}$&&!x&&(y=e(y,1/0));var nt=D.length+y.length+I.length,O=nt<N?new Array(N-nt+1).join(h):"";switch($&&x&&(y=e(O+y,O.length?N-I.length:1/0),O=""),d){case"<":y=D+y+I+O;break;case"=":y=D+O+y+I;break;case"^":y=O.slice(0,nt=O.length>>1)+D+y+I+O.slice(nt);break;default:y=O+D+y+I;break}return a(y)}return q.toString=function(){return f+""},q}function c(f,h){var d=l((f=Kt(f),f.type="f",f)),v=Math.max(-8,Math.min(8,Math.floor(yt(h)/3)))*3,m=Math.pow(10,-v),x=en[8+v/3];return function(N){return d(m*N)+x}}return{format:l,formatPrefix:c}}var Pt,Hn,qn;is({thousands:",",grouping:[3],currency:["$",""]});function is(t){return Pt=rs(t),Hn=Pt.format,qn=Pt.formatPrefix,Pt}function as(t){return Math.max(0,-yt(Math.abs(t)))}function os(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(yt(e)/3)))*3-yt(Math.abs(t)))}function ss(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,yt(e)-yt(t))+1}function ls(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function us(t){return function(){return t}}function cs(t){return+t}var nn=[0,1];function pt(t){return t}function we(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:us(isNaN(e)?NaN:.5)}function fs(t,e){var n;return t>e&&(n=t,t=e,e=n),function(r){return Math.max(t,Math.min(e,r))}}function hs(t,e,n){var r=t[0],i=t[1],a=e[0],o=e[1];return i<r?(r=we(i,r),a=n(o,a)):(r=we(r,i),a=n(a,o)),function(s){return a(r(s))}}function ds(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),a=new Array(r),o=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++o<r;)i[o]=we(t[o],t[o+1]),a[o]=n(e[o],e[o+1]);return function(s){var u=lr(t,s,1,r)-1;return a[u](i[u](s))}}function ps(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function vs(){var t=nn,e=nn,n=$e,r,i,a,o=pt,s,u,l;function c(){var h=Math.min(t.length,e.length);return o!==pt&&(o=fs(t[0],t[h-1])),s=h>2?ds:hs,u=l=null,f}function f(h){return h==null||isNaN(h=+h)?a:(u||(u=s(t.map(r),e,n)))(r(o(h)))}return f.invert=function(h){return o(i((l||(l=s(e,t.map(r),B)))(h)))},f.domain=function(h){return arguments.length?(t=Array.from(h,cs),c()):t.slice()},f.range=function(h){return arguments.length?(e=Array.from(h),c()):e.slice()},f.rangeRound=function(h){return e=Array.from(h),n=wa,c()},f.clamp=function(h){return arguments.length?(o=h?!0:pt,c()):o!==pt},f.interpolate=function(h){return arguments.length?(n=h,c()):n},f.unknown=function(h){return arguments.length?(a=h,f):a},function(h,d){return r=h,i=d,c()}}function gs(){return vs()(pt,pt)}function ms(t,e,n,r){var i=dr(t,e,n),a;switch(r=Kt(r??",f"),r.type){case"s":{var o=Math.max(Math.abs(t),Math.abs(e));return r.precision==null&&!isNaN(a=os(i,o))&&(r.precision=a),qn(r,o)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(a=ss(i,Math.max(Math.abs(t),Math.abs(e))))&&(r.precision=a-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(a=as(i))&&(r.precision=a-(r.type==="%")*2);break}}return Hn(r)}function ys(t){var e=t.domain;return t.ticks=function(n){var r=e();return hr(r[0],r[r.length-1],n??10)},t.tickFormat=function(n,r){var i=e();return ms(i[0],i[i.length-1],n??10,r)},t.nice=function(n){n==null&&(n=10);var r=e(),i=0,a=r.length-1,o=r[i],s=r[a],u,l,c=10;for(s<o&&(l=o,o=s,s=l,l=i,i=a,a=l);c-- >0;){if(l=ce(o,s,n),l===u)return r[i]=o,r[a]=s,e(r);if(l>0)o=Math.floor(o/l)*l,s=Math.ceil(s/l)*l;else if(l<0)o=Math.ceil(o*l)/l,s=Math.floor(s*l)/l;else break;u=l}return t},t}function xe(){var t=gs();return t.copy=function(){return ps(t,xe())},ls.apply(t,arguments),ys(t)}function ft(t){return function(){return t}}function _s(t){let e=3;return t.digits=function(n){if(!arguments.length)return e;if(n==null)e=null;else{const r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);e=r}return t},()=>new qo(e)}function ws(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function On(t){this._context=t}On.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function xs(t){return new On(t)}function bs(t){return t[0]}function ks(t){return t[1]}function As(t,e){var n=ft(!0),r=null,i=xs,a=null,o=_s(s);t=typeof t=="function"?t:t===void 0?bs:ft(t),e=typeof e=="function"?e:e===void 0?ks:ft(e);function s(u){var l,c=(u=ws(u)).length,f,h=!1,d;for(r==null&&(a=i(d=o())),l=0;l<=c;++l)!(l<c&&n(f=u[l],l,u))===h&&((h=!h)?a.lineStart():a.lineEnd()),h&&a.point(+t(f,l,u),+e(f,l,u));if(d)return a=null,d+""||null}return s.x=function(u){return arguments.length?(t=typeof u=="function"?u:ft(+u),s):t},s.y=function(u){return arguments.length?(e=typeof u=="function"?u:ft(+u),s):e},s.defined=function(u){return arguments.length?(n=typeof u=="function"?u:ft(!!u),s):n},s.curve=function(u){return arguments.length?(i=u,r!=null&&(a=i(r)),s):i},s.context=function(u){return arguments.length?(u==null?r=a=null:a=i(r=u),s):r},s}function $t(t,e,n){this.k=t,this.x=e,this.y=n}$t.prototype={constructor:$t,scale:function(t){return t===1?this:new $t(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new $t(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};$t.prototype;var Ms=et('<div class="legend-item svelte-4o8g80"><svg width="24" height="12" viewBox="0 0 24 12" class="svelte-4o8g80"><path d="M0,6 L24,6" stroke-width="3" fill="none"></path></svg> <span class="legend-text svelte-4o8g80"> </span></div>'),$s=Qt('<line stroke="#333" stroke-width="1"></line><text fill="#fff" text-anchor="end" dominant-baseline="middle" class="svelte-4o8g80"> </text>',1),Ts=Qt('<line stroke="#333" stroke-width="1"></line><text fill="#fff" text-anchor="middle" class="svelte-4o8g80"> </text>',1),Ns=Qt('<path fill="none" stroke-width="3"></path>'),Ss=Qt('<text fill="#fff" text-anchor="middle" transform="rotate(-90, 10, 200)" class="y-axis-title svelte-4o8g80"> </text>'),Es=et('<div class="chart-container svelte-4o8g80"><h2 class="svelte-4o8g80"> </h2> <div class="legend-container svelte-4o8g80"></div> <svg height="400"><rect height="400" fill="#000"></rect><!><!><!><!></svg></div>');function kt(t,e){rn(e,!1);let n=j(e,"path_to_data",8,""),r=j(e,"title",8,""),i=j(e,"yticks",24,()=>[]),a=j(e,"y_axis_title",8,""),o=G(750),s=G([]),u=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],l=["#8DBF2E","#00A189","#6FC7EA","#007FA3","#AB1368","#DC4633","#F1C500"];un(()=>{const g=()=>{const _=document.querySelector(".chart-container");_&&P(o,Math.min(p(o),_.parentElement.clientWidth))};return g(),window.addEventListener("resize",g),Jo(n()).then(_=>{P(s,_.map(b=>{const w={Hour:+b.Hour};return u.forEach(E=>w[E]=+b[E]),w}))}),()=>window.removeEventListener("resize",g)});let c=G();le(()=>(p(s),p(o),Vn(i())),()=>{if(p(s).length>0){const g=xe().domain([0,23]).range([50,p(o)-20]),_=xe().domain([vr(i()),pr(i())]).range([360,40]),b=As().x(y=>g(y.Hour)).y(y=>_(y.value)),w=u.map(y=>{const D=y==="Saturday"||y==="Sunday";return{day:y,path:b(p(s).map(I=>({Hour:I.Hour,value:I[y]}))),color:l[u.indexOf(y)],isDashed:D}}),E=Array.from({length:24},(y,D)=>D),q=[...i()];P(c,{x:g,y:_,lines:w,xTicks:E,yTicks:q})}}),an(),ln();var f=Es(),h=S(f),d=S(h,!0);M(h);var v=T(h,2);ht(v,5,()=>{var g;return(g=p(c))==null?void 0:g.lines},dt,(g,_)=>{var b=Ms(),w=S(b),E=S(w);M(w);var q=T(w,2),y=S(q,!0);M(q),M(b),F(()=>{k(E,"stroke",p(_).color),k(E,"stroke-dasharray",p(_).isDashed?"4,2":"0"),rt(y,p(_).day)}),X(g,b)}),M(v);var m=T(v,2),x=S(m),N=T(x);ht(N,1,()=>{var g;return(g=p(c))==null?void 0:g.yTicks},dt,(g,_)=>{var b=$s(),w=ue(b);k(w,"x1",50),F(()=>k(w,"y1",p(c).y(p(_)))),F(()=>k(w,"y2",p(c).y(p(_))));var E=T(w);k(E,"x",45),F(()=>k(E,"y",p(c).y(p(_))));var q=S(E,!0);M(E),F(()=>{k(w,"x2",p(o)-20),rt(q,p(_))}),X(g,b)});var $=T(N);ht($,1,()=>{var g;return(g=p(c))==null?void 0:g.xTicks},dt,(g,_)=>{var b=Ts(),w=ue(b);F(()=>k(w,"x1",p(c).x(p(_)))),k(w,"y1",360),F(()=>k(w,"x2",p(c).x(p(_)))),k(w,"y2",40);var E=T(w);F(()=>k(E,"x",p(c).x(p(_)))),k(E,"y",375);var q=S(E,!0);M(E),F(()=>rt(q,p(_))),X(g,b)});var A=T($);ht(A,1,()=>{var g;return(g=p(c))==null?void 0:g.lines},dt,(g,_)=>{var b=Ns();F(()=>{k(b,"d",p(_).path),k(b,"stroke",p(_).color),k(b,"stroke-dasharray",p(_).isDashed?"4,2":"0")}),X(g,b)});var z=T(A);sn(z,a,g=>{var _=Ss();k(_,"x",15),k(_,"y",205);var b=S(_,!0);M(_),F(()=>rt(b,a())),X(g,_)}),M(m),M(f),F(()=>{k(f,"style",`width: ${p(o)??""}px; height: 450px;`),rt(d,r()),k(m,"width",p(o)),k(m,"viewBox",`0 0 ${p(o)} 400`),k(x,"width",p(o))}),X(t,f),on()}const Cs=""+new URL("../assets/top-image.JUTWmls1.png",import.meta.url).href;var Is=et(`<!> <main class="svelte-uz1plv"><div class="title svelte-uz1plv"><img alt="" class="svelte-uz1plv"> <h1 class="svelte-uz1plv">Exploring hourly activity patterns in Toronto</h1> <p id="authors" class="svelte-uz1plv"><a href="https://camhkerr.com/" class="svelte-uz1plv">Cameron Kerr</a> <a href="https://www.urbandisplacement.org/team/julia-greenberg/" class="svelte-uz1plv">Julia Greenberg</a> <a href="https://jamaps.github.io/" class="svelte-uz1plv">Jeff Allen</a></p></div> <div class="text svelte-uz1plv"><p class="svelte-uz1plv">A city is a constantly changing complex system. Even hourly, as millions of people move from home to work, to events, and through their daily routines the city develops it's own pulse. We set out to visualize the pulse of the city and identify any patterns that emerge.</p> <p class="svelte-uz1plv">The Greater Toronto Area (GTA) provides a model area to investigate as it contains almost 7 million people and a diverse set of rural, mid-size-and mega- cities.</p> <p class="svelte-uz1plv">The bounding box around the GTA was subdivided into a rectangular grid containing over 16,000 grid cells each about 1km wide. To investigate hourly activity across the GTA the accumulated time in each of these grid cells was calculated. Hourly activity was measured by the accumulated time in each grid cell (i.e if 2 people spend half of the hour in a given cell, the region has an accumulated time of 1 in that hour). The time each person spends in each cell was calculated using a sample of mobile location data provided by Spectus. In the map below the total accumulated time is shown for the average weekday and weekend over the summer of 2024 in the GTA.</p></div> <!> <div class="text svelte-uz1plv"><p class="svelte-uz1plv">The map demonstrates that the patterns of total hourly activity are relatively constant throughout the average weekend and weekday. There are no large structural changes in the distribution of activity throughout the city. Hourly activity is concentrated around Toronto and it's surrounding large municipalities with more distant pockets having lower activity.</p> <p class="svelte-uz1plv">Smaller patterns which can be picked up include the increase in activity at the Toronto Pearson Airport during the day and the empty space it leaves at night. The only large scale change is the general drop in activity during the night, especially seen between 3am and 5 am. The plot below shows the number of active phones in the sample during each hour throughout the week. The observed drop could be due to the nature of the mobile location data, as cell phones send out less location pings during the night. Another factor could be people commuting from outside of the GTA and leaving during the night.</p></div> <!> <div class="text svelte-uz1plv"><p class="svelte-uz1plv">In the map above, the underlying population density distribution obscures the hourly changes which occur. To better visualize these changes we subtracted each cell's hourly activity by it's average hourly activity throughout the summer of 2024. This new metric measures how much more or less activity occurs in a given cell compared to it's typical activity.</p></div> <!> <div class="text svelte-uz1plv"><p class="svelte-uz1plv">This map demonstrates both large and small scale flucuations throughout the day. Similar to the previous map, most cells have a lower than average activity during the night and higher than average activity during the day. In addition, we can see movement from residential areas and into employment areas during the day. For example, the south-eastern part of Brampton is an employment area with the surrounding northern and western part containing residential areas. During the evening, these residential areas have a higher than average activity and during 9-5 on weekdays the employment areas are at higher activity. Similarly, Vaughan's primary employment area is located in the South and is surrounded by residential areas. Activity is concentrated in the employment areas during 9-5 on weekdays and spreads out to the surrounding areas in the evening. Due to it's high density it is difficult to discern similar patterns for Toronto, but a signfiicant increase in activity can be seen in the downtown core during working hours. Additionally, between 3 pm and 6 pm lines of increased activity can be seen on highway 400 and highway 401, representing the commute out of commercial areas.</p> <p class="svelte-uz1plv">In contrast to the commercial shift on weekdays, the progression through a weekend is less predicatable. In the evening the distribution is similar to that seen on weekdays, with most high activity occuring in residential areas. However, activity during the day is scattered throughout commercial and residential areas. The activity also starts much later in the day, with low activity in central areas as late as 11 am.</p> <h2 class="svelte-uz1plv">Diversity and clustering</h2> <p class="svelte-uz1plv">Diversity and clustering statistics were used to quantify the daily patterns observed in the maps above. To measure the diversity of hourly activity across the GTA, we applied Shannon's Diversity Index. This index captures both the number of cells with activity (richness) and how evenly that activity is distributed among them (evenness). A high Shannon index means that many cells have activity and that activity levels are relatively balanced across them. In contrast, a low Shannon index suggests that fewer cells are active and that activity is concentrated in specific cells. Note that this index is spatially unaware, if all the cells were shuffled into different positions on the map, the Shannon index value would remain the same.</p></div> <!> <div class="text svelte-uz1plv"><p class="svelte-uz1plv">In the plot above a clear 'pulse' in diversity forms throughout the day. Activity becomes more diverse during daytime hours, with an additional spike between 3 pm and 5 pm. The diversity subsequently drops off in the evening and overnight. Although the differences in the actual index values are relatively small, an Aligned Rank Transform (ART) ANOVA test confirmed that the variation in diversity between day and night is statistically significant. One possible explanation is that during the day people are more mobile and are accumulating less activity in specific cells, especially during commuting hours (when diversity peaks). Additionally, this diversity pulse appears later in the day on Saturdays and Sundays, likely due to delayed daily routines on weekends.</p> <p class="svelte-uz1plv">As mentioned above, Shannon's index reflects both richness and evenness. To better understand each components contribution to diversity, we can examine them seperately. In our case, richness represents the number of cells in the GTA which are visited within a given hour. Evenness represents the degree to which activity is uniformly distributed.</p></div> <!> <!> <div class="text svelte-uz1plv"><p class="svelte-uz1plv">The plot of richness (expressed here as the fraction of active cells) reveals a simlair daily 'pulse' to that seen in Shannon's diversity. During the day, more people are moving which generates activity in a large number of cells. At night, activity becomes concentrated in residential areas leaving roughly half of the cells inactive. Additionally, the drop in the number of phones (as seen in the first plot) contributes to a lower number of active cells.</p> <p class="svelte-uz1plv">Evenness follows a different pattern; it tends to spike at night and gradually decreases during the day, with a smaller increase on weekdays between 3pm and 5 pm. The nightime spike likely results from low activity levels where urban and rural cells experience minimal activity. The increase between 3 and 5 pm may reflect commuting, as people spread out more evenly across the GTA. Note that despite the distinct pattern seen, the numerical change in evenness is small.</p> <p class="svelte-uz1plv">To investigate clustering, we calculated Moran's I for each hour throughout the week. In our case, Moran's I measures whether cells with similar activity levels tend to be located near each other. A high Moran's I value indicates that cells with similar activity are spatially close, suggesting strong spatial autocorrelation. A value near zero suggests that activity levels are randomly distributed across space. A negative value indicates that high-activity cells are typically surrounded by low-activity cells and vice versa. Moran's I ranges from -1 (negative spatial autocorrelation) to +1 (positive spatial autocorrelation).</p></div> <!> <div class="text svelte-uz1plv"><p class="svelte-uz1plv">Clustering patterns also exhibit a noticeable 'pulse' throughout the day. Between 10am and 5pm high levels of activity become more spatially concentrated. In the evening and overnight hours, this clustering diminishes and activity becomes more spatially dispersed. This pattern likely reflects the daily movement of people into concentrated employment or commercial areas during working hours, as reported in the maps above. Additionally, clustering is generally lower on weekends, particularly on Sundays. This supports our earlier observation in the maps that weekend activity lacks the structured, location-specific patterns which are observed during weekdays.</p></div></main>`,1);function qs(t){var e=Is(),n=ue(e);Qn(n);var r=T(n,2),i=S(r),a=S(i);k(a,"src",Cs),Ie(4),M(i);var o=T(i,4);Re(o,{title:"Mean hourly activity in Toronto",folder_weekday:"exploring-hourly-activity-toronto/Weekday_Total_small",folder_weekend:"exploring-hourly-activity-toronto/Weekend_Total_small",legendColors:["#331d33","#c53e2e","#eddd53"],legendLabels:["Few active mobile phones","Many active mobile phones"]});var s=T(o,4);kt(s,{path_to_data:"exploring-hourly-activity-toronto/data/pings_normalized.csv",title:"Hourly activity in Toronto by day of the week",yticks:[.5,.75,1,1.25,1.5],y_axis_title:"Mean normalized hourly activity"});var u=T(s,4);Re(u,{title:"Mean-subtracted hourly activity in Toronto",folder_weekday:"exploring-hourly-activity-toronto/Weekday_Difference_small",folder_weekend:"exploring-hourly-activity-toronto/Weekend_Difference_small",legendColors:["#d0f9ff","#4ca4c3","#331d33","#c53e2e","#eddd53"],legendLabels:["Relatively low activity","Mean activity","Relatively high activity"]});var l=T(u,4);kt(l,{path_to_data:"exploring-hourly-activity-toronto/data/shannon.csv",title:"Shannon diversity index of hourly activity in Toronto",yticks:[7.9,8,8.1,8.2],y_axis_title:""});var c=T(l,4);kt(c,{path_to_data:"exploring-hourly-activity-toronto/data/richness.csv",title:"Fraction of cells with activity throughout the day",yticks:[.4,.5,.6,.7],y_axis_title:"Richness"});var f=T(c,2);kt(f,{path_to_data:"exploring-hourly-activity-toronto/data/evenness.csv",title:"Evenness of activity throughout the day",yticks:[.86,.87,.88,.89,.9],y_axis_title:"Evenness"});var h=T(f,4);kt(h,{path_to_data:"exploring-hourly-activity-toronto/data/moran.csv",title:"Spatial clustering of hourly activity in Toronto",yticks:[.34,.38,.42,.46],y_axis_title:"Moran's I of hourly activity in Toronto"}),Ie(2),M(r),X(t,e)}export{qs as component};
