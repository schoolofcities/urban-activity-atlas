import{a as O,t as tt,n as Gt}from"../chunks/disclose-version.B_6IR0ZE.js";import{s as I,v as $,p as Ke,aC as re,aD as Qe,t as P,q as je,g as p,$ as H,w as T,aE as G,o as ie,e as Dn,aF as $e}from"../chunks/runtime.GVz-zu-4.js";import{s as A,l as Pn,e as yt,b as Hn,h as Ln,r as qn,i as _t,t as Kt}from"../chunks/top-logo-full.No6y6fF7.js";import{e as Nt,s as rt}from"../chunks/render.DcWhrcIw.js";import{p as it,i as tn}from"../chunks/props.BBmB40Jv.js";import{i as en}from"../chunks/lifecycle.DqJ8SXdi.js";import{o as nn,a as On}from"../chunks/index-client.CHCEbK_U.js";var Xn=tt('<div id="bar" class="svelte-os6al8"><div id="logo" class="svelte-os6al8"><a href="https://www.schoolofcities.utoronto.ca/" class="svelte-os6al8"><img alt="School of Cities" class="svelte-os6al8"></a></div></div>');function Bn(t){var e=Xn(),n=I(e),r=I(n),i=I(r);A(i,"src",Pn),$(r),$(n),$(e),O(t,e)}var Vn=tt('<button aria-label="Play" class="svelte-6xht1h"><svg width="12" height="12" viewBox="0 0 12 12" fill="white" xmlns="http://www.w3.org/2000/svg"><polygon points="2,1 10,6 2,11"></polygon></svg></button>'),Un=tt('<button aria-label="Stop" class="svelte-6xht1h"><svg width="12" height="12" viewBox="0 0 12 12" fill="white" xmlns="http://www.w3.org/2000/svg"><rect x="2" y="2" width="8" height="8"></rect></svg></button>'),Yn=tt('<span class="svelte-6xht1h"> </span>'),Gn=tt('<div class="container svelte-6xht1h"><h3 class="svelte-6xht1h"> </h3> <div class="controls svelte-6xht1h"><div class="range-play-wrapper svelte-6xht1h"><!> <div class="slider-wrapper svelte-6xht1h"><input type="range" min="0" max="23" step="1" class="custom-slider svelte-6xht1h"> <div class="ticks svelte-6xht1h"></div></div></div></div> <div class="mode-toggle svelte-6xht1h"><button class="svelte-6xht1h">Weekday</button> <button class="svelte-6xht1h">Weekend</button></div> <img loading="lazy" decoding="async" class="svelte-6xht1h"></div>');function Te(t,e){Ke(e,!1);const n=G(),r=G();let i=it(e,"title",8,""),a=it(e,"folder_weekday",8,""),o=it(e,"folder_weekend",8,""),s=G(),l=G(0),u=null,c=G(!1),h=G(!1),f=[],d=G("weekday");function v(S){S==="weekday"?H(s,a()):H(s,o()),H(d,S),y()}async function y(){H(h,!1),f=[],await w(p(n)[0]),setTimeout(async()=>{await Promise.all([w(p(n)[1]),w(p(n)[2]),w(p(n)[3])])},50),p(n).slice(4).forEach(S=>{requestIdleCallback(()=>w(S),{timeout:2e3})}),H(h,!0)}async function w(S){const C=new Image;C.src=S,C.decoding="async",await C.decode().catch(()=>{}),f.push(S)}nn(()=>{v("weekday")}),On(()=>{clearInterval(u)});function M(){!p(c)&&p(h)&&(H(c,!0),u=setInterval(()=>{H(l,(p(l)+1)%24)},250))}function E(){H(c,!1),clearInterval(u)}re(()=>p(s),()=>{H(n,Array.from({length:24},(S,C)=>`/urban-activity-atlas/${p(s)}/Hour_${C}.png`))}),re(()=>{},()=>{H(r,Array.from({length:24},(S,C)=>C))}),Qe(),en();var k=Gn(),R=I(k),g=I(R,!0);$(R);var _=T(R,2),b=I(_),x=I(b);tn(x,()=>!p(c),S=>{var C=Vn();P(()=>C.disabled=!p(h)),Nt("click",C,M),O(S,C)},S=>{var C=Un();Nt("click",C,E),O(S,C)});var N=T(x,2),F=I(N);qn(F);var m=T(F,2);yt(m,5,()=>p(r),_t,(S,C)=>{var j=Yn(),X=I(j,!0);$(j),P(()=>rt(X,p(C))),O(S,j)}),$(m),$(N),$(b),$(_);var D=T(_,2),z=I(D),J=T(z,2);$(D);var et=T(D,2);$(k),P(()=>{rt(g,i()),F.disabled=!p(h),Kt(z,"selected",p(d)==="weekday"),Kt(J,"selected",p(d)==="weekend"),A(et,"src",p(h)?p(n)[p(l)]:"./urban-activity-atlas/exploring-daily-activity-toronto/blank-image.png"),A(et,"alt",`Hour ${p(l)}`),Kt(et,"loading",!p(h))}),Hn(F,()=>p(l),S=>H(l,S)),Nt("click",z,()=>v("weekday")),Nt("click",J,()=>v("weekend")),Ln(et),O(t,k),je()}function zt(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Wn(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function rn(t){let e,n,r;t.length!==2?(e=zt,n=(s,l)=>zt(t(s),l),r=(s,l)=>t(s)-l):(e=t===zt||t===Wn?t:Zn,n=t,r=t);function i(s,l,u=0,c=s.length){if(u<c){if(e(l,l)!==0)return c;do{const h=u+c>>>1;n(s[h],l)<0?u=h+1:c=h}while(u<c)}return u}function a(s,l,u=0,c=s.length){if(u<c){if(e(l,l)!==0)return c;do{const h=u+c>>>1;n(s[h],l)<=0?u=h+1:c=h}while(u<c)}return u}function o(s,l,u=0,c=s.length){const h=i(s,l,u,c-1);return h>u&&r(s[h-1],l)>-r(s[h],l)?h-1:h}return{left:i,center:o,right:a}}function Zn(){return 0}function Jn(t){return t===null?NaN:+t}const Kn=rn(zt),Qn=Kn.right;rn(Jn).center;const jn=Math.sqrt(50),tr=Math.sqrt(10),er=Math.sqrt(2);function Pt(t,e,n){const r=(e-t)/Math.max(0,n),i=Math.floor(Math.log10(r)),a=r/Math.pow(10,i),o=a>=jn?10:a>=tr?5:a>=er?2:1;let s,l,u;return i<0?(u=Math.pow(10,-i)/o,s=Math.round(t*u),l=Math.round(e*u),s/u<t&&++s,l/u>e&&--l,u=-u):(u=Math.pow(10,i)*o,s=Math.round(t/u),l=Math.round(e/u),s*u<t&&++s,l*u>e&&--l),l<s&&.5<=n&&n<2?Pt(t,e,n*2):[s,l,u]}function nr(t,e,n){if(e=+e,t=+t,n=+n,!(n>0))return[];if(t===e)return[t];const r=e<t,[i,a,o]=r?Pt(e,t,n):Pt(t,e,n);if(!(a>=i))return[];const s=a-i+1,l=new Array(s);if(r)if(o<0)for(let u=0;u<s;++u)l[u]=(a-u)/-o;else for(let u=0;u<s;++u)l[u]=(a-u)*o;else if(o<0)for(let u=0;u<s;++u)l[u]=(i+u)/-o;else for(let u=0;u<s;++u)l[u]=(i+u)*o;return l}function ae(t,e,n){return e=+e,t=+t,n=+n,Pt(t,e,n)[2]}function rr(t,e,n){e=+e,t=+t,n=+n;const r=e<t,i=r?ae(e,t,n):ae(t,e,n);return(r?-1:1)*(i<0?1/-i:i)}function ir(t,e){let n;for(const r of t)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);return n}function ar(t,e){let n;for(const r of t)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);return n}var or={value:()=>{}};function an(){for(var t=0,e=arguments.length,n={},r;t<e;++t){if(!(r=arguments[t]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new Rt(n)}function Rt(t){this._=t}function sr(t,e){return t.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}Rt.prototype=an.prototype={constructor:Rt,on:function(t,e){var n=this._,r=sr(t+"",n),i,a=-1,o=r.length;if(arguments.length<2){for(;++a<o;)if((i=(t=r[a]).type)&&(i=lr(n[i],t.name)))return i;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++a<o;)if(i=(t=r[a]).type)n[i]=Ne(n[i],t.name,e);else if(e==null)for(i in n)n[i]=Ne(n[i],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new Rt(t)},call:function(t,e){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,a;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(a=this._[t],r=0,i=a.length;r<i;++r)a[r].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,a=r.length;i<a;++i)r[i].value.apply(e,n)}};function lr(t,e){for(var n=0,r=t.length,i;n<r;++n)if((i=t[n]).name===e)return i.value}function Ne(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=or,t=t.slice(0,r).concat(t.slice(r+1));break}return n!=null&&t.push({name:e,value:n}),t}var oe="http://www.w3.org/1999/xhtml";const Se={svg:"http://www.w3.org/2000/svg",xhtml:oe,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Wt(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),Se.hasOwnProperty(e)?{space:Se[e],local:t}:t}function ur(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===oe&&e.documentElement.namespaceURI===oe?e.createElement(t):e.createElementNS(n,t)}}function cr(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function on(t){var e=Wt(t);return(e.local?cr:ur)(e)}function hr(){}function me(t){return t==null?hr:function(){return this.querySelector(t)}}function fr(t){typeof t!="function"&&(t=me(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a=e[i],o=a.length,s=r[i]=new Array(o),l,u,c=0;c<o;++c)(l=a[c])&&(u=t.call(l,l.__data__,c,a))&&("__data__"in l&&(u.__data__=l.__data__),s[c]=u);return new U(r,this._parents)}function dr(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function pr(){return[]}function sn(t){return t==null?pr:function(){return this.querySelectorAll(t)}}function vr(t){return function(){return dr(t.apply(this,arguments))}}function gr(t){typeof t=="function"?t=vr(t):t=sn(t);for(var e=this._groups,n=e.length,r=[],i=[],a=0;a<n;++a)for(var o=e[a],s=o.length,l,u=0;u<s;++u)(l=o[u])&&(r.push(t.call(l,l.__data__,u,o)),i.push(l));return new U(r,i)}function ln(t){return function(){return this.matches(t)}}function un(t){return function(e){return e.matches(t)}}var mr=Array.prototype.find;function yr(t){return function(){return mr.call(this.children,t)}}function _r(){return this.firstElementChild}function wr(t){return this.select(t==null?_r:yr(typeof t=="function"?t:un(t)))}var xr=Array.prototype.filter;function br(){return Array.from(this.children)}function kr(t){return function(){return xr.call(this.children,t)}}function Ar(t){return this.selectAll(t==null?br:kr(typeof t=="function"?t:un(t)))}function Mr(t){typeof t!="function"&&(t=ln(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a=e[i],o=a.length,s=r[i]=[],l,u=0;u<o;++u)(l=a[u])&&t.call(l,l.__data__,u,a)&&s.push(l);return new U(r,this._parents)}function cn(t){return new Array(t.length)}function $r(){return new U(this._enter||this._groups.map(cn),this._parents)}function Ht(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}Ht.prototype={constructor:Ht,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function Tr(t){return function(){return t}}function Nr(t,e,n,r,i,a){for(var o=0,s,l=e.length,u=a.length;o<u;++o)(s=e[o])?(s.__data__=a[o],r[o]=s):n[o]=new Ht(t,a[o]);for(;o<l;++o)(s=e[o])&&(i[o]=s)}function Sr(t,e,n,r,i,a,o){var s,l,u=new Map,c=e.length,h=a.length,f=new Array(c),d;for(s=0;s<c;++s)(l=e[s])&&(f[s]=d=o.call(l,l.__data__,s,e)+"",u.has(d)?i[s]=l:u.set(d,l));for(s=0;s<h;++s)d=o.call(t,a[s],s,a)+"",(l=u.get(d))?(r[s]=l,l.__data__=a[s],u.delete(d)):n[s]=new Ht(t,a[s]);for(s=0;s<c;++s)(l=e[s])&&u.get(f[s])===l&&(i[s]=l)}function Er(t){return t.__data__}function Cr(t,e){if(!arguments.length)return Array.from(this,Er);var n=e?Sr:Nr,r=this._parents,i=this._groups;typeof t!="function"&&(t=Tr(t));for(var a=i.length,o=new Array(a),s=new Array(a),l=new Array(a),u=0;u<a;++u){var c=r[u],h=i[u],f=h.length,d=Ir(t.call(c,c&&c.__data__,u,r)),v=d.length,y=s[u]=new Array(v),w=o[u]=new Array(v),M=l[u]=new Array(f);n(c,h,y,w,M,d,e);for(var E=0,k=0,R,g;E<v;++E)if(R=y[E]){for(E>=k&&(k=E+1);!(g=w[k])&&++k<v;);R._next=g||null}}return o=new U(o,r),o._enter=s,o._exit=l,o}function Ir(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function zr(){return new U(this._exit||this._groups.map(cn),this._parents)}function Rr(t,e,n){var r=this.enter(),i=this,a=this.exit();return typeof t=="function"?(r=t(r),r&&(r=r.selection())):r=r.append(t+""),e!=null&&(i=e(i),i&&(i=i.selection())),n==null?a.remove():n(a),r&&i?r.merge(i).order():i}function Fr(t){for(var e=t.selection?t.selection():t,n=this._groups,r=e._groups,i=n.length,a=r.length,o=Math.min(i,a),s=new Array(i),l=0;l<o;++l)for(var u=n[l],c=r[l],h=u.length,f=s[l]=new Array(h),d,v=0;v<h;++v)(d=u[v]||c[v])&&(f[v]=d);for(;l<i;++l)s[l]=n[l];return new U(s,this._parents)}function Dr(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r=t[e],i=r.length-1,a=r[i],o;--i>=0;)(o=r[i])&&(a&&o.compareDocumentPosition(a)^4&&a.parentNode.insertBefore(o,a),a=o);return this}function Pr(t){t||(t=Hr);function e(h,f){return h&&f?t(h.__data__,f.__data__):!h-!f}for(var n=this._groups,r=n.length,i=new Array(r),a=0;a<r;++a){for(var o=n[a],s=o.length,l=i[a]=new Array(s),u,c=0;c<s;++c)(u=o[c])&&(l[c]=u);l.sort(e)}return new U(i,this._parents).order()}function Hr(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function Lr(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function qr(){return Array.from(this)}function Or(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,a=r.length;i<a;++i){var o=r[i];if(o)return o}return null}function Xr(){let t=0;for(const e of this)++t;return t}function Br(){return!this.node()}function Vr(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i=e[n],a=0,o=i.length,s;a<o;++a)(s=i[a])&&t.call(s,s.__data__,a,i);return this}function Ur(t){return function(){this.removeAttribute(t)}}function Yr(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Gr(t,e){return function(){this.setAttribute(t,e)}}function Wr(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function Zr(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function Jr(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function Kr(t,e){var n=Wt(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((e==null?n.local?Yr:Ur:typeof e=="function"?n.local?Jr:Zr:n.local?Wr:Gr)(n,e))}function hn(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function Qr(t){return function(){this.style.removeProperty(t)}}function jr(t,e,n){return function(){this.style.setProperty(t,e,n)}}function ti(t,e,n){return function(){var r=e.apply(this,arguments);r==null?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function ei(t,e,n){return arguments.length>1?this.each((e==null?Qr:typeof e=="function"?ti:jr)(t,e,n??"")):ft(this.node(),t)}function ft(t,e){return t.style.getPropertyValue(e)||hn(t).getComputedStyle(t,null).getPropertyValue(e)}function ni(t){return function(){delete this[t]}}function ri(t,e){return function(){this[t]=e}}function ii(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function ai(t,e){return arguments.length>1?this.each((e==null?ni:typeof e=="function"?ii:ri)(t,e)):this.node()[t]}function fn(t){return t.trim().split(/^|\s+/)}function ye(t){return t.classList||new dn(t)}function dn(t){this._node=t,this._names=fn(t.getAttribute("class")||"")}dn.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function pn(t,e){for(var n=ye(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function vn(t,e){for(var n=ye(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function oi(t){return function(){pn(this,t)}}function si(t){return function(){vn(this,t)}}function li(t,e){return function(){(e.apply(this,arguments)?pn:vn)(this,t)}}function ui(t,e){var n=fn(t+"");if(arguments.length<2){for(var r=ye(this.node()),i=-1,a=n.length;++i<a;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof e=="function"?li:e?oi:si)(n,e))}function ci(){this.textContent=""}function hi(t){return function(){this.textContent=t}}function fi(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function di(t){return arguments.length?this.each(t==null?ci:(typeof t=="function"?fi:hi)(t)):this.node().textContent}function pi(){this.innerHTML=""}function vi(t){return function(){this.innerHTML=t}}function gi(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function mi(t){return arguments.length?this.each(t==null?pi:(typeof t=="function"?gi:vi)(t)):this.node().innerHTML}function yi(){this.nextSibling&&this.parentNode.appendChild(this)}function _i(){return this.each(yi)}function wi(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function xi(){return this.each(wi)}function bi(t){var e=typeof t=="function"?t:on(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function ki(){return null}function Ai(t,e){var n=typeof t=="function"?t:on(t),r=e==null?ki:typeof e=="function"?e:me(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function Mi(){var t=this.parentNode;t&&t.removeChild(this)}function $i(){return this.each(Mi)}function Ti(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Ni(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Si(t){return this.select(t?Ni:Ti)}function Ei(t){return arguments.length?this.property("__data__",t):this.node().__data__}function Ci(t){return function(e){t.call(this,e,this.__data__)}}function Ii(t){return t.trim().split(/^|\s+/).map(function(e){var n="",r=e.indexOf(".");return r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),{type:e,name:n}})}function zi(t){return function(){var e=this.__on;if(e){for(var n=0,r=-1,i=e.length,a;n<i;++n)a=e[n],(!t.type||a.type===t.type)&&a.name===t.name?this.removeEventListener(a.type,a.listener,a.options):e[++r]=a;++r?e.length=r:delete this.__on}}}function Ri(t,e,n){return function(){var r=this.__on,i,a=Ci(e);if(r){for(var o=0,s=r.length;o<s;++o)if((i=r[o]).type===t.type&&i.name===t.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=a,i.options=n),i.value=e;return}}this.addEventListener(t.type,a,n),i={type:t.type,name:t.name,value:e,listener:a,options:n},r?r.push(i):this.__on=[i]}}function Fi(t,e,n){var r=Ii(t+""),i,a=r.length,o;if(arguments.length<2){var s=this.node().__on;if(s){for(var l=0,u=s.length,c;l<u;++l)for(i=0,c=s[l];i<a;++i)if((o=r[i]).type===c.type&&o.name===c.name)return c.value}return}for(s=e?Ri:zi,i=0;i<a;++i)this.each(s(r[i],e,n));return this}function gn(t,e,n){var r=hn(t),i=r.CustomEvent;typeof i=="function"?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function Di(t,e){return function(){return gn(this,t,e)}}function Pi(t,e){return function(){return gn(this,t,e.apply(this,arguments))}}function Hi(t,e){return this.each((typeof e=="function"?Pi:Di)(t,e))}function*Li(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,a=r.length,o;i<a;++i)(o=r[i])&&(yield o)}var qi=[null];function U(t,e){this._groups=t,this._parents=e}function $t(){return new U([[document.documentElement]],qi)}function Oi(){return this}U.prototype=$t.prototype={constructor:U,select:fr,selectAll:gr,selectChild:wr,selectChildren:Ar,filter:Mr,data:Cr,enter:$r,exit:zr,join:Rr,merge:Fr,selection:Oi,order:Dr,sort:Pr,call:Lr,nodes:qr,node:Or,size:Xr,empty:Br,each:Vr,attr:Kr,style:ei,property:ai,classed:ui,text:di,html:mi,raise:_i,lower:xi,append:bi,insert:Ai,remove:$i,clone:Si,datum:Ei,on:Fi,dispatch:Hi,[Symbol.iterator]:Li};function _e(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function mn(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Tt(){}var kt=.7,Lt=1/kt,ht="\\s*([+-]?\\d+)\\s*",At="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",W="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Xi=/^#([0-9a-f]{3,8})$/,Bi=new RegExp(`^rgb\\(${ht},${ht},${ht}\\)$`),Vi=new RegExp(`^rgb\\(${W},${W},${W}\\)$`),Ui=new RegExp(`^rgba\\(${ht},${ht},${ht},${At}\\)$`),Yi=new RegExp(`^rgba\\(${W},${W},${W},${At}\\)$`),Gi=new RegExp(`^hsl\\(${At},${W},${W}\\)$`),Wi=new RegExp(`^hsla\\(${At},${W},${W},${At}\\)$`),Ee={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};_e(Tt,st,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Ce,formatHex:Ce,formatHex8:Zi,formatHsl:Ji,formatRgb:Ie,toString:Ie});function Ce(){return this.rgb().formatHex()}function Zi(){return this.rgb().formatHex8()}function Ji(){return yn(this).formatHsl()}function Ie(){return this.rgb().formatRgb()}function st(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=Xi.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?ze(e):n===3?new q(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?St(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?St(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=Bi.exec(t))?new q(e[1],e[2],e[3],1):(e=Vi.exec(t))?new q(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=Ui.exec(t))?St(e[1],e[2],e[3],e[4]):(e=Yi.exec(t))?St(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=Gi.exec(t))?De(e[1],e[2]/100,e[3]/100,1):(e=Wi.exec(t))?De(e[1],e[2]/100,e[3]/100,e[4]):Ee.hasOwnProperty(t)?ze(Ee[t]):t==="transparent"?new q(NaN,NaN,NaN,0):null}function ze(t){return new q(t>>16&255,t>>8&255,t&255,1)}function St(t,e,n,r){return r<=0&&(t=e=n=NaN),new q(t,e,n,r)}function Ki(t){return t instanceof Tt||(t=st(t)),t?(t=t.rgb(),new q(t.r,t.g,t.b,t.opacity)):new q}function se(t,e,n,r){return arguments.length===1?Ki(t):new q(t,e,n,r??1)}function q(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}_e(q,se,mn(Tt,{brighter(t){return t=t==null?Lt:Math.pow(Lt,t),new q(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?kt:Math.pow(kt,t),new q(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new q(ot(this.r),ot(this.g),ot(this.b),qt(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Re,formatHex:Re,formatHex8:Qi,formatRgb:Fe,toString:Fe}));function Re(){return`#${at(this.r)}${at(this.g)}${at(this.b)}`}function Qi(){return`#${at(this.r)}${at(this.g)}${at(this.b)}${at((isNaN(this.opacity)?1:this.opacity)*255)}`}function Fe(){const t=qt(this.opacity);return`${t===1?"rgb(":"rgba("}${ot(this.r)}, ${ot(this.g)}, ${ot(this.b)}${t===1?")":`, ${t})`}`}function qt(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function ot(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function at(t){return t=ot(t),(t<16?"0":"")+t.toString(16)}function De(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new V(t,e,n,r)}function yn(t){if(t instanceof V)return new V(t.h,t.s,t.l,t.opacity);if(t instanceof Tt||(t=st(t)),!t)return new V;if(t instanceof V)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),a=Math.max(e,n,r),o=NaN,s=a-i,l=(a+i)/2;return s?(e===a?o=(n-r)/s+(n<r)*6:n===a?o=(r-e)/s+2:o=(e-n)/s+4,s/=l<.5?a+i:2-a-i,o*=60):s=l>0&&l<1?0:o,new V(o,s,l,t.opacity)}function ji(t,e,n,r){return arguments.length===1?yn(t):new V(t,e,n,r??1)}function V(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}_e(V,ji,mn(Tt,{brighter(t){return t=t==null?Lt:Math.pow(Lt,t),new V(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?kt:Math.pow(kt,t),new V(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new q(Qt(t>=240?t-240:t+120,i,r),Qt(t,i,r),Qt(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new V(Pe(this.h),Et(this.s),Et(this.l),qt(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=qt(this.opacity);return`${t===1?"hsl(":"hsla("}${Pe(this.h)}, ${Et(this.s)*100}%, ${Et(this.l)*100}%${t===1?")":`, ${t})`}`}}));function Pe(t){return t=(t||0)%360,t<0?t+360:t}function Et(t){return Math.max(0,Math.min(1,t||0))}function Qt(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}const we=t=>()=>t;function ta(t,e){return function(n){return t+n*e}}function ea(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function na(t){return(t=+t)==1?_n:function(e,n){return n-e?ea(e,n,t):we(isNaN(e)?n:e)}}function _n(t,e){var n=e-t;return n?ta(t,n):we(isNaN(t)?e:t)}const Ot=function t(e){var n=na(e);function r(i,a){var o=n((i=se(i)).r,(a=se(a)).r),s=n(i.g,a.g),l=n(i.b,a.b),u=_n(i.opacity,a.opacity);return function(c){return i.r=o(c),i.g=s(c),i.b=l(c),i.opacity=u(c),i+""}}return r.gamma=t,r}(1);function ra(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,r=e.slice(),i;return function(a){for(i=0;i<n;++i)r[i]=t[i]*(1-a)+e[i]*a;return r}}function ia(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function aa(t,e){var n=e?e.length:0,r=t?Math.min(n,t.length):0,i=new Array(r),a=new Array(n),o;for(o=0;o<r;++o)i[o]=xe(t[o],e[o]);for(;o<n;++o)a[o]=e[o];return function(s){for(o=0;o<r;++o)a[o]=i[o](s);return a}}function oa(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function B(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function sa(t,e){var n={},r={},i;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(i in e)i in t?n[i]=xe(t[i],e[i]):r[i]=e[i];return function(a){for(i in n)r[i]=n[i](a);return r}}var le=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,jt=new RegExp(le.source,"g");function la(t){return function(){return t}}function ua(t){return function(e){return t(e)+""}}function wn(t,e){var n=le.lastIndex=jt.lastIndex=0,r,i,a,o=-1,s=[],l=[];for(t=t+"",e=e+"";(r=le.exec(t))&&(i=jt.exec(e));)(a=i.index)>n&&(a=e.slice(n,a),s[o]?s[o]+=a:s[++o]=a),(r=r[0])===(i=i[0])?s[o]?s[o]+=i:s[++o]=i:(s[++o]=null,l.push({i:o,x:B(r,i)})),n=jt.lastIndex;return n<e.length&&(a=e.slice(n),s[o]?s[o]+=a:s[++o]=a),s.length<2?l[0]?ua(l[0].x):la(e):(e=l.length,function(u){for(var c=0,h;c<e;++c)s[(h=l[c]).i]=h.x(u);return s.join("")})}function xe(t,e){var n=typeof e,r;return e==null||n==="boolean"?we(e):(n==="number"?B:n==="string"?(r=st(e))?(e=r,Ot):wn:e instanceof st?Ot:e instanceof Date?oa:ia(e)?ra:Array.isArray(e)?aa:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?sa:B)(t,e)}function ca(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}var He=180/Math.PI,ue={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function xn(t,e,n,r,i,a){var o,s,l;return(o=Math.sqrt(t*t+e*e))&&(t/=o,e/=o),(l=t*n+e*r)&&(n-=t*l,r-=e*l),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,l/=s),t*r<e*n&&(t=-t,e=-e,l=-l,o=-o),{translateX:i,translateY:a,rotate:Math.atan2(e,t)*He,skewX:Math.atan(l)*He,scaleX:o,scaleY:s}}var Ct;function ha(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?ue:xn(e.a,e.b,e.c,e.d,e.e,e.f)}function fa(t){return t==null||(Ct||(Ct=document.createElementNS("http://www.w3.org/2000/svg","g")),Ct.setAttribute("transform",t),!(t=Ct.transform.baseVal.consolidate()))?ue:(t=t.matrix,xn(t.a,t.b,t.c,t.d,t.e,t.f))}function bn(t,e,n,r){function i(u){return u.length?u.pop()+" ":""}function a(u,c,h,f,d,v){if(u!==h||c!==f){var y=d.push("translate(",null,e,null,n);v.push({i:y-4,x:B(u,h)},{i:y-2,x:B(c,f)})}else(h||f)&&d.push("translate("+h+e+f+n)}function o(u,c,h,f){u!==c?(u-c>180?c+=360:c-u>180&&(u+=360),f.push({i:h.push(i(h)+"rotate(",null,r)-2,x:B(u,c)})):c&&h.push(i(h)+"rotate("+c+r)}function s(u,c,h,f){u!==c?f.push({i:h.push(i(h)+"skewX(",null,r)-2,x:B(u,c)}):c&&h.push(i(h)+"skewX("+c+r)}function l(u,c,h,f,d,v){if(u!==h||c!==f){var y=d.push(i(d)+"scale(",null,",",null,")");v.push({i:y-4,x:B(u,h)},{i:y-2,x:B(c,f)})}else(h!==1||f!==1)&&d.push(i(d)+"scale("+h+","+f+")")}return function(u,c){var h=[],f=[];return u=t(u),c=t(c),a(u.translateX,u.translateY,c.translateX,c.translateY,h,f),o(u.rotate,c.rotate,h,f),s(u.skewX,c.skewX,h,f),l(u.scaleX,u.scaleY,c.scaleX,c.scaleY,h,f),u=c=null,function(d){for(var v=-1,y=f.length,w;++v<y;)h[(w=f[v]).i]=w.x(d);return h.join("")}}}var da=bn(ha,"px, ","px)","deg)"),pa=bn(fa,", ",")",")"),dt=0,wt=0,vt=0,kn=1e3,Xt,xt,Bt=0,lt=0,Zt=0,Mt=typeof performance=="object"&&performance.now?performance:Date,An=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function be(){return lt||(An(va),lt=Mt.now()+Zt)}function va(){lt=0}function Vt(){this._call=this._time=this._next=null}Vt.prototype=Mn.prototype={constructor:Vt,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?be():+n)+(e==null?0:+e),!this._next&&xt!==this&&(xt?xt._next=this:Xt=this,xt=this),this._call=t,this._time=n,ce()},stop:function(){this._call&&(this._call=null,this._time=1/0,ce())}};function Mn(t,e,n){var r=new Vt;return r.restart(t,e,n),r}function ga(){be(),++dt;for(var t=Xt,e;t;)(e=lt-t._time)>=0&&t._call.call(void 0,e),t=t._next;--dt}function Le(){lt=(Bt=Mt.now())+Zt,dt=wt=0;try{ga()}finally{dt=0,ya(),lt=0}}function ma(){var t=Mt.now(),e=t-Bt;e>kn&&(Zt-=e,Bt=t)}function ya(){for(var t,e=Xt,n,r=1/0;e;)e._call?(r>e._time&&(r=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:Xt=n);xt=t,ce(r)}function ce(t){if(!dt){wt&&(wt=clearTimeout(wt));var e=t-lt;e>24?(t<1/0&&(wt=setTimeout(Le,t-Mt.now()-Zt)),vt&&(vt=clearInterval(vt))):(vt||(Bt=Mt.now(),vt=setInterval(ma,kn)),dt=1,An(Le))}}function qe(t,e,n){var r=new Vt;return e=e==null?0:+e,r.restart(i=>{r.stop(),t(i+e)},e,n),r}var _a=an("start","end","cancel","interrupt"),wa=[],$n=0,Oe=1,he=2,Ft=3,Xe=4,fe=5,Dt=6;function Jt(t,e,n,r,i,a){var o=t.__transition;if(!o)t.__transition={};else if(n in o)return;xa(t,n,{name:e,index:r,group:i,on:_a,tween:wa,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:$n})}function ke(t,e){var n=Y(t,e);if(n.state>$n)throw new Error("too late; already scheduled");return n}function Z(t,e){var n=Y(t,e);if(n.state>Ft)throw new Error("too late; already running");return n}function Y(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function xa(t,e,n){var r=t.__transition,i;r[e]=n,n.timer=Mn(a,0,n.time);function a(u){n.state=Oe,n.timer.restart(o,n.delay,n.time),n.delay<=u&&o(u-n.delay)}function o(u){var c,h,f,d;if(n.state!==Oe)return l();for(c in r)if(d=r[c],d.name===n.name){if(d.state===Ft)return qe(o);d.state===Xe?(d.state=Dt,d.timer.stop(),d.on.call("interrupt",t,t.__data__,d.index,d.group),delete r[c]):+c<e&&(d.state=Dt,d.timer.stop(),d.on.call("cancel",t,t.__data__,d.index,d.group),delete r[c])}if(qe(function(){n.state===Ft&&(n.state=Xe,n.timer.restart(s,n.delay,n.time),s(u))}),n.state=he,n.on.call("start",t,t.__data__,n.index,n.group),n.state===he){for(n.state=Ft,i=new Array(f=n.tween.length),c=0,h=-1;c<f;++c)(d=n.tween[c].value.call(t,t.__data__,n.index,n.group))&&(i[++h]=d);i.length=h+1}}function s(u){for(var c=u<n.duration?n.ease.call(null,u/n.duration):(n.timer.restart(l),n.state=fe,1),h=-1,f=i.length;++h<f;)i[h].call(t,c);n.state===fe&&(n.on.call("end",t,t.__data__,n.index,n.group),l())}function l(){n.state=Dt,n.timer.stop(),delete r[e];for(var u in r)return;delete t.__transition}}function ba(t,e){var n=t.__transition,r,i,a=!0,o;if(n){e=e==null?null:e+"";for(o in n){if((r=n[o]).name!==e){a=!1;continue}i=r.state>he&&r.state<fe,r.state=Dt,r.timer.stop(),r.on.call(i?"interrupt":"cancel",t,t.__data__,r.index,r.group),delete n[o]}a&&delete t.__transition}}function ka(t){return this.each(function(){ba(this,t)})}function Aa(t,e){var n,r;return function(){var i=Z(this,t),a=i.tween;if(a!==n){r=n=a;for(var o=0,s=r.length;o<s;++o)if(r[o].name===e){r=r.slice(),r.splice(o,1);break}}i.tween=r}}function Ma(t,e,n){var r,i;if(typeof n!="function")throw new Error;return function(){var a=Z(this,t),o=a.tween;if(o!==r){i=(r=o).slice();for(var s={name:e,value:n},l=0,u=i.length;l<u;++l)if(i[l].name===e){i[l]=s;break}l===u&&i.push(s)}a.tween=i}}function $a(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r=Y(this.node(),n).tween,i=0,a=r.length,o;i<a;++i)if((o=r[i]).name===t)return o.value;return null}return this.each((e==null?Aa:Ma)(n,t,e))}function Ae(t,e,n){var r=t._id;return t.each(function(){var i=Z(this,r);(i.value||(i.value={}))[e]=n.apply(this,arguments)}),function(i){return Y(i,r).value[e]}}function Tn(t,e){var n;return(typeof e=="number"?B:e instanceof st?Ot:(n=st(e))?(e=n,Ot):wn)(t,e)}function Ta(t){return function(){this.removeAttribute(t)}}function Na(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Sa(t,e,n){var r,i=n+"",a;return function(){var o=this.getAttribute(t);return o===i?null:o===r?a:a=e(r=o,n)}}function Ea(t,e,n){var r,i=n+"",a;return function(){var o=this.getAttributeNS(t.space,t.local);return o===i?null:o===r?a:a=e(r=o,n)}}function Ca(t,e,n){var r,i,a;return function(){var o,s=n(this),l;return s==null?void this.removeAttribute(t):(o=this.getAttribute(t),l=s+"",o===l?null:o===r&&l===i?a:(i=l,a=e(r=o,s)))}}function Ia(t,e,n){var r,i,a;return function(){var o,s=n(this),l;return s==null?void this.removeAttributeNS(t.space,t.local):(o=this.getAttributeNS(t.space,t.local),l=s+"",o===l?null:o===r&&l===i?a:(i=l,a=e(r=o,s)))}}function za(t,e){var n=Wt(t),r=n==="transform"?pa:Tn;return this.attrTween(t,typeof e=="function"?(n.local?Ia:Ca)(n,r,Ae(this,"attr."+t,e)):e==null?(n.local?Na:Ta)(n):(n.local?Ea:Sa)(n,r,e))}function Ra(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function Fa(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function Da(t,e){var n,r;function i(){var a=e.apply(this,arguments);return a!==r&&(n=(r=a)&&Fa(t,a)),n}return i._value=e,i}function Pa(t,e){var n,r;function i(){var a=e.apply(this,arguments);return a!==r&&(n=(r=a)&&Ra(t,a)),n}return i._value=e,i}function Ha(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var r=Wt(t);return this.tween(n,(r.local?Da:Pa)(r,e))}function La(t,e){return function(){ke(this,t).delay=+e.apply(this,arguments)}}function qa(t,e){return e=+e,function(){ke(this,t).delay=e}}function Oa(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?La:qa)(e,t)):Y(this.node(),e).delay}function Xa(t,e){return function(){Z(this,t).duration=+e.apply(this,arguments)}}function Ba(t,e){return e=+e,function(){Z(this,t).duration=e}}function Va(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?Xa:Ba)(e,t)):Y(this.node(),e).duration}function Ua(t,e){if(typeof e!="function")throw new Error;return function(){Z(this,t).ease=e}}function Ya(t){var e=this._id;return arguments.length?this.each(Ua(e,t)):Y(this.node(),e).ease}function Ga(t,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;Z(this,t).ease=n}}function Wa(t){if(typeof t!="function")throw new Error;return this.each(Ga(this._id,t))}function Za(t){typeof t!="function"&&(t=ln(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a=e[i],o=a.length,s=r[i]=[],l,u=0;u<o;++u)(l=a[u])&&t.call(l,l.__data__,u,a)&&s.push(l);return new Q(r,this._parents,this._name,this._id)}function Ja(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,a=Math.min(r,i),o=new Array(r),s=0;s<a;++s)for(var l=e[s],u=n[s],c=l.length,h=o[s]=new Array(c),f,d=0;d<c;++d)(f=l[d]||u[d])&&(h[d]=f);for(;s<r;++s)o[s]=e[s];return new Q(o,this._parents,this._name,this._id)}function Ka(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function Qa(t,e,n){var r,i,a=Ka(e)?ke:Z;return function(){var o=a(this,t),s=o.on;s!==r&&(i=(r=s).copy()).on(e,n),o.on=i}}function ja(t,e){var n=this._id;return arguments.length<2?Y(this.node(),n).on.on(t):this.each(Qa(n,t,e))}function to(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function eo(){return this.on("end.remove",to(this._id))}function no(t){var e=this._name,n=this._id;typeof t!="function"&&(t=me(t));for(var r=this._groups,i=r.length,a=new Array(i),o=0;o<i;++o)for(var s=r[o],l=s.length,u=a[o]=new Array(l),c,h,f=0;f<l;++f)(c=s[f])&&(h=t.call(c,c.__data__,f,s))&&("__data__"in c&&(h.__data__=c.__data__),u[f]=h,Jt(u[f],e,n,f,u,Y(c,n)));return new Q(a,this._parents,e,n)}function ro(t){var e=this._name,n=this._id;typeof t!="function"&&(t=sn(t));for(var r=this._groups,i=r.length,a=[],o=[],s=0;s<i;++s)for(var l=r[s],u=l.length,c,h=0;h<u;++h)if(c=l[h]){for(var f=t.call(c,c.__data__,h,l),d,v=Y(c,n),y=0,w=f.length;y<w;++y)(d=f[y])&&Jt(d,e,n,y,f,v);a.push(f),o.push(c)}return new Q(a,o,e,n)}var io=$t.prototype.constructor;function ao(){return new io(this._groups,this._parents)}function oo(t,e){var n,r,i;return function(){var a=ft(this,t),o=(this.style.removeProperty(t),ft(this,t));return a===o?null:a===n&&o===r?i:i=e(n=a,r=o)}}function Nn(t){return function(){this.style.removeProperty(t)}}function so(t,e,n){var r,i=n+"",a;return function(){var o=ft(this,t);return o===i?null:o===r?a:a=e(r=o,n)}}function lo(t,e,n){var r,i,a;return function(){var o=ft(this,t),s=n(this),l=s+"";return s==null&&(l=s=(this.style.removeProperty(t),ft(this,t))),o===l?null:o===r&&l===i?a:(i=l,a=e(r=o,s))}}function uo(t,e){var n,r,i,a="style."+e,o="end."+a,s;return function(){var l=Z(this,t),u=l.on,c=l.value[a]==null?s||(s=Nn(e)):void 0;(u!==n||i!==c)&&(r=(n=u).copy()).on(o,i=c),l.on=r}}function co(t,e,n){var r=(t+="")=="transform"?da:Tn;return e==null?this.styleTween(t,oo(t,r)).on("end.style."+t,Nn(t)):typeof e=="function"?this.styleTween(t,lo(t,r,Ae(this,"style."+t,e))).each(uo(this._id,t)):this.styleTween(t,so(t,r,e),n).on("end.style."+t,null)}function ho(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function fo(t,e,n){var r,i;function a(){var o=e.apply(this,arguments);return o!==i&&(r=(i=o)&&ho(t,o,n)),r}return a._value=e,a}function po(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;return this.tween(r,fo(t,e,n??""))}function vo(t){return function(){this.textContent=t}}function go(t){return function(){var e=t(this);this.textContent=e??""}}function mo(t){return this.tween("text",typeof t=="function"?go(Ae(this,"text",t)):vo(t==null?"":t+""))}function yo(t){return function(e){this.textContent=t.call(this,e)}}function _o(t){var e,n;function r(){var i=t.apply(this,arguments);return i!==n&&(e=(n=i)&&yo(i)),e}return r._value=t,r}function wo(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,_o(t))}function xo(){for(var t=this._name,e=this._id,n=Sn(),r=this._groups,i=r.length,a=0;a<i;++a)for(var o=r[a],s=o.length,l,u=0;u<s;++u)if(l=o[u]){var c=Y(l,e);Jt(l,t,n,u,o,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new Q(r,this._parents,t,n)}function bo(){var t,e,n=this,r=n._id,i=n.size();return new Promise(function(a,o){var s={value:o},l={value:function(){--i===0&&a()}};n.each(function(){var u=Z(this,r),c=u.on;c!==t&&(e=(t=c).copy(),e._.cancel.push(s),e._.interrupt.push(s),e._.end.push(l)),u.on=e}),i===0&&a()})}var ko=0;function Q(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function Sn(){return++ko}var K=$t.prototype;Q.prototype={constructor:Q,select:no,selectAll:ro,selectChild:K.selectChild,selectChildren:K.selectChildren,filter:Za,merge:Ja,selection:ao,transition:xo,call:K.call,nodes:K.nodes,node:K.node,size:K.size,empty:K.empty,each:K.each,on:ja,attr:za,attrTween:Ha,style:co,styleTween:po,text:mo,textTween:wo,remove:eo,tween:$a,delay:Oa,duration:Va,ease:Ya,easeVarying:Wa,end:bo,[Symbol.iterator]:K[Symbol.iterator]};function Ao(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var Mo={time:null,delay:0,duration:250,ease:Ao};function $o(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function To(t){var e,n;t instanceof Q?(e=t._id,t=t._name):(e=Sn(),(n=Mo).time=be(),t=t==null?null:t+"");for(var r=this._groups,i=r.length,a=0;a<i;++a)for(var o=r[a],s=o.length,l,u=0;u<s;++u)(l=o[u])&&Jt(l,t,e,u,o,n||$o(l,e));return new Q(r,this._parents,t,e)}$t.prototype.interrupt=ka;$t.prototype.transition=To;const de=Math.PI,pe=2*de,nt=1e-6,No=pe-nt;function En(t){this._+=t[0];for(let e=1,n=t.length;e<n;++e)this._+=arguments[e]+t[e]}function So(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return En;const n=10**e;return function(r){this._+=r[0];for(let i=1,a=r.length;i<a;++i)this._+=Math.round(arguments[i]*n)/n+r[i]}}class Eo{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?En:So(e)}moveTo(e,n){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,n){this._append`L${this._x1=+e},${this._y1=+n}`}quadraticCurveTo(e,n,r,i){this._append`Q${+e},${+n},${this._x1=+r},${this._y1=+i}`}bezierCurveTo(e,n,r,i,a,o){this._append`C${+e},${+n},${+r},${+i},${this._x1=+a},${this._y1=+o}`}arcTo(e,n,r,i,a){if(e=+e,n=+n,r=+r,i=+i,a=+a,a<0)throw new Error(`negative radius: ${a}`);let o=this._x1,s=this._y1,l=r-e,u=i-n,c=o-e,h=s-n,f=c*c+h*h;if(this._x1===null)this._append`M${this._x1=e},${this._y1=n}`;else if(f>nt)if(!(Math.abs(h*l-u*c)>nt)||!a)this._append`L${this._x1=e},${this._y1=n}`;else{let d=r-o,v=i-s,y=l*l+u*u,w=d*d+v*v,M=Math.sqrt(y),E=Math.sqrt(f),k=a*Math.tan((de-Math.acos((y+f-w)/(2*M*E)))/2),R=k/E,g=k/M;Math.abs(R-1)>nt&&this._append`L${e+R*c},${n+R*h}`,this._append`A${a},${a},0,0,${+(h*d>c*v)},${this._x1=e+g*l},${this._y1=n+g*u}`}}arc(e,n,r,i,a,o){if(e=+e,n=+n,r=+r,o=!!o,r<0)throw new Error(`negative radius: ${r}`);let s=r*Math.cos(i),l=r*Math.sin(i),u=e+s,c=n+l,h=1^o,f=o?i-a:a-i;this._x1===null?this._append`M${u},${c}`:(Math.abs(this._x1-u)>nt||Math.abs(this._y1-c)>nt)&&this._append`L${u},${c}`,r&&(f<0&&(f=f%pe+pe),f>No?this._append`A${r},${r},0,1,${h},${e-s},${n-l}A${r},${r},0,1,${h},${this._x1=u},${this._y1=c}`:f>nt&&this._append`A${r},${r},0,${+(f>=de)},${h},${this._x1=e+r*Math.cos(a)},${this._y1=n+r*Math.sin(a)}`)}rect(e,n,r,i){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}h${r=+r}v${+i}h${-r}Z`}toString(){return this._}}var Be={},te={},ee=34,gt=10,ne=13;function Cn(t){return new Function("d","return {"+t.map(function(e,n){return JSON.stringify(e)+": d["+n+'] || ""'}).join(",")+"}")}function Co(t,e){var n=Cn(t);return function(r,i){return e(n(r),i,t)}}function Ve(t){var e=Object.create(null),n=[];return t.forEach(function(r){for(var i in r)i in e||n.push(e[i]=i)}),n}function L(t,e){var n=t+"",r=n.length;return r<e?new Array(e-r+1).join(0)+n:n}function Io(t){return t<0?"-"+L(-t,6):t>9999?"+"+L(t,6):L(t,4)}function zo(t){var e=t.getUTCHours(),n=t.getUTCMinutes(),r=t.getUTCSeconds(),i=t.getUTCMilliseconds();return isNaN(t)?"Invalid Date":Io(t.getUTCFullYear())+"-"+L(t.getUTCMonth()+1,2)+"-"+L(t.getUTCDate(),2)+(i?"T"+L(e,2)+":"+L(n,2)+":"+L(r,2)+"."+L(i,3)+"Z":r?"T"+L(e,2)+":"+L(n,2)+":"+L(r,2)+"Z":n||e?"T"+L(e,2)+":"+L(n,2)+"Z":"")}function Ro(t){var e=new RegExp('["'+t+`
\r]`),n=t.charCodeAt(0);function r(h,f){var d,v,y=i(h,function(w,M){if(d)return d(w,M-1);v=w,d=f?Co(w,f):Cn(w)});return y.columns=v||[],y}function i(h,f){var d=[],v=h.length,y=0,w=0,M,E=v<=0,k=!1;h.charCodeAt(v-1)===gt&&--v,h.charCodeAt(v-1)===ne&&--v;function R(){if(E)return te;if(k)return k=!1,Be;var _,b=y,x;if(h.charCodeAt(b)===ee){for(;y++<v&&h.charCodeAt(y)!==ee||h.charCodeAt(++y)===ee;);return(_=y)>=v?E=!0:(x=h.charCodeAt(y++))===gt?k=!0:x===ne&&(k=!0,h.charCodeAt(y)===gt&&++y),h.slice(b+1,_-1).replace(/""/g,'"')}for(;y<v;){if((x=h.charCodeAt(_=y++))===gt)k=!0;else if(x===ne)k=!0,h.charCodeAt(y)===gt&&++y;else if(x!==n)continue;return h.slice(b,_)}return E=!0,h.slice(b,v)}for(;(M=R())!==te;){for(var g=[];M!==Be&&M!==te;)g.push(M),M=R();f&&(g=f(g,w++))==null||d.push(g)}return d}function a(h,f){return h.map(function(d){return f.map(function(v){return c(d[v])}).join(t)})}function o(h,f){return f==null&&(f=Ve(h)),[f.map(c).join(t)].concat(a(h,f)).join(`
`)}function s(h,f){return f==null&&(f=Ve(h)),a(h,f).join(`
`)}function l(h){return h.map(u).join(`
`)}function u(h){return h.map(c).join(t)}function c(h){return h==null?"":h instanceof Date?zo(h):e.test(h+="")?'"'+h.replace(/"/g,'""')+'"':h}return{parse:r,parseRows:i,format:o,formatBody:s,formatRows:l,formatRow:u,formatValue:c}}var Fo=Ro(","),Do=Fo.parse;function Po(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.text()}function Ho(t,e){return fetch(t,e).then(Po)}function Lo(t){return function(e,n,r){return arguments.length===2&&typeof n=="function"&&(r=n,n=void 0),Ho(e,n).then(function(i){return t(i,r)})}}var qo=Lo(Do);function Oo(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function Ut(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function pt(t){return t=Ut(Math.abs(t)),t?t[1]:NaN}function Xo(t,e){return function(n,r){for(var i=n.length,a=[],o=0,s=t[0],l=0;i>0&&s>0&&(l+s+1>r&&(s=Math.max(1,r-l)),a.push(n.substring(i-=s,i+s)),!((l+=s+1)>r));)s=t[o=(o+1)%t.length];return a.reverse().join(e)}}function Bo(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var Vo=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Yt(t){if(!(e=Vo.exec(t)))throw new Error("invalid format: "+t);var e;return new Me({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}Yt.prototype=Me.prototype;function Me(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}Me.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Uo(t){t:for(var e=t.length,n=1,r=-1,i;n<e;++n)switch(t[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+t[n])break t;r>0&&(r=0);break}return r>0?t.slice(0,r)+t.slice(i+1):t}var In;function Yo(t,e){var n=Ut(t,e);if(!n)return t+"";var r=n[0],i=n[1],a=i-(In=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,o=r.length;return a===o?r:a>o?r+new Array(a-o+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+Ut(t,Math.max(0,e+a-1))[0]}function Ue(t,e){var n=Ut(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const Ye={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:Oo,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>Ue(t*100,e),r:Ue,s:Yo,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function Ge(t){return t}var We=Array.prototype.map,Ze=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function Go(t){var e=t.grouping===void 0||t.thousands===void 0?Ge:Xo(We.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",r=t.currency===void 0?"":t.currency[1]+"",i=t.decimal===void 0?".":t.decimal+"",a=t.numerals===void 0?Ge:Bo(We.call(t.numerals,String)),o=t.percent===void 0?"%":t.percent+"",s=t.minus===void 0?"−":t.minus+"",l=t.nan===void 0?"NaN":t.nan+"";function u(h){h=Yt(h);var f=h.fill,d=h.align,v=h.sign,y=h.symbol,w=h.zero,M=h.width,E=h.comma,k=h.precision,R=h.trim,g=h.type;g==="n"?(E=!0,g="g"):Ye[g]||(k===void 0&&(k=12),R=!0,g="g"),(w||f==="0"&&d==="=")&&(w=!0,f="0",d="=");var _=y==="$"?n:y==="#"&&/[boxX]/.test(g)?"0"+g.toLowerCase():"",b=y==="$"?r:/[%p]/.test(g)?o:"",x=Ye[g],N=/[defgprs%]/.test(g);k=k===void 0?6:/[gprs]/.test(g)?Math.max(1,Math.min(21,k)):Math.max(0,Math.min(20,k));function F(m){var D=_,z=b,J,et,S;if(g==="c")z=x(m)+z,m="";else{m=+m;var C=m<0||1/m<0;if(m=isNaN(m)?l:x(Math.abs(m),k),R&&(m=Uo(m)),C&&+m==0&&v!=="+"&&(C=!1),D=(C?v==="("?v:s:v==="-"||v==="("?"":v)+D,z=(g==="s"?Ze[8+In/3]:"")+z+(C&&v==="("?")":""),N){for(J=-1,et=m.length;++J<et;)if(S=m.charCodeAt(J),48>S||S>57){z=(S===46?i+m.slice(J+1):m.slice(J))+z,m=m.slice(0,J);break}}}E&&!w&&(m=e(m,1/0));var j=D.length+m.length+z.length,X=j<M?new Array(M-j+1).join(f):"";switch(E&&w&&(m=e(X+m,X.length?M-z.length:1/0),X=""),d){case"<":m=D+m+z+X;break;case"=":m=D+X+m+z;break;case"^":m=X.slice(0,j=X.length>>1)+D+m+z+X.slice(j);break;default:m=X+D+m+z;break}return a(m)}return F.toString=function(){return h+""},F}function c(h,f){var d=u((h=Yt(h),h.type="f",h)),v=Math.max(-8,Math.min(8,Math.floor(pt(f)/3)))*3,y=Math.pow(10,-v),w=Ze[8+v/3];return function(M){return d(y*M)+w}}return{format:u,formatPrefix:c}}var It,zn,Rn;Wo({thousands:",",grouping:[3],currency:["$",""]});function Wo(t){return It=Go(t),zn=It.format,Rn=It.formatPrefix,It}function Zo(t){return Math.max(0,-pt(Math.abs(t)))}function Jo(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(pt(e)/3)))*3-pt(Math.abs(t)))}function Ko(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,pt(e)-pt(t))+1}function Qo(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function jo(t){return function(){return t}}function ts(t){return+t}var Je=[0,1];function ct(t){return t}function ve(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:jo(isNaN(e)?NaN:.5)}function es(t,e){var n;return t>e&&(n=t,t=e,e=n),function(r){return Math.max(t,Math.min(e,r))}}function ns(t,e,n){var r=t[0],i=t[1],a=e[0],o=e[1];return i<r?(r=ve(i,r),a=n(o,a)):(r=ve(r,i),a=n(a,o)),function(s){return a(r(s))}}function rs(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),a=new Array(r),o=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++o<r;)i[o]=ve(t[o],t[o+1]),a[o]=n(e[o],e[o+1]);return function(s){var l=Qn(t,s,1,r)-1;return a[l](i[l](s))}}function is(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function as(){var t=Je,e=Je,n=xe,r,i,a,o=ct,s,l,u;function c(){var f=Math.min(t.length,e.length);return o!==ct&&(o=es(t[0],t[f-1])),s=f>2?rs:ns,l=u=null,h}function h(f){return f==null||isNaN(f=+f)?a:(l||(l=s(t.map(r),e,n)))(r(o(f)))}return h.invert=function(f){return o(i((u||(u=s(e,t.map(r),B)))(f)))},h.domain=function(f){return arguments.length?(t=Array.from(f,ts),c()):t.slice()},h.range=function(f){return arguments.length?(e=Array.from(f),c()):e.slice()},h.rangeRound=function(f){return e=Array.from(f),n=ca,c()},h.clamp=function(f){return arguments.length?(o=f?!0:ct,c()):o!==ct},h.interpolate=function(f){return arguments.length?(n=f,c()):n},h.unknown=function(f){return arguments.length?(a=f,h):a},function(f,d){return r=f,i=d,c()}}function os(){return as()(ct,ct)}function ss(t,e,n,r){var i=rr(t,e,n),a;switch(r=Yt(r??",f"),r.type){case"s":{var o=Math.max(Math.abs(t),Math.abs(e));return r.precision==null&&!isNaN(a=Jo(i,o))&&(r.precision=a),Rn(r,o)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(a=Ko(i,Math.max(Math.abs(t),Math.abs(e))))&&(r.precision=a-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(a=Zo(i))&&(r.precision=a-(r.type==="%")*2);break}}return zn(r)}function ls(t){var e=t.domain;return t.ticks=function(n){var r=e();return nr(r[0],r[r.length-1],n??10)},t.tickFormat=function(n,r){var i=e();return ss(i[0],i[i.length-1],n??10,r)},t.nice=function(n){n==null&&(n=10);var r=e(),i=0,a=r.length-1,o=r[i],s=r[a],l,u,c=10;for(s<o&&(u=o,o=s,s=u,u=i,i=a,a=u);c-- >0;){if(u=ae(o,s,n),u===l)return r[i]=o,r[a]=s,e(r);if(u>0)o=Math.floor(o/u)*u,s=Math.ceil(s/u)*u;else if(u<0)o=Math.ceil(o*u)/u,s=Math.floor(s*u)/u;else break;l=u}return t},t}function ge(){var t=os();return t.copy=function(){return is(t,ge())},Qo.apply(t,arguments),ls(t)}function ut(t){return function(){return t}}function us(t){let e=3;return t.digits=function(n){if(!arguments.length)return e;if(n==null)e=null;else{const r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);e=r}return t},()=>new Eo(e)}function cs(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function Fn(t){this._context=t}Fn.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function hs(t){return new Fn(t)}function fs(t){return t[0]}function ds(t){return t[1]}function ps(t,e){var n=ut(!0),r=null,i=hs,a=null,o=us(s);t=typeof t=="function"?t:t===void 0?fs:ut(t),e=typeof e=="function"?e:e===void 0?ds:ut(e);function s(l){var u,c=(l=cs(l)).length,h,f=!1,d;for(r==null&&(a=i(d=o())),u=0;u<=c;++u)!(u<c&&n(h=l[u],u,l))===f&&((f=!f)?a.lineStart():a.lineEnd()),f&&a.point(+t(h,u,l),+e(h,u,l));if(d)return a=null,d+""||null}return s.x=function(l){return arguments.length?(t=typeof l=="function"?l:ut(+l),s):t},s.y=function(l){return arguments.length?(e=typeof l=="function"?l:ut(+l),s):e},s.defined=function(l){return arguments.length?(n=typeof l=="function"?l:ut(!!l),s):n},s.curve=function(l){return arguments.length?(i=l,r!=null&&(a=i(r)),s):i},s.context=function(l){return arguments.length?(l==null?r=a=null:a=i(r=l),s):r},s}function bt(t,e,n){this.k=t,this.x=e,this.y=n}bt.prototype={constructor:bt,scale:function(t){return t===1?this:new bt(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new bt(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};bt.prototype;var vs=tt('<div class="legend-item svelte-4o8g80"><svg width="24" height="12" viewBox="0 0 24 12" class="svelte-4o8g80"><path d="M0,6 L24,6" stroke-width="3" fill="none"></path></svg> <span class="legend-text svelte-4o8g80"> </span></div>'),gs=Gt('<line stroke="#333" stroke-width="1"></line><text fill="#fff" text-anchor="end" dominant-baseline="middle" class="svelte-4o8g80"> </text>',1),ms=Gt('<line stroke="#333" stroke-width="1"></line><text fill="#fff" text-anchor="middle" class="svelte-4o8g80"> </text>',1),ys=Gt('<path fill="none" stroke-width="3"></path>'),_s=Gt('<text fill="#fff" text-anchor="middle" transform="rotate(-90, 10, 200)" class="y-axis-title svelte-4o8g80"> </text>'),ws=tt('<div class="chart-container svelte-4o8g80"><h2 class="svelte-4o8g80"> </h2> <div class="legend-container svelte-4o8g80"></div> <svg height="400"><rect height="400" fill="#000"></rect><!><!><!><!></svg></div>');function mt(t,e){Ke(e,!1);let n=it(e,"path_to_data",8,""),r=it(e,"title",8,""),i=it(e,"yticks",24,()=>[]),a=it(e,"y_axis_title",8,""),o=G(750),s=G([]),l=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],u=["#8DBF2E","#00A189","#6FC7EA","#007FA3","#AB1368","#DC4633","#F1C500"];nn(()=>{const g=()=>{const _=document.querySelector(".chart-container");_&&H(o,Math.min(p(o),_.parentElement.clientWidth))};return g(),window.addEventListener("resize",g),qo(n()).then(_=>{H(s,_.map(b=>{const x={Hour:+b.Hour};return l.forEach(N=>x[N]=+b[N]),x}))}),()=>window.removeEventListener("resize",g)});let c=G();re(()=>(p(s),p(o),Dn(i())),()=>{if(p(s).length>0){const g=ge().domain([0,23]).range([50,p(o)-20]),_=ge().domain([ar(i()),ir(i())]).range([360,40]),b=ps().x(m=>g(m.Hour)).y(m=>_(m.value)),x=l.map(m=>{const D=m==="Saturday"||m==="Sunday";return{day:m,path:b(p(s).map(z=>({Hour:z.Hour,value:z[m]}))),color:u[l.indexOf(m)],isDashed:D}}),N=Array.from({length:24},(m,D)=>D),F=[...i()];H(c,{x:g,y:_,lines:x,xTicks:N,yTicks:F})}}),Qe(),en();var h=ws(),f=I(h),d=I(f,!0);$(f);var v=T(f,2);yt(v,5,()=>{var g;return(g=p(c))==null?void 0:g.lines},_t,(g,_)=>{var b=vs(),x=I(b),N=I(x);$(x);var F=T(x,2),m=I(F,!0);$(F),$(b),P(()=>{A(N,"stroke",p(_).color),A(N,"stroke-dasharray",p(_).isDashed?"4,2":"0"),rt(m,p(_).day)}),O(g,b)}),$(v);var y=T(v,2),w=I(y),M=T(w);yt(M,1,()=>{var g;return(g=p(c))==null?void 0:g.yTicks},_t,(g,_)=>{var b=gs(),x=ie(b);A(x,"x1",50),P(()=>A(x,"y1",p(c).y(p(_)))),P(()=>A(x,"y2",p(c).y(p(_))));var N=T(x);A(N,"x",45),P(()=>A(N,"y",p(c).y(p(_))));var F=I(N,!0);$(N),P(()=>{A(x,"x2",p(o)-20),rt(F,p(_))}),O(g,b)});var E=T(M);yt(E,1,()=>{var g;return(g=p(c))==null?void 0:g.xTicks},_t,(g,_)=>{var b=ms(),x=ie(b);P(()=>A(x,"x1",p(c).x(p(_)))),A(x,"y1",360),P(()=>A(x,"x2",p(c).x(p(_)))),A(x,"y2",40);var N=T(x);P(()=>A(N,"x",p(c).x(p(_)))),A(N,"y",375);var F=I(N,!0);$(N),P(()=>rt(F,p(_))),O(g,b)});var k=T(E);yt(k,1,()=>{var g;return(g=p(c))==null?void 0:g.lines},_t,(g,_)=>{var b=ys();P(()=>{A(b,"d",p(_).path),A(b,"stroke",p(_).color),A(b,"stroke-dasharray",p(_).isDashed?"4,2":"0")}),O(g,b)});var R=T(k);tn(R,a,g=>{var _=_s();A(_,"x",15),A(_,"y",205);var b=I(_,!0);$(_),P(()=>rt(b,a())),O(g,_)}),$(y),$(h),P(()=>{A(h,"style",`width: ${p(o)??""}px; height: 450px;`),rt(d,r()),A(y,"width",p(o)),A(y,"viewBox",`0 0 ${p(o)} 400`),A(w,"width",p(o))}),O(t,h),je()}const xs=""+new URL("../assets/top-image.JUTWmls1.png",import.meta.url).href;var bs=tt(`<!> <main class="svelte-uz1plv"><div class="title svelte-uz1plv"><img alt="" class="svelte-uz1plv"> <h1 class="svelte-uz1plv">Exploring hourly activity patterns in Toronto</h1> <p id="authors" class="svelte-uz1plv"><a href="https://camhkerr.com/" class="svelte-uz1plv">Cameron Kerr</a> <a href="https://www.urbandisplacement.org/team/julia-greenberg/" class="svelte-uz1plv">Julia Greenberg</a> <a href="https://jamaps.github.io/" class="svelte-uz1plv">Jeff Allen</a></p></div> <div class="text svelte-uz1plv"><p class="svelte-uz1plv">A city is a constantly changing complex system. Even hourly, as millions of people move from home to work, to events, and through their daily routines the city develops it's own pulse. We set out to visualize the pulse of the city and identify any patterns that emerge.</p> <p class="svelte-uz1plv">The Greater Toronto Area (GTA) provides a model area to investigate as it contains almost 7 million people and a diverse set of rural, mid-size-and mega- cities.</p> <p class="svelte-uz1plv">The bounding box around the GTA was subdivided into a rectangular grid containing over 16,000 grid cells each about 1km wide. To investigate hourly activity across the GTA the accumulated time in each of these grid cells was calculated. Hourly activity was measured by the accumulated time in each grid cell (i.e if 2 people spend half of the hour in a given cell, the region has an accumulated time of 1 in that hour). The time each person spends in each cell was calculated using a sample of mobile location data provided by Spectus. In the map below the total accumulated time is shown for the average weekday and weekend over the summer of 2024 in the GTA.</p></div> <!> <div class="text svelte-uz1plv"><p class="svelte-uz1plv">The map demonstrates that the patterns of total hourly activity are relatively constant throughout the average weekend and weekday. There are no large structural changes in the distribution of activity throughout the city. Hourly activity is concentrated around Toronto and it's surrounding large municipalities with more distant pockets having lower activity.</p> <p class="svelte-uz1plv">Smaller patterns which can be picked up include the increase in activity at the Toronto Pearson Airport during the day and the empty space it leaves at night. The only large scale change is the general drop in activity during the night, especially seen between 3am and 5 am. The plot below shows the number of active phones in the sample during each hour throughout the week. The observed drop could be due to the nature of the mobile location data, as cell phones send out less location pings during the night. Another factor could be people commuting from outside of the GTA and leaving during the night.</p></div> <!> <div class="text svelte-uz1plv"><p class="svelte-uz1plv">In the map above, the underlying population density distribution obscures the hourly changes which occur. To better visualize these changes we subtracted each cell's hourly activity by it's average hourly activity throughout the summer of 2024. This new metric measures how much more or less activity occurs in a given cell compared to it's typical activity.</p></div> <!> <div class="text svelte-uz1plv"><p class="svelte-uz1plv">This map demonstrates both large and small scale flucuations throughout the day. Similar to the previous map, most cells have a lower than average activity during the night and higher than average activity during the day. In addition, we can see movement from residential areas and into employment areas during the day. For example, the south-eastern part of Brampton is an employment area with the surrounding northern and western part containing residential areas. During the evening, these residential areas have a higher than average activity and during 9-5 on weekdays the employment areas are at higher activity. Similarly, Vaughan's primary employment area is located in the South and is surrounded by residential areas. Activity is concentrated in the employment areas during 9-5 on weekdays and spreads out to the surrounding areas in the evening. Due to it's high density it is difficult to discern similar patterns for Toronto, but a signfiicant increase in activity can be seen in the downtown core during working hours. Additionally, between 3 pm and 6 pm lines of increased activity can be seen on highway 400 and highway 401, representing the commute out of commercial areas.</p> <p class="svelte-uz1plv">In contrast to the commercial shift on weekdays, the progression through a weekend is less predicatable. In the evening the distribution is similar to that seen on weekdays, with most high activity occuring in residential areas. However, activity during the day is scattered throughout commercial and residential areas. The activity also starts much later in the day, with low activity in central areas as late as 11 am.</p> <h2 class="svelte-uz1plv">Diversity and clustering</h2> <p class="svelte-uz1plv">Diversity and clustering statistics were used to quantify the daily patterns observed in the maps above. To measure the diversity of hourly activity across the GTA, we applied Shannon's Diversity Index. This index captures both the number of cells with activity (richness) and how evenly that activity is distributed among them (evenness). A high Shannon index means that many cells have activity and that activity levels are relatively balanced across them. In contrast, a low Shannon index suggests that fewer cells are active and that activity is concentrated in specific cells. Note that this index is spatially unaware, if all the cells were shuffled into different positions on the map, the Shannon index value would remain the same.</p></div> <!> <div class="text svelte-uz1plv"><p class="svelte-uz1plv">In the plot above a clear 'pulse' in diversity forms throughout the day. Activity becomes more diverse during daytime hours, with an additional spike between 3 pm and 5 pm. The diversity subsequently drops off in the evening and overnight. Although the differences in the actual index values are relatively small, an Aligned Rank Transform (ART) ANOVA test confirmed that the variation in diversity between day and night is statistically significant. One possible explanation is that during the day people are more mobile and are accumulating less activity in specific cells, especially during commuting hours (when diversity peaks). Additionally, this diversity pulse appears later in the day on Saturdays and Sundays, likely due to delayed daily routines on weekends.</p> <p class="svelte-uz1plv">As mentioned above, Shannon's index reflects both richness and evenness. To better understand each components contribution to diversity, we can examine them seperately. In our case, richness represents the number of cells in the GTA which are visited within a given hour. Evenness represents the degree to which activity is uniformly distributed.</p></div> <!> <!> <div class="text svelte-uz1plv"><p class="svelte-uz1plv">The plot of richness (expressed here as the fraction of active cells) reveals a simlair daily 'pulse' to that seen in Shannon's diversity. During the day, more people are moving which generates activity in a large number of cells. At night, activity becomes concentrated in residential areas leaving roughly half of the cells inactive. Additionally, the drop in the number of phones (as seen in the first plot) contributes to a lower number of active cells.</p> <p class="svelte-uz1plv">Evenness follows a different pattern; it tends to spike at night and gradually decreases during the day, with a smaller increase on weekdays between 3pm and 5 pm. The nightime spike likely results from low activity levels where urban and rural cells experience minimal activity. The increase between 3 and 5 pm may reflect commuting, as people spread out more evenly across the GTA. Note that despite the distinct pattern seen, the numerical change in evenness is small.</p> <p class="svelte-uz1plv">To investigate clustering, we calculated Moran's I for each hour throughout the week. In our case, Moran's I measures whether cells with similar activity levels tend to be located near each other. A high Moran's I value indicates that cells with similar activity are spatially close, suggesting strong spatial autocorrelation. A value near zero suggests that activity levels are randomly distributed across space. A negative value indicates that high-activity cells are typically surrounded by low-activity cells and vice versa. Moran's I ranges from -1 (negative spatial autocorrelation) to +1 (positive spatial autocorrelation).</p></div> <!> <div class="text svelte-uz1plv"><p class="svelte-uz1plv">Clustering patterns also exhibit a noticeable 'pulse' throughout the day. Between 10am and 5pm high levels of activity become more spatially concentrated. In the evening and overnight hours, this clustering diminishes and activity becomes more spatially dispersed. This pattern likely reflects the daily movement of people into concentrated employment or commercial areas during working hours, as reported in the maps above. Additionally, clustering is generally lower on weekends, particularly on Sundays. This supports our earlier observation in the maps that weekend activity lacks the structured, location-specific patterns which are observed during weekdays.</p></div></main>`,1);function Es(t){var e=bs(),n=ie(e);Bn(n);var r=T(n,2),i=I(r),a=I(i);A(a,"src",xs),$e(4),$(i);var o=T(i,4);Te(o,{title:"Mean hourly activity in Toronto",folder_weekday:"exploring-hourly-activity-toronto/Weekday_Total_small",folder_weekend:"exploring-hourly-activity-toronto/Weekend_Total_small"});var s=T(o,4);mt(s,{path_to_data:"exploring-hourly-activity-toronto/data/pings_normalized.csv",title:"Hourly activity in Toronto by day of the week",yticks:[.5,.75,1,1.25,1.5],y_axis_title:"Mean normalized hourly activity"});var l=T(s,4);Te(l,{title:"Mean-subtracted hourly activity in Toronto",folder_weekday:"exploring-hourly-activity-toronto/Weekday_Difference_small",folder_weekend:"exploring-hourly-activity-toronto/Weekend_Difference_small"});var u=T(l,4);mt(u,{path_to_data:"exploring-hourly-activity-toronto/data/shannon.csv",title:"Shannon diversity index of hourly activity in Toronto",yticks:[7.9,8,8.1,8.2],y_axis_title:""});var c=T(u,4);mt(c,{path_to_data:"exploring-hourly-activity-toronto/data/richness.csv",title:"Fraction of cells with activity throughout the day",yticks:[.4,.5,.6,.7],y_axis_title:"Richness"});var h=T(c,2);mt(h,{path_to_data:"exploring-hourly-activity-toronto/data/evenness.csv",title:"Evenness of activity throughout the day",yticks:[.86,.87,.88,.89,.9],y_axis_title:"Evenness"});var f=T(h,4);mt(f,{path_to_data:"exploring-hourly-activity-toronto/data/moran.csv",title:"Spatial clustering of hourly activity in Toronto",yticks:[.34,.38,.42,.46],y_axis_title:"Moran's I of hourly activity in Toronto"}),$e(2),$(r),O(t,e)}export{Es as component};
